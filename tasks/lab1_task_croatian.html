<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<!-- saved from url=(0047)http://www.zemris.fer.hr/~ssegvic/du/lab1.shtml -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  
  <title>Prva laboratorijska vježba iz Dubokog učenja</title>
  <link rel="stylesheet" type="text/css" href="./lab1_task_croatian_files/dl.css">
  <link rel="stylesheet" href="./lab1_task_croatian_files/default.css">
  <script src="./lab1_task_croatian_files/MathJax.js" id=""></script><script data-dapp-detection="">
(function() {
  let alreadyInsertedMetaTag = false

  function __insertDappDetected() {
    if (!alreadyInsertedMetaTag) {
      const meta = document.createElement('meta')
      meta.name = 'dapp-detected'
      document.head.appendChild(meta)
      alreadyInsertedMetaTag = true
    }
  }

  if (window.hasOwnProperty('web3')) {
    // Note a closure can't be used for this var because some sites like
    // www.wnyc.org do a second script execution via eval for some reason.
    window.__disableDappDetectionInsertion = true
    // Likely oldWeb3 is undefined and it has a property only because
    // we defined it. Some sites like wnyc.org are evaling all scripts
    // that exist again, so this is protection against multiple calls.
    if (window.web3 === undefined) {
      return
    }
    __insertDappDetected()
  } else {
    var oldWeb3 = window.web3
    Object.defineProperty(window, 'web3', {
      configurable: true,
      set: function (val) {
        if (!window.__disableDappDetectionInsertion)
          __insertDappDetected()
        oldWeb3 = val
      },
      get: function () {
        if (!window.__disableDappDetectionInsertion)
          __insertDappDetected()
        return oldWeb3
      }
    })
  }
})()</script>
  <script type="text/javascript" src="./lab1_task_croatian_files/highlight.pack.js"></script>
  <script type="text/javascript">hljs.initHighlightingOnLoad();</script>
  <link href="./lab1_task_croatian_files/css" rel="stylesheet">
<style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 5px 0px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 5px; -webkit-border-radius: 5px; -moz-border-radius: 5px; -khtml-border-radius: 5px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 1px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: .7em}
.MathJax_MenuRadioCheck.RTL {right: .7em; left: auto}
.MathJax_MenuLabel {padding: 1px 2em 3px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #DDDDDD; margin: 4px 3px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: #606872; color: white}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">.mjx-chtml {display: inline-block; line-height: 0; text-indent: 0; text-align: left; text-transform: none; font-style: normal; font-weight: normal; font-size: 100%; font-size-adjust: none; letter-spacing: normal; word-wrap: normal; word-spacing: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; margin: 0; padding: 1px 0}
.MJXc-display {display: block; text-align: center; margin: 1em 0; padding: 0}
.mjx-chtml[tabindex]:focus, body :focus .mjx-chtml[tabindex] {display: inline-table}
.mjx-full-width {text-align: center; display: table-cell!important; width: 10000em}
.mjx-math {display: inline-block; border-collapse: separate; border-spacing: 0}
.mjx-math * {display: inline-block; -webkit-box-sizing: content-box!important; -moz-box-sizing: content-box!important; box-sizing: content-box!important; text-align: left}
.mjx-numerator {display: block; text-align: center}
.mjx-denominator {display: block; text-align: center}
.MJXc-stacked {height: 0; position: relative}
.MJXc-stacked > * {position: absolute}
.MJXc-bevelled > * {display: inline-block}
.mjx-stack {display: inline-block}
.mjx-op {display: block}
.mjx-under {display: table-cell}
.mjx-over {display: block}
.mjx-over > * {padding-left: 0px!important; padding-right: 0px!important}
.mjx-under > * {padding-left: 0px!important; padding-right: 0px!important}
.mjx-stack > .mjx-sup {display: block}
.mjx-stack > .mjx-sub {display: block}
.mjx-prestack > .mjx-presup {display: block}
.mjx-prestack > .mjx-presub {display: block}
.mjx-delim-h > .mjx-char {display: inline-block}
.mjx-surd {vertical-align: top}
.mjx-mphantom * {visibility: hidden}
.mjx-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 2px 3px; font-style: normal; font-size: 90%}
.mjx-annotation-xml {line-height: normal}
.mjx-menclose > svg {fill: none; stroke: currentColor}
.mjx-mtr {display: table-row}
.mjx-mlabeledtr {display: table-row}
.mjx-mtd {display: table-cell; text-align: center}
.mjx-label {display: table-row}
.mjx-box {display: inline-block}
.mjx-block {display: block}
.mjx-span {display: inline}
.mjx-char {display: block; white-space: pre}
.mjx-itable {display: inline-table; width: auto}
.mjx-row {display: table-row}
.mjx-cell {display: table-cell}
.mjx-table {display: table; width: 100%}
.mjx-line {display: block; height: 0}
.mjx-strut {width: 0; padding-top: 1em}
.mjx-vsize {width: 0}
.MJXc-space1 {margin-left: .167em}
.MJXc-space2 {margin-left: .222em}
.MJXc-space3 {margin-left: .278em}
.mjx-chartest {display: block; visibility: hidden; position: absolute; top: 0; line-height: normal; font-size: 500%}
.mjx-chartest .mjx-char {display: inline}
.mjx-chartest .mjx-box {padding-top: 1000px}
.MJXc-processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MJXc-processed {display: none}
.mjx-test {display: block; font-style: normal; font-weight: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow: hidden; height: 1px}
.mjx-ex-box-test {position: absolute; width: 1px; height: 60ex}
.mjx-line-box-test {display: table!important}
.mjx-line-box-test span {display: table-cell!important; width: 10000em!important; min-width: 0; max-width: none; padding: 0; border: 0; margin: 0}
#MathJax_CHTML_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.mjx-chtml .mjx-noError {line-height: 1.2; vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
.MJXc-TeX-unknown-R {font-family: STIXGeneral,'Cambria Math','Arial Unicode MS',serif; font-style: normal; font-weight: normal}
.MJXc-TeX-unknown-I {font-family: STIXGeneral,'Cambria Math','Arial Unicode MS',serif; font-style: italic; font-weight: normal}
.MJXc-TeX-unknown-B {font-family: STIXGeneral,'Cambria Math','Arial Unicode MS',serif; font-style: normal; font-weight: bold}
.MJXc-TeX-unknown-BI {font-family: STIXGeneral,'Cambria Math','Arial Unicode MS',serif; font-style: italic; font-weight: bold}
.MJXc-TeX-ams-R {font-family: MJXc-TeX-ams-R,MJXc-TeX-ams-Rw}
.MJXc-TeX-cal-B {font-family: MJXc-TeX-cal-B,MJXc-TeX-cal-Bx,MJXc-TeX-cal-Bw}
.MJXc-TeX-frak-R {font-family: MJXc-TeX-frak-R,MJXc-TeX-frak-Rw}
.MJXc-TeX-frak-B {font-family: MJXc-TeX-frak-B,MJXc-TeX-frak-Bx,MJXc-TeX-frak-Bw}
.MJXc-TeX-math-BI {font-family: MJXc-TeX-math-BI,MJXc-TeX-math-BIx,MJXc-TeX-math-BIw}
.MJXc-TeX-sans-R {font-family: MJXc-TeX-sans-R,MJXc-TeX-sans-Rw}
.MJXc-TeX-sans-B {font-family: MJXc-TeX-sans-B,MJXc-TeX-sans-Bx,MJXc-TeX-sans-Bw}
.MJXc-TeX-sans-I {font-family: MJXc-TeX-sans-I,MJXc-TeX-sans-Ix,MJXc-TeX-sans-Iw}
.MJXc-TeX-script-R {font-family: MJXc-TeX-script-R,MJXc-TeX-script-Rw}
.MJXc-TeX-type-R {font-family: MJXc-TeX-type-R,MJXc-TeX-type-Rw}
.MJXc-TeX-cal-R {font-family: MJXc-TeX-cal-R,MJXc-TeX-cal-Rw}
.MJXc-TeX-main-B {font-family: MJXc-TeX-main-B,MJXc-TeX-main-Bx,MJXc-TeX-main-Bw}
.MJXc-TeX-main-I {font-family: MJXc-TeX-main-I,MJXc-TeX-main-Ix,MJXc-TeX-main-Iw}
.MJXc-TeX-main-R {font-family: MJXc-TeX-main-R,MJXc-TeX-main-Rw}
.MJXc-TeX-math-I {font-family: MJXc-TeX-math-I,MJXc-TeX-math-Ix,MJXc-TeX-math-Iw}
.MJXc-TeX-size1-R {font-family: MJXc-TeX-size1-R,MJXc-TeX-size1-Rw}
.MJXc-TeX-size2-R {font-family: MJXc-TeX-size2-R,MJXc-TeX-size2-Rw}
.MJXc-TeX-size3-R {font-family: MJXc-TeX-size3-R,MJXc-TeX-size3-Rw}
.MJXc-TeX-size4-R {font-family: MJXc-TeX-size4-R,MJXc-TeX-size4-Rw}
@font-face {font-family: MJXc-TeX-ams-R; src: local('MathJax_AMS'), local('MathJax_AMS-Regular')}
@font-face {font-family: MJXc-TeX-ams-Rw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_AMS-Regular.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_AMS-Regular.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_AMS-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-cal-B; src: local('MathJax_Caligraphic Bold'), local('MathJax_Caligraphic-Bold')}
@font-face {font-family: MJXc-TeX-cal-Bx; src: local('MathJax_Caligraphic'); font-weight: bold}
@font-face {font-family: MJXc-TeX-cal-Bw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_Caligraphic-Bold.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Caligraphic-Bold.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Bold.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-frak-R; src: local('MathJax_Fraktur'), local('MathJax_Fraktur-Regular')}
@font-face {font-family: MJXc-TeX-frak-Rw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_Fraktur-Regular.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Fraktur-Regular.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Fraktur-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-frak-B; src: local('MathJax_Fraktur Bold'), local('MathJax_Fraktur-Bold')}
@font-face {font-family: MJXc-TeX-frak-Bx; src: local('MathJax_Fraktur'); font-weight: bold}
@font-face {font-family: MJXc-TeX-frak-Bw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_Fraktur-Bold.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Fraktur-Bold.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Fraktur-Bold.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-math-BI; src: local('MathJax_Math BoldItalic'), local('MathJax_Math-BoldItalic')}
@font-face {font-family: MJXc-TeX-math-BIx; src: local('MathJax_Math'); font-weight: bold; font-style: italic}
@font-face {font-family: MJXc-TeX-math-BIw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_Math-BoldItalic.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Math-BoldItalic.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Math-BoldItalic.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-sans-R; src: local('MathJax_SansSerif'), local('MathJax_SansSerif-Regular')}
@font-face {font-family: MJXc-TeX-sans-Rw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_SansSerif-Regular.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_SansSerif-Regular.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_SansSerif-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-sans-B; src: local('MathJax_SansSerif Bold'), local('MathJax_SansSerif-Bold')}
@font-face {font-family: MJXc-TeX-sans-Bx; src: local('MathJax_SansSerif'); font-weight: bold}
@font-face {font-family: MJXc-TeX-sans-Bw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_SansSerif-Bold.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_SansSerif-Bold.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_SansSerif-Bold.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-sans-I; src: local('MathJax_SansSerif Italic'), local('MathJax_SansSerif-Italic')}
@font-face {font-family: MJXc-TeX-sans-Ix; src: local('MathJax_SansSerif'); font-style: italic}
@font-face {font-family: MJXc-TeX-sans-Iw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_SansSerif-Italic.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_SansSerif-Italic.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_SansSerif-Italic.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-script-R; src: local('MathJax_Script'), local('MathJax_Script-Regular')}
@font-face {font-family: MJXc-TeX-script-Rw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_Script-Regular.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Script-Regular.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Script-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-type-R; src: local('MathJax_Typewriter'), local('MathJax_Typewriter-Regular')}
@font-face {font-family: MJXc-TeX-type-Rw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_Typewriter-Regular.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Typewriter-Regular.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Typewriter-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-cal-R; src: local('MathJax_Caligraphic'), local('MathJax_Caligraphic-Regular')}
@font-face {font-family: MJXc-TeX-cal-Rw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_Caligraphic-Regular.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Caligraphic-Regular.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-main-B; src: local('MathJax_Main Bold'), local('MathJax_Main-Bold')}
@font-face {font-family: MJXc-TeX-main-Bx; src: local('MathJax_Main'); font-weight: bold}
@font-face {font-family: MJXc-TeX-main-Bw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_Main-Bold.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Main-Bold.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Main-Bold.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-main-I; src: local('MathJax_Main Italic'), local('MathJax_Main-Italic')}
@font-face {font-family: MJXc-TeX-main-Ix; src: local('MathJax_Main'); font-style: italic}
@font-face {font-family: MJXc-TeX-main-Iw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_Main-Italic.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Main-Italic.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Main-Italic.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-main-R; src: local('MathJax_Main'), local('MathJax_Main-Regular')}
@font-face {font-family: MJXc-TeX-main-Rw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_Main-Regular.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Main-Regular.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Main-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-math-I; src: local('MathJax_Math Italic'), local('MathJax_Math-Italic')}
@font-face {font-family: MJXc-TeX-math-Ix; src: local('MathJax_Math'); font-style: italic}
@font-face {font-family: MJXc-TeX-math-Iw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_Math-Italic.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Math-Italic.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Math-Italic.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-size1-R; src: local('MathJax_Size1'), local('MathJax_Size1-Regular')}
@font-face {font-family: MJXc-TeX-size1-Rw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_Size1-Regular.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size1-Regular.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size1-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-size2-R; src: local('MathJax_Size2'), local('MathJax_Size2-Regular')}
@font-face {font-family: MJXc-TeX-size2-Rw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_Size2-Regular.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size2-Regular.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size2-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-size3-R; src: local('MathJax_Size3'), local('MathJax_Size3-Regular')}
@font-face {font-family: MJXc-TeX-size3-Rw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_Size3-Regular.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size3-Regular.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size3-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-size4-R; src: local('MathJax_Size4'), local('MathJax_Size4-Regular')}
@font-face {font-family: MJXc-TeX-size4-Rw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_Size4-Regular.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size4-Regular.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size4-Regular.otf') format('opentype')}
</style></head>

<body><div id="MathJax_Message" style="display: none;"></div>

<h2>Prva laboratorijska vježba iz Dubokog učenja</h2>
<h4>Gradijenti višeslojnih mreža, uvod u PyTorch, potpuno povezani duboki modeli, studija slučaja: MNIST</h4>

<p>
Predmet ove vježbe su unaprijedni duboki modeli za klasifikaciju.
Pokazat ćemo da se ti modeli mogu promatrati
ili kao višeslojne unaprijedne neuronske mreže
ili kao produbljeni logistički modeli
koje smo upoznali u nultoj vježbi.
Oba pogleda vode na istu programsku izvedbu koja se temelji
na optimiranju izglednosti parametara modela.
Kako bismo olakšali razvoj i ubrzali eksperimentiranje,
proučit ćemo mogućnost automatske diferencijacije
koju danas nude brojni programski okviri za numeričku optimizaciju.
Posebnu pažnju poklonit ćemo PyTorchu
kao jednom od najčešće korištenih alata te kategorije.

​

</p><p>
Cilj vježbe je razviti sedam modula:
<code>data</code>,
<code>fcann2</code>,
<code>pt_linreg</code>,
<code>pt_logreg</code>,
<code>pt_deep</code>,
<code>ksvm_wrap</code>,
i <code>mnist_shootout</code>.
Modul <code>data</code> će biti nadograđena
verzija istoimenog modula iz nulte vježbe.
Modul <code>fcann2</code> će sadržavati implementaciju
dvoslojnog potpuno povezanog modela
temeljenog na NumPyjevim primitivima.
Organizacijski i izvedbeno, taj modul bi trebao biti
vrlo sličan modulu <code>logreg</code> iz nulte vježbe.
Sljedeća tri modula sadržavat će implementacije
triju postupaka strojnog učenja rastuće složenosti,
temeljene na okviru PyTorch.
Modul <code>ksvm_wrap</code> će umatati
klasifikator s jezgrenim ugrađivanjem i potpornim vektorima
izveden u modulu <code>sklearn.svm</code> biblioteke 
<code>scikit-learn</code> te omogućiti usporedbu
s klasifikatorima temeljenima na dubokom učenju.
Konačno, modul <code>mnist_shootout</code>
će usporediti performansu do tada razvijenih klasifikatora
na skupu podataka MNIST.

</p><h4 id="z0a">0a. Uvodne napomene o dubokim modelima</h4>

<p>
Duboki modeli strojnog učenja temelje se 
na apstraktnim reprezentacijama podataka
do kojih dolazimo slijedom
naučenih nelinearnih transformacija.
U ovoj i sljedećoj vježbi razmatramo duboke modele
koji su <em>diskriminativni</em> i <em>unaprijedni</em>.
Diskriminativni model za dani podatak <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-1-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-1" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-2" class="mjx-mrow"><span id="MJXc-Node-3" class="mjx-texatom"><span id="MJXc-Node-4" class="mjx-mrow"><span id="MJXc-Node-5" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.108em; padding-bottom: 0.37em;">x</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-1">\mathbf{x}</script>
na izlazu izravno generira uvjetnu vjerojatnost
zavisne varijable <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-2-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;X&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-6" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-7" class="mjx-mrow"><span id="MJXc-Node-8" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.265em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-9" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">(</span></span><span id="MJXc-Node-10" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.265em; padding-right: 0.182em;">Y</span></span><span id="MJXc-Node-11" class="mjx-texatom"><span id="MJXc-Node-12" class="mjx-mrow"><span id="MJXc-Node-13" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">|</span></span></span></span><span id="MJXc-Node-14" class="mjx-texatom"><span id="MJXc-Node-15" class="mjx-mrow"><span id="MJXc-Node-16" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.37em; padding-bottom: 0.37em;">X</span></span></span></span><span id="MJXc-Node-17" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi><mo stretchy="false">(</mo><mi>Y</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">X</mi></mrow><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-2">P(Y|\mathbf{X})</script>.
Diskriminativne modele tipično koristimo
kad na raspolaganju imamo <emph>označene</emph> podatke
prikladne za nadzirano učenje.
U unaprijednom modelu tok informacija je jednosmjeran
što znači da (među)rezultati obrade
ne mogu biti spojeni unatrag prema izlazu.
Osnovni diskriminativni duboki model jest
višeslojna unaprijedna neuronska mreža.

</p><h5> Umjetne neuronske mreže</h5>

<p>
Umjetne neuronske mreže su model strojnog učenja
kojeg izražavamo usmjerenim grafom
skalarnih procesnih jedinica
koje nazivamo umjetnim neuronima.
Jedan od važnih ciljeva neuronskih mreža
je postavljanje računskog modela biološkog učenja
odnosno razumijevanje mehanizama učenja u mozgu živog bića. 
Iako je vrlo srodno neuronskim mrežama,
duboko učenje nema ambiciju modelirati biološke procese,
nego proučava učenje kompozicijskih modela od praktičnog značaja
koji mogu i ne moraju imati biološku interpretaciju.

</p><p>
Umjetni neuroni tipično provode
afinu redukciju ulaznog vektora,
što možemo sažeto prikazati izrazom
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-3-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x22A4;&lt;/mi&gt;&lt;/msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-18" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-19" class="mjx-mrow"><span id="MJXc-Node-20" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.475em; padding-right: 0.06em;">f</span></span><span id="MJXc-Node-21" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">(</span></span><span id="MJXc-Node-22" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-23" class="mjx-texatom"><span id="MJXc-Node-24" class="mjx-mrow"><span id="MJXc-Node-25" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.108em; padding-bottom: 0.37em;">w</span></span></span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-26" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.37em; padding-bottom: 0.318em;">⊤</span></span></span></span><span id="MJXc-Node-27" class="mjx-texatom"><span id="MJXc-Node-28" class="mjx-mrow"><span id="MJXc-Node-29" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.108em; padding-bottom: 0.37em;">x</span></span></span></span><span id="MJXc-Node-30" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.318em; padding-bottom: 0.423em;">+</span></span><span id="MJXc-Node-31" class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.265em;">b</span></span><span id="MJXc-Node-32" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">w</mi></mrow><mi mathvariant="normal">⊤</mi></msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo>+</mo><mi>b</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-3"> f(\mathbf{w}^\top\mathbf{x}+b) </script>.
Pri tome vektor <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-4-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-33" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-34" class="mjx-mrow"><span id="MJXc-Node-35" class="mjx-texatom"><span id="MJXc-Node-36" class="mjx-mrow"><span id="MJXc-Node-37" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.108em; padding-bottom: 0.37em;">x</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-4"> \mathbf{x} </script>
predstavlja ulazne varijable,
vektor <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-5-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-38" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-39" class="mjx-mrow"><span id="MJXc-Node-40" class="mjx-texatom"><span id="MJXc-Node-41" class="mjx-mrow"><span id="MJXc-Node-42" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.108em; padding-bottom: 0.37em;">w</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">w</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-5"> \mathbf{w} </script> i skalar <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-6-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-43" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-44" class="mjx-mrow"><span id="MJXc-Node-45" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.265em;">b</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-6"> b </script>
predstavljaju slobodne parametre
koji se optimiraju postupkom učenja,
dok <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-7-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-46" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-47" class="mjx-mrow"><span id="MJXc-Node-48" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.475em; padding-right: 0.06em;">f</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi></math></span></span><script type="math/tex" id="MathJax-Element-7"> f </script> predstavlja tzv.
prijenosnu funkciju umjetnog neurona.
Uloga prijenosne funkcije je da u model unese nelinearnost.
Ako za <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-8-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-49" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-50" class="mjx-mrow"><span id="MJXc-Node-51" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.475em; padding-right: 0.06em;">f</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi></math></span></span><script type="math/tex" id="MathJax-Element-8"> f </script> odaberemo funkciju softmax,
umjetni neuron će provoditi
višerazrednu logističku regresiju.
Ako za <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-9-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-52" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-53" class="mjx-mrow"><span id="MJXc-Node-54" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.475em; padding-right: 0.06em;">f</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi></math></span></span><script type="math/tex" id="MathJax-Element-9"> f </script> odaberemo sigmoidalnu funkciju
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-10-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x3C3;&lt;/mo&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-55" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-56" class="mjx-mrow"><span id="MJXc-Node-57" class="mjx-texatom"><span id="MJXc-Node-58" class="mjx-mrow"><span id="MJXc-Node-59" class="mjx-mo"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.213em; padding-bottom: 0.265em;">σ</span></span></span></span><span id="MJXc-Node-60" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">(</span></span><span id="MJXc-Node-61" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.213em; padding-bottom: 0.265em;">s</span></span><span id="MJXc-Node-62" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">)</span></span><span id="MJXc-Node-63" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.055em; padding-bottom: 0.318em;">=</span></span><span id="MJXc-Node-64" class="mjx-msubsup MJXc-space3"><span class="mjx-base"><span id="MJXc-Node-65" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.213em; padding-bottom: 0.265em;">e</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-66" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.213em; padding-bottom: 0.265em;">s</span></span></span></span><span id="MJXc-Node-67" class="mjx-texatom"><span id="MJXc-Node-68" class="mjx-mrow"><span id="MJXc-Node-69" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">/</span></span></span></span><span id="MJXc-Node-70" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">(</span></span><span id="MJXc-Node-71" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.37em; padding-bottom: 0.318em;">1</span></span><span id="MJXc-Node-72" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.318em; padding-bottom: 0.423em;">+</span></span><span id="MJXc-Node-73" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-74" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.213em; padding-bottom: 0.265em;">e</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-75" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.213em; padding-bottom: 0.265em;">s</span></span></span></span><span id="MJXc-Node-76" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mo>σ</mo></mrow><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo><mo>=</mo><msup><mi>e</mi><mi>s</mi></msup><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><msup><mi>e</mi><mi>s</mi></msup><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-10"> σ(s)=e^s/(1+e^s) </script>,
umjetni neuron će provoditi binarnu logističku regresiju.
Zbog boljeg učenja dubokih modela,
sigmoidu danas istiskuje zglobnica
(engl. rectified linear unit, ReLU)
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-11-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;R&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;L&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;U&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;&gt;max&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-77" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-78" class="mjx-mrow"><span id="MJXc-Node-79" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.475em; padding-right: 0.06em;">f</span></span><span id="MJXc-Node-80" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">(</span></span><span id="MJXc-Node-81" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.213em; padding-bottom: 0.265em;">s</span></span><span id="MJXc-Node-82" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">)</span></span><span id="MJXc-Node-83" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.055em; padding-bottom: 0.318em;">=</span></span><span id="MJXc-Node-84" class="mjx-texatom MJXc-space3"><span id="MJXc-Node-85" class="mjx-mrow"><span id="MJXc-Node-86" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.37em;">R</span></span><span id="MJXc-Node-87" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.16em; padding-bottom: 0.37em;">e</span></span><span id="MJXc-Node-88" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.318em;">L</span></span><span id="MJXc-Node-89" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.37em;">U</span></span></span></span><span id="MJXc-Node-90" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">(</span></span><span id="MJXc-Node-91" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.213em; padding-bottom: 0.265em;">s</span></span><span id="MJXc-Node-92" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">)</span></span><span id="MJXc-Node-93" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.055em; padding-bottom: 0.318em;">=</span></span><span id="MJXc-Node-94" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.16em; padding-bottom: 0.37em;">max</span></span><span id="MJXc-Node-95" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">(</span></span><span id="MJXc-Node-96" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.37em; padding-bottom: 0.37em;">0</span></span><span id="MJXc-Node-97" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.155em; padding-bottom: 0.528em;">,</span></span><span id="MJXc-Node-98" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.213em; padding-bottom: 0.265em;">s</span></span><span id="MJXc-Node-99" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">R</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">L</mi><mi mathvariant="normal">U</mi></mrow><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo><mo>=</mo><mo movablelimits="true" form="prefix">max</mo><mo stretchy="false">(</mo><mn>0</mn><mo>,</mo><mi>s</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-11"> f(s) = \mathrm{ReLU}(s) = \max(0, s) </script> .

</p><h5> Višeslojne unaprijedne mreže</h5>

<p>
Neuronska mreža s jednim ulaznim slojem,
sofmaksom na izlazu, i gubitkom
koji maksimizira izglednost parametara
ekvivalentna je logističkoj regresiji.
Međutim, na ovom kolegiju proučavamo "produbljene" modele
koje dobivamo kad između ulaza i izlaza
logističke regresije dodamo
jednu ili više nelinearnih transformacija.
Među njima, posebnu klasu čine unaprijedni modeli
u kojima ne postoje povratne veze među neuronima.
Takve modele možemo predstaviti
acikličkim usmjerenim grafom
gdje čvorovi odgovaraju neuronima,
dok lukovi modeliraju povezanost neurona.
Poput logističke regresije,
unaprijedne duboke modele
najčešće učimo gradijentnim spustom
koji optimira izglednost predviđanja modela.
Suprotno od logističke regresije, 
funkcija gubitka dubokih modela nije konveksna,
što znači da ne postoji garancija
da ćemo naći globalni optimum.

</p><p>
U ovoj vježbi posebno će nam biti zanimljive
višeslojne mreže s potpuno povezanim slojevima.
U takvim mrežama neurone možemo organizirati 
u slojeve <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-12-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-100" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-101" class="mjx-mrow"><span id="MJXc-Node-102" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.032em;"><span id="MJXc-Node-103" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.318em; padding-right: 0.032em;">S</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span id="MJXc-Node-104" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.265em;">k</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>S</mi><mi>k</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-12"> S_k </script>
za koje vrijedi da neuroni sloja <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-13-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-105" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-106" class="mjx-mrow"><span id="MJXc-Node-107" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.265em;">k</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-13"> k </script> 
na svojim ulazima primaju sve neurone sloja <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-14-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-108" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-109" class="mjx-mrow"><span id="MJXc-Node-110" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.265em;">k</span></span><span id="MJXc-Node-111" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.318em; padding-bottom: 0.423em;">−</span></span><span id="MJXc-Node-112" class="mjx-mn MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.37em; padding-bottom: 0.318em;">1</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi><mo>−</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-14"> k-1 </script>.
Za razliku od logističke regresije,
višeslojni modeli mogu modelirati
nelinearnu decizijsku granicu,
ali po cijeni nekonveksne funkcije cilja.

</p><p>
U posljednje vrijeme popularno je,
umjesto pojedinih neurona,
čitav sloj promatrati kao kompoziciju
linearnog i nelinearnog koraka obrade.
Ako se dogovorimo da prijenosna funkcija
vektorskog operanda odgovara konkatenaciji
prijenosnih funkcija komponenata,
dolazimo do sljedećeg sažetog zapisa
k-tog sloja unaprijedne potpuno povezane mreže
sa zglobnom aktivacijom:

</p><p>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-15-Frame" class="mjx-full-width mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;s&lt;/mi&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;W&lt;/mi&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;h&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;k&lt;/mi&gt;&lt;mo mathvariant=&quot;bold&quot;&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn mathvariant=&quot;bold&quot;&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;b&lt;/mi&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mspace linebreak=&quot;newline&quot; /&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;h&lt;/mi&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;R&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;L&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;U&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;s&lt;/mi&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; min-width: 9.096em; position: relative;"><span id="MJXc-Node-113" class="mjx-math" style="width: 100%;" aria-hidden="true"><span id="MJXc-Node-114" class="mjx-mrow" style="width: 100%;"><span class="mjx-stack" style="width: 100%; vertical-align: -1.389em;"><span class="mjx-block"><span class="mjx-box"><span id="MJXc-Node-115" class="mjx-texatom"><span id="MJXc-Node-116" class="mjx-mrow"><span id="MJXc-Node-117" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-118" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.16em; padding-bottom: 0.37em;">s</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span id="MJXc-Node-119" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.37em; padding-bottom: 0.37em;">k</span></span></span></span></span></span><span id="MJXc-Node-120" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.055em; padding-bottom: 0.318em;">=</span></span><span id="MJXc-Node-121" class="mjx-texatom MJXc-space3"><span id="MJXc-Node-122" class="mjx-mrow"><span id="MJXc-Node-123" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-124" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.37em; padding-bottom: 0.37em;">W</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span id="MJXc-Node-125" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.37em; padding-bottom: 0.37em;">k</span></span></span></span></span></span><span id="MJXc-Node-126" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.003em; padding-bottom: 0.318em;">⋅</span></span><span id="MJXc-Node-127" class="mjx-texatom MJXc-space2"><span id="MJXc-Node-128" class="mjx-mrow"><span id="MJXc-Node-129" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-130" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.37em; padding-bottom: 0.37em;">h</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span id="MJXc-Node-131" class="mjx-texatom" style=""><span id="MJXc-Node-132" class="mjx-mrow"><span id="MJXc-Node-133" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.37em; padding-bottom: 0.37em;">k</span></span><span id="MJXc-Node-134" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-B" style="margin-top: -0.05em; padding-bottom: 0.37em;">−</span></span><span id="MJXc-Node-135" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.318em; padding-bottom: 0.37em;">1</span></span></span></span></span></span></span></span><span id="MJXc-Node-136" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.318em; padding-bottom: 0.423em;">+</span></span><span id="MJXc-Node-137" class="mjx-texatom MJXc-space2"><span id="MJXc-Node-138" class="mjx-mrow"><span id="MJXc-Node-139" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-140" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.37em; padding-bottom: 0.37em;">b</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span id="MJXc-Node-141" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.37em; padding-bottom: 0.37em;">k</span></span></span></span></span></span></span></span><span class="mjx-block" style="padding-top: 0.442em;"><span class="mjx-box"><span id="MJXc-Node-142" class="mjx-mspace" style="width: 0px; height: 0px;"></span><span id="MJXc-Node-143" class="mjx-texatom"><span id="MJXc-Node-144" class="mjx-mrow"><span id="MJXc-Node-145" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-146" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.37em; padding-bottom: 0.37em;">h</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span id="MJXc-Node-147" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.37em; padding-bottom: 0.37em;">k</span></span></span></span></span></span><span id="MJXc-Node-148" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.055em; padding-bottom: 0.318em;">=</span></span><span id="MJXc-Node-149" class="mjx-texatom MJXc-space3"><span id="MJXc-Node-150" class="mjx-mrow"><span id="MJXc-Node-151" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.37em;">R</span></span><span id="MJXc-Node-152" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.16em; padding-bottom: 0.37em;">e</span></span><span id="MJXc-Node-153" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.318em;">L</span></span><span id="MJXc-Node-154" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.37em;">U</span></span></span></span><span id="MJXc-Node-155" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">(</span></span><span id="MJXc-Node-156" class="mjx-texatom"><span id="MJXc-Node-157" class="mjx-mrow"><span id="MJXc-Node-158" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-159" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.16em; padding-bottom: 0.37em;">s</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span id="MJXc-Node-160" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.37em; padding-bottom: 0.37em;">k</span></span></span></span></span></span><span id="MJXc-Node-161" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">)</span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><msub><mi mathvariant="bold">s</mi><mi mathvariant="bold">k</mi></msub></mrow><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><msub><mi mathvariant="bold">W</mi><mi mathvariant="bold">k</mi></msub></mrow><mo>⋅</mo><mrow class="MJX-TeXAtom-ORD"><msub><mi mathvariant="bold">h</mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">k</mi><mo mathvariant="bold">−</mo><mn mathvariant="bold">1</mn></mrow></msub></mrow><mo>+</mo><mrow class="MJX-TeXAtom-ORD"><msub><mi mathvariant="bold">b</mi><mi mathvariant="bold">k</mi></msub></mrow><mspace linebreak="newline"></mspace><mrow class="MJX-TeXAtom-ORD"><msub><mi mathvariant="bold">h</mi><mi mathvariant="bold">k</mi></msub></mrow><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">R</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">L</mi><mi mathvariant="normal">U</mi></mrow><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><msub><mi mathvariant="bold">s</mi><mi mathvariant="bold">k</mi></msub></mrow><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-15">
 \mathbf{s_k} = \mathbf{W_k}\cdot\mathbf{h_{k-1}} + \mathbf{b_k} \\
 \mathbf{h_k} = \mathrm{ReLU}(\mathbf{s_k})  
</script>

</p><p>
Sljedeća ilustracija prikazuje dva pogleda
na istu potpuno povezanu unaprijednu mrežu.
Na lijevoj strani je klasični prikaz
gdje krugovi odgovaraju neuronima 
sa skalarnim izlazom i zglobnom prijenosnom funkcijom.
Na desnoj strani je vektorizirani računski graf
kojeg ćemo koristiti u ovom kolegiju:

<img src="./lab1_task_croatian_files/ann.png" alt="data">

</p><h5> Gradijenti u dvoslojnom potpuno povezanom modelu</h5>
<p>
Razmotrimo sada kako bismo odredili gradijente
u prethodno prikazanom primjeru dvoslojnog
potpuno povezanog modela.
Izrazimo klasifikacijski model vektorskim jednadžbama:

</p><p>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-16-Frame" class="mjx-full-width mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;s&lt;/mi&gt;&lt;mn mathvariant=&quot;bold&quot;&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;W&lt;/mi&gt;&lt;mn mathvariant=&quot;bold&quot;&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;b&lt;/mi&gt;&lt;mn mathvariant=&quot;bold&quot;&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mspace linebreak=&quot;newline&quot; /&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;h&lt;/mi&gt;&lt;mn mathvariant=&quot;bold&quot;&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;R&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;L&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;U&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;s&lt;/mi&gt;&lt;mn mathvariant=&quot;bold&quot;&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mspace linebreak=&quot;newline&quot; /&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;s&lt;/mi&gt;&lt;mn mathvariant=&quot;bold&quot;&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;W&lt;/mi&gt;&lt;mn mathvariant=&quot;bold&quot;&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;h&lt;/mi&gt;&lt;mn mathvariant=&quot;bold&quot;&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;b&lt;/mi&gt;&lt;mn mathvariant=&quot;bold&quot;&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mspace linebreak=&quot;newline&quot; /&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;s&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;o&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;f&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;t&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;m&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;a&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;s&lt;/mi&gt;&lt;mn mathvariant=&quot;bold&quot;&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; min-width: 9.978em; position: relative;"><span id="MJXc-Node-162" class="mjx-math" style="width: 100%;" aria-hidden="true"><span id="MJXc-Node-163" class="mjx-mrow" style="width: 100%;"><span class="mjx-stack" style="width: 100%; vertical-align: -4.205em;"><span class="mjx-block"><span class="mjx-box"><span id="MJXc-Node-164" class="mjx-texatom"><span id="MJXc-Node-165" class="mjx-mrow"><span id="MJXc-Node-166" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-167" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.16em; padding-bottom: 0.37em;">s</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-168" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.318em; padding-bottom: 0.37em;">1</span></span></span></span></span></span><span id="MJXc-Node-169" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.055em; padding-bottom: 0.318em;">=</span></span><span id="MJXc-Node-170" class="mjx-texatom MJXc-space3"><span id="MJXc-Node-171" class="mjx-mrow"><span id="MJXc-Node-172" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-173" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.37em; padding-bottom: 0.37em;">W</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-174" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.318em; padding-bottom: 0.37em;">1</span></span></span></span></span></span><span id="MJXc-Node-175" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.003em; padding-bottom: 0.318em;">⋅</span></span><span id="MJXc-Node-176" class="mjx-texatom MJXc-space2"><span id="MJXc-Node-177" class="mjx-mrow"><span id="MJXc-Node-178" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.108em; padding-bottom: 0.37em;">x</span></span></span></span><span id="MJXc-Node-179" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.318em; padding-bottom: 0.423em;">+</span></span><span id="MJXc-Node-180" class="mjx-texatom MJXc-space2"><span id="MJXc-Node-181" class="mjx-mrow"><span id="MJXc-Node-182" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-183" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.37em; padding-bottom: 0.37em;">b</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-184" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.318em; padding-bottom: 0.37em;">1</span></span></span></span></span></span></span></span><span class="mjx-block" style="padding-top: 0.442em;"><span class="mjx-box"><span id="MJXc-Node-185" class="mjx-mspace" style="width: 0px; height: 0px;"></span><span id="MJXc-Node-186" class="mjx-texatom"><span id="MJXc-Node-187" class="mjx-mrow"><span id="MJXc-Node-188" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-189" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.37em; padding-bottom: 0.37em;">h</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-190" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.318em; padding-bottom: 0.37em;">1</span></span></span></span></span></span><span id="MJXc-Node-191" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.055em; padding-bottom: 0.318em;">=</span></span><span id="MJXc-Node-192" class="mjx-texatom MJXc-space3"><span id="MJXc-Node-193" class="mjx-mrow"><span id="MJXc-Node-194" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.37em;">R</span></span><span id="MJXc-Node-195" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.16em; padding-bottom: 0.37em;">e</span></span><span id="MJXc-Node-196" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.318em;">L</span></span><span id="MJXc-Node-197" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.37em;">U</span></span></span></span><span id="MJXc-Node-198" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">(</span></span><span id="MJXc-Node-199" class="mjx-texatom"><span id="MJXc-Node-200" class="mjx-mrow"><span id="MJXc-Node-201" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-202" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.16em; padding-bottom: 0.37em;">s</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-203" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.318em; padding-bottom: 0.37em;">1</span></span></span></span></span></span><span id="MJXc-Node-204" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">)</span></span></span></span><span class="mjx-block" style="padding-top: 0.442em;"><span class="mjx-box"><span id="MJXc-Node-205" class="mjx-mspace" style="width: 0px; height: 0px;"></span><span id="MJXc-Node-206" class="mjx-texatom"><span id="MJXc-Node-207" class="mjx-mrow"><span id="MJXc-Node-208" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-209" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.16em; padding-bottom: 0.37em;">s</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-210" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.318em; padding-bottom: 0.37em;">2</span></span></span></span></span></span><span id="MJXc-Node-211" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.055em; padding-bottom: 0.318em;">=</span></span><span id="MJXc-Node-212" class="mjx-texatom MJXc-space3"><span id="MJXc-Node-213" class="mjx-mrow"><span id="MJXc-Node-214" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-215" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.37em; padding-bottom: 0.37em;">W</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-216" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.318em; padding-bottom: 0.37em;">2</span></span></span></span></span></span><span id="MJXc-Node-217" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.003em; padding-bottom: 0.318em;">⋅</span></span><span id="MJXc-Node-218" class="mjx-texatom MJXc-space2"><span id="MJXc-Node-219" class="mjx-mrow"><span id="MJXc-Node-220" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-221" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.37em; padding-bottom: 0.37em;">h</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-222" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.318em; padding-bottom: 0.37em;">1</span></span></span></span></span></span><span id="MJXc-Node-223" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.318em; padding-bottom: 0.423em;">+</span></span><span id="MJXc-Node-224" class="mjx-texatom MJXc-space2"><span id="MJXc-Node-225" class="mjx-mrow"><span id="MJXc-Node-226" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-227" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.37em; padding-bottom: 0.37em;">b</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-228" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.318em; padding-bottom: 0.37em;">2</span></span></span></span></span></span></span></span><span class="mjx-block" style="padding-top: 0.442em;"><span class="mjx-box"><span id="MJXc-Node-229" class="mjx-mspace" style="width: 0px; height: 0px;"></span><span id="MJXc-Node-230" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.265em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-231" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">(</span></span><span id="MJXc-Node-232" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.265em; padding-right: 0.182em;">Y</span></span><span id="MJXc-Node-233" class="mjx-texatom"><span id="MJXc-Node-234" class="mjx-mrow"><span id="MJXc-Node-235" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">|</span></span></span></span><span id="MJXc-Node-236" class="mjx-texatom"><span id="MJXc-Node-237" class="mjx-mrow"><span id="MJXc-Node-238" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.108em; padding-bottom: 0.37em;">x</span></span></span></span><span id="MJXc-Node-239" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">)</span></span><span id="MJXc-Node-240" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.055em; padding-bottom: 0.318em;">=</span></span><span id="MJXc-Node-241" class="mjx-texatom MJXc-space3"><span id="MJXc-Node-242" class="mjx-mrow"><span id="MJXc-Node-243" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.16em; padding-bottom: 0.37em;">s</span></span><span id="MJXc-Node-244" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.16em; padding-bottom: 0.37em;">o</span></span><span id="MJXc-Node-245" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.318em; padding-right: 0.066em;">f</span></span><span id="MJXc-Node-246" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.318em; padding-bottom: 0.37em;">t</span></span><span id="MJXc-Node-247" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.16em; padding-bottom: 0.318em;">m</span></span><span id="MJXc-Node-248" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.16em; padding-bottom: 0.37em;">a</span></span><span id="MJXc-Node-249" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.16em; padding-bottom: 0.318em;">x</span></span></span></span><span id="MJXc-Node-250" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">(</span></span><span id="MJXc-Node-251" class="mjx-texatom"><span id="MJXc-Node-252" class="mjx-mrow"><span id="MJXc-Node-253" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-254" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.16em; padding-bottom: 0.37em;">s</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-255" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.318em; padding-bottom: 0.37em;">2</span></span></span></span></span></span><span id="MJXc-Node-256" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">)</span></span><span id="MJXc-Node-257" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.155em; padding-bottom: 0.318em;">.</span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><msub><mi mathvariant="bold">s</mi><mn mathvariant="bold">1</mn></msub></mrow><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><msub><mi mathvariant="bold">W</mi><mn mathvariant="bold">1</mn></msub></mrow><mo>⋅</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo>+</mo><mrow class="MJX-TeXAtom-ORD"><msub><mi mathvariant="bold">b</mi><mn mathvariant="bold">1</mn></msub></mrow><mspace linebreak="newline"></mspace><mrow class="MJX-TeXAtom-ORD"><msub><mi mathvariant="bold">h</mi><mn mathvariant="bold">1</mn></msub></mrow><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">R</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">L</mi><mi mathvariant="normal">U</mi></mrow><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><msub><mi mathvariant="bold">s</mi><mn mathvariant="bold">1</mn></msub></mrow><mo stretchy="false">)</mo><mspace linebreak="newline"></mspace><mrow class="MJX-TeXAtom-ORD"><msub><mi mathvariant="bold">s</mi><mn mathvariant="bold">2</mn></msub></mrow><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><msub><mi mathvariant="bold">W</mi><mn mathvariant="bold">2</mn></msub></mrow><mo>⋅</mo><mrow class="MJX-TeXAtom-ORD"><msub><mi mathvariant="bold">h</mi><mn mathvariant="bold">1</mn></msub></mrow><mo>+</mo><mrow class="MJX-TeXAtom-ORD"><msub><mi mathvariant="bold">b</mi><mn mathvariant="bold">2</mn></msub></mrow><mspace linebreak="newline"></mspace><mi>P</mi><mo stretchy="false">(</mo><mi>Y</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo stretchy="false">)</mo><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">s</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">f</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">x</mi></mrow><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><msub><mi mathvariant="bold">s</mi><mn mathvariant="bold">2</mn></msub></mrow><mo stretchy="false">)</mo><mo>.</mo></math></span></span><script type="math/tex" id="MathJax-Element-16">
 \mathbf{s_1} = \mathbf{W_1} \cdot \mathbf{x}
      + \mathbf{b_1} \\
 \mathbf{h_1} = \mathrm{ReLU}(\mathbf{s_1})  \\
 \mathbf{s_2} = \mathbf{W_2} \cdot \mathbf{h_1}
      + \mathbf{b_2}  \\
 P(Y|\mathbf{x}) = \mathrm{softmax}(\mathbf{s_2})  .
</script>

</p><p>
Naša funkcija gubitka biti će
prosjek negativne log-izglednosti modela
preko svih podataka:

</p><p>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-17-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;W&lt;/mi&gt;&lt;mn mathvariant=&quot;bold&quot;&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;b&lt;/mi&gt;&lt;mn mathvariant=&quot;bold&quot;&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;W&lt;/mi&gt;&lt;mn mathvariant=&quot;bold&quot;&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;b&lt;/mi&gt;&lt;mn mathvariant=&quot;bold&quot;&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;X&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/mfrac&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/munder&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-258" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-259" class="mjx-mrow"><span id="MJXc-Node-260" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.265em;">L</span></span><span id="MJXc-Node-261" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">(</span></span><span id="MJXc-Node-262" class="mjx-texatom"><span id="MJXc-Node-263" class="mjx-mrow"><span id="MJXc-Node-264" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-265" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.37em; padding-bottom: 0.37em;">W</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-266" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.318em; padding-bottom: 0.37em;">1</span></span></span></span></span></span><span id="MJXc-Node-267" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.155em; padding-bottom: 0.528em;">,</span></span><span id="MJXc-Node-268" class="mjx-texatom MJXc-space1"><span id="MJXc-Node-269" class="mjx-mrow"><span id="MJXc-Node-270" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-271" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.37em; padding-bottom: 0.37em;">b</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-272" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.318em; padding-bottom: 0.37em;">1</span></span></span></span></span></span><span id="MJXc-Node-273" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.155em; padding-bottom: 0.528em;">,</span></span><span id="MJXc-Node-274" class="mjx-texatom MJXc-space1"><span id="MJXc-Node-275" class="mjx-mrow"><span id="MJXc-Node-276" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-277" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.37em; padding-bottom: 0.37em;">W</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-278" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.318em; padding-bottom: 0.37em;">2</span></span></span></span></span></span><span id="MJXc-Node-279" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.155em; padding-bottom: 0.528em;">,</span></span><span id="MJXc-Node-280" class="mjx-texatom MJXc-space1"><span id="MJXc-Node-281" class="mjx-mrow"><span id="MJXc-Node-282" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-283" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.37em; padding-bottom: 0.37em;">b</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-284" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.318em; padding-bottom: 0.37em;">2</span></span></span></span></span></span><span id="MJXc-Node-285" class="mjx-texatom"><span id="MJXc-Node-286" class="mjx-mrow"><span id="MJXc-Node-287" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">|</span></span></span></span><span id="MJXc-Node-288" class="mjx-texatom"><span id="MJXc-Node-289" class="mjx-mrow"><span id="MJXc-Node-290" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.37em; padding-bottom: 0.37em;">X</span></span></span></span><span id="MJXc-Node-291" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.155em; padding-bottom: 0.528em;">,</span></span><span id="MJXc-Node-292" class="mjx-texatom MJXc-space1"><span id="MJXc-Node-293" class="mjx-mrow"><span id="MJXc-Node-294" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.108em; padding-bottom: 0.58em;">y</span></span></span></span><span id="MJXc-Node-295" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">)</span></span><span id="MJXc-Node-296" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.055em; padding-bottom: 0.318em;">=</span></span><span id="MJXc-Node-297" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.318em; padding-bottom: 0.423em;">−</span></span><span id="MJXc-Node-298" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 0.769em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 1.088em; top: -1.298em;"><span id="MJXc-Node-299" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.37em; padding-bottom: 0.318em;">1</span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 1.088em; bottom: -0.608em;"><span id="MJXc-Node-300" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.265em; padding-right: 0.085em;">N</span></span></span><span class="mjx-line" style="border-bottom: 1.3px solid; top: -0.283em; width: 0.769em;"></span></span><span class="mjx-vsize" style="height: 1.347em; vertical-align: -0.43em;"></span></span><span id="MJXc-Node-301" class="mjx-munderover MJXc-space1"><span class="mjx-base"><span id="MJXc-Node-302" class="mjx-mo"><span class="mjx-char MJXc-TeX-size1-R" style="padding-top: 0.528em; padding-bottom: 0.528em;">∑</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.439em; padding-right: 0.071em;"><span id="MJXc-Node-303" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.423em; padding-bottom: 0.265em;">i</span></span></span></span><span id="MJXc-Node-304" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.528em;">log</span></span><span id="MJXc-Node-305" class="mjx-mo"><span class="mjx-char"></span></span><span id="MJXc-Node-306" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.265em; padding-right: 0.109em;">P</span></span><span id="MJXc-Node-307" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">(</span></span><span id="MJXc-Node-308" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.265em; padding-right: 0.182em;">Y</span></span><span id="MJXc-Node-309" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.055em; padding-bottom: 0.318em;">=</span></span><span id="MJXc-Node-310" class="mjx-msubsup MJXc-space3"><span class="mjx-base" style="margin-right: -0.006em;"><span id="MJXc-Node-311" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.213em; padding-bottom: 0.475em; padding-right: 0.006em;">y</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-312" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.423em; padding-bottom: 0.265em;">i</span></span></span></span><span id="MJXc-Node-313" class="mjx-texatom"><span id="MJXc-Node-314" class="mjx-mrow"><span id="MJXc-Node-315" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">|</span></span></span></span><span id="MJXc-Node-316" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-317" class="mjx-texatom"><span id="MJXc-Node-318" class="mjx-mrow"><span id="MJXc-Node-319" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.108em; padding-bottom: 0.37em;">x</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-320" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.423em; padding-bottom: 0.265em;">i</span></span></span></span><span id="MJXc-Node-321" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>L</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><msub><mi mathvariant="bold">W</mi><mn mathvariant="bold">1</mn></msub></mrow><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><msub><mi mathvariant="bold">b</mi><mn mathvariant="bold">1</mn></msub></mrow><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><msub><mi mathvariant="bold">W</mi><mn mathvariant="bold">2</mn></msub></mrow><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><msub><mi mathvariant="bold">b</mi><mn mathvariant="bold">2</mn></msub></mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">X</mi></mrow><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">y</mi></mrow><mo stretchy="false">)</mo><mo>=</mo><mo>−</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><munder><mo>∑</mo><mi>i</mi></munder><mi>log</mi><mo>⁡</mo><mi>P</mi><mo stretchy="false">(</mo><mi>Y</mi><mo>=</mo><msub><mi>y</mi><mi>i</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mi>i</mi></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-17">
 L(\mathbf{W_1},\mathbf{b_1},
   \mathbf{W_2},\mathbf{b_2}|
   \mathbf{X}, \mathbf{y})
 =
   -\frac{1}{N}
   \sum_i \log P(Y=y_i|\mathbf{x}_i) 
</script>

</p><p>
Vidimo da funkcija gubitka u podatku <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-18-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-322" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-323" class="mjx-mrow"><span id="MJXc-Node-324" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-325" class="mjx-texatom"><span id="MJXc-Node-326" class="mjx-mrow"><span id="MJXc-Node-327" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.108em; padding-bottom: 0.37em;">x</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-328" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.423em; padding-bottom: 0.265em;">i</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-18"> \mathbf{x}_i </script>
odgovara kompoziciji većeg broja jednostavnijih funkcija.
Gubitak <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-19-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-329" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-330" class="mjx-mrow"><span id="MJXc-Node-331" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.265em;">L</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>L</mi></math></span></span><script type="math/tex" id="MathJax-Element-19">L</script> ovisi o vjerojatnostima <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-20-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-332" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-333" class="mjx-mrow"><span id="MJXc-Node-334" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.265em; padding-right: 0.109em;">P</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi></math></span></span><script type="math/tex" id="MathJax-Element-20">P</script> koje ovise o
linearnoj klasifikacijskoj mjeri drugog sloja <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-21-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;s&lt;/mi&gt;&lt;mn mathvariant=&quot;bold&quot;&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-335" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-336" class="mjx-mrow"><span id="MJXc-Node-337" class="mjx-texatom"><span id="MJXc-Node-338" class="mjx-mrow"><span id="MJXc-Node-339" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-340" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.16em; padding-bottom: 0.37em;">s</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-341" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.318em; padding-bottom: 0.37em;">2</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><msub><mi mathvariant="bold">s</mi><mn mathvariant="bold">2</mn></msub></mrow></math></span></span><script type="math/tex" id="MathJax-Element-21">\mathbf{s_2}</script>
koja ovisi o skrivenom sloju <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-22-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;h&lt;/mi&gt;&lt;mn mathvariant=&quot;bold&quot;&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-342" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-343" class="mjx-mrow"><span id="MJXc-Node-344" class="mjx-texatom"><span id="MJXc-Node-345" class="mjx-mrow"><span id="MJXc-Node-346" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-347" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.37em; padding-bottom: 0.37em;">h</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-348" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.318em; padding-bottom: 0.37em;">1</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><msub><mi mathvariant="bold">h</mi><mn mathvariant="bold">1</mn></msub></mrow></math></span></span><script type="math/tex" id="MathJax-Element-22">\mathbf{h_1}</script>
i parametrima <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-23-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;W&lt;/mi&gt;&lt;mn mathvariant=&quot;bold&quot;&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-349" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-350" class="mjx-mrow"><span id="MJXc-Node-351" class="mjx-texatom"><span id="MJXc-Node-352" class="mjx-mrow"><span id="MJXc-Node-353" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-354" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.37em; padding-bottom: 0.37em;">W</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-355" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.318em; padding-bottom: 0.37em;">2</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><msub><mi mathvariant="bold">W</mi><mn mathvariant="bold">2</mn></msub></mrow></math></span></span><script type="math/tex" id="MathJax-Element-23">\mathbf{W_2}</script> i <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-24-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;b&lt;/mi&gt;&lt;mn mathvariant=&quot;bold&quot;&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-356" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-357" class="mjx-mrow"><span id="MJXc-Node-358" class="mjx-texatom"><span id="MJXc-Node-359" class="mjx-mrow"><span id="MJXc-Node-360" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-361" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.37em; padding-bottom: 0.37em;">b</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-362" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.318em; padding-bottom: 0.37em;">2</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><msub><mi mathvariant="bold">b</mi><mn mathvariant="bold">2</mn></msub></mrow></math></span></span><script type="math/tex" id="MathJax-Element-24">\mathbf{b_2}</script>.
Skriveni sloj <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-25-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;h&lt;/mi&gt;&lt;mn mathvariant=&quot;bold&quot;&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-363" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-364" class="mjx-mrow"><span id="MJXc-Node-365" class="mjx-texatom"><span id="MJXc-Node-366" class="mjx-mrow"><span id="MJXc-Node-367" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-368" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.37em; padding-bottom: 0.37em;">h</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-369" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.318em; padding-bottom: 0.37em;">1</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><msub><mi mathvariant="bold">h</mi><mn mathvariant="bold">1</mn></msub></mrow></math></span></span><script type="math/tex" id="MathJax-Element-25">\mathbf{h_1}</script> ovisi
o svojoj linearnoj mjeri <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-26-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;s&lt;/mi&gt;&lt;mn mathvariant=&quot;bold&quot;&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-370" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-371" class="mjx-mrow"><span id="MJXc-Node-372" class="mjx-texatom"><span id="MJXc-Node-373" class="mjx-mrow"><span id="MJXc-Node-374" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-375" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.16em; padding-bottom: 0.37em;">s</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-376" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.318em; padding-bottom: 0.37em;">1</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><msub><mi mathvariant="bold">s</mi><mn mathvariant="bold">1</mn></msub></mrow></math></span></span><script type="math/tex" id="MathJax-Element-26">\mathbf{s_1}</script>,
koja konačno ovisi o parametrima
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-27-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;W&lt;/mi&gt;&lt;mn mathvariant=&quot;bold&quot;&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-377" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-378" class="mjx-mrow"><span id="MJXc-Node-379" class="mjx-texatom"><span id="MJXc-Node-380" class="mjx-mrow"><span id="MJXc-Node-381" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-382" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.37em; padding-bottom: 0.37em;">W</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-383" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.318em; padding-bottom: 0.37em;">1</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><msub><mi mathvariant="bold">W</mi><mn mathvariant="bold">1</mn></msub></mrow></math></span></span><script type="math/tex" id="MathJax-Element-27">\mathbf{W_1}</script> i <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-28-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;b&lt;/mi&gt;&lt;mn mathvariant=&quot;bold&quot;&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-384" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-385" class="mjx-mrow"><span id="MJXc-Node-386" class="mjx-texatom"><span id="MJXc-Node-387" class="mjx-mrow"><span id="MJXc-Node-388" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-389" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.37em; padding-bottom: 0.37em;">b</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-390" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.318em; padding-bottom: 0.37em;">1</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><msub><mi mathvariant="bold">b</mi><mn mathvariant="bold">1</mn></msub></mrow></math></span></span><script type="math/tex" id="MathJax-Element-28">\mathbf{b_1}</script>
te podatcima <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-29-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-391" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-392" class="mjx-mrow"><span id="MJXc-Node-393" class="mjx-texatom"><span id="MJXc-Node-394" class="mjx-mrow"><span id="MJXc-Node-395" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.108em; padding-bottom: 0.37em;">x</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-29">\mathbf{x}</script>.
Stoga gradijente gubitka obzirom na parametre određujemo
<a href="https://en.wikipedia.org/wiki/Chain_rule#Higher_dimensions">ulančavanjem</a>.
Parcijalne derivacije gubitka po j-tim retcima
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-30-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;W&lt;/mi&gt;&lt;mn mathvariant=&quot;bold&quot;&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-396" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-397" class="mjx-mrow"><span id="MJXc-Node-398" class="mjx-texatom"><span id="MJXc-Node-399" class="mjx-mrow"><span id="MJXc-Node-400" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-401" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.37em; padding-bottom: 0.37em;">W</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-402" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.318em; padding-bottom: 0.37em;">2</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><msub><mi mathvariant="bold">W</mi><mn mathvariant="bold">2</mn></msub></mrow></math></span></span><script type="math/tex" id="MathJax-Element-30"> \mathbf{W_2} </script> i <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-31-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;b&lt;/mi&gt;&lt;mn mathvariant=&quot;bold&quot;&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-403" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-404" class="mjx-mrow"><span id="MJXc-Node-405" class="mjx-texatom"><span id="MJXc-Node-406" class="mjx-mrow"><span id="MJXc-Node-407" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-408" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.37em; padding-bottom: 0.37em;">b</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-409" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.318em; padding-bottom: 0.37em;">2</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><msub><mi mathvariant="bold">b</mi><mn mathvariant="bold">2</mn></msub></mrow></math></span></span><script type="math/tex" id="MathJax-Element-31"> \mathbf{b_2} </script>
biti će vrlo slične onom što smo imali
u višerazrednoj logističkoj regresiji.
U obzir ćemo uzeti algebarsku strukturu problema,
tj. da vrijedi:

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-32-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;W&lt;/mi&gt;&lt;mn mathvariant=&quot;bold&quot;&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;:&lt;/mo&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;b&lt;/mi&gt;&lt;mn mathvariant=&quot;bold&quot;&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;:&lt;/mo&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2200;&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2260;&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-410" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-411" class="mjx-mrow"><span id="MJXc-Node-412" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.37em; padding-right: 0.035em;">∂</span></span><span id="MJXc-Node-413" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-414" class="mjx-texatom"><span id="MJXc-Node-415" class="mjx-mrow"><span id="MJXc-Node-416" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-417" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.213em; padding-bottom: 0.265em;">s</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-418" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.37em; padding-bottom: 0.318em;">2</span></span></span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.287em; padding-right: 0.071em;"><span id="MJXc-Node-419" class="mjx-texatom" style=""><span id="MJXc-Node-420" class="mjx-mrow"><span id="MJXc-Node-421" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.423em; padding-bottom: 0.265em;">i</span></span><span id="MJXc-Node-422" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.423em; padding-bottom: 0.475em;">j</span></span></span></span></span></span><span id="MJXc-Node-423" class="mjx-texatom"><span id="MJXc-Node-424" class="mjx-mrow"><span id="MJXc-Node-425" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">/</span></span></span></span><span id="MJXc-Node-426" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.37em; padding-right: 0.035em;">∂</span></span><span id="MJXc-Node-427" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-428" class="mjx-texatom"><span id="MJXc-Node-429" class="mjx-mrow"><span id="MJXc-Node-430" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-431" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.37em; padding-bottom: 0.37em;">W</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-432" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.318em; padding-bottom: 0.37em;">2</span></span></span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.287em; padding-right: 0.071em;"><span id="MJXc-Node-433" class="mjx-texatom" style=""><span id="MJXc-Node-434" class="mjx-mrow"><span id="MJXc-Node-435" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.265em;">k</span></span><span id="MJXc-Node-436" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.16em; padding-bottom: 0.318em;">:</span></span></span></span></span></span><span id="MJXc-Node-437" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.055em; padding-bottom: 0.318em;">=</span></span><span id="MJXc-Node-438" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.37em; padding-right: 0.035em;">∂</span></span><span id="MJXc-Node-439" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-440" class="mjx-texatom"><span id="MJXc-Node-441" class="mjx-mrow"><span id="MJXc-Node-442" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-443" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.213em; padding-bottom: 0.265em;">s</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-444" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.37em; padding-bottom: 0.318em;">2</span></span></span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.287em; padding-right: 0.071em;"><span id="MJXc-Node-445" class="mjx-texatom" style=""><span id="MJXc-Node-446" class="mjx-mrow"><span id="MJXc-Node-447" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.423em; padding-bottom: 0.265em;">i</span></span><span id="MJXc-Node-448" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.423em; padding-bottom: 0.475em;">j</span></span></span></span></span></span><span id="MJXc-Node-449" class="mjx-texatom"><span id="MJXc-Node-450" class="mjx-mrow"><span id="MJXc-Node-451" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">/</span></span></span></span><span id="MJXc-Node-452" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.37em; padding-right: 0.035em;">∂</span></span><span id="MJXc-Node-453" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-454" class="mjx-texatom"><span id="MJXc-Node-455" class="mjx-mrow"><span id="MJXc-Node-456" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-457" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.37em; padding-bottom: 0.37em;">b</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-458" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.318em; padding-bottom: 0.37em;">2</span></span></span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.287em; padding-right: 0.071em;"><span id="MJXc-Node-459" class="mjx-texatom" style=""><span id="MJXc-Node-460" class="mjx-mrow"><span id="MJXc-Node-461" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.265em;">k</span></span><span id="MJXc-Node-462" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.16em; padding-bottom: 0.318em;">:</span></span></span></span></span></span><span id="MJXc-Node-463" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.055em; padding-bottom: 0.318em;">=</span></span><span id="MJXc-Node-464" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.37em; padding-bottom: 0.37em;">0</span></span><span id="MJXc-Node-465" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.155em; padding-bottom: 0.528em;">,</span></span><span id="MJXc-Node-466" class="mjx-mspace" style="width: 0.278em; height: 0px;"></span><span id="MJXc-Node-467" class="mjx-mi MJXc-space1"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.37em;">∀</span></span><span id="MJXc-Node-468" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.265em;">k</span></span><span id="MJXc-Node-469" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.58em;">≠</span></span><span id="MJXc-Node-470" class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.423em; padding-bottom: 0.475em;">j</span></span><span id="MJXc-Node-471" class="mjx-mspace" style="width: 0.278em; height: 0px;"></span><span id="MJXc-Node-472" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.155em; padding-bottom: 0.318em;">.</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">∂</mi><msub><mrow class="MJX-TeXAtom-ORD"><msub><mi>s</mi><mn>2</mn></msub></mrow><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow></msub><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mi mathvariant="normal">∂</mi><msub><mrow class="MJX-TeXAtom-ORD"><msub><mi mathvariant="bold">W</mi><mn mathvariant="bold">2</mn></msub></mrow><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>:</mo></mrow></msub><mo>=</mo><mi mathvariant="normal">∂</mi><msub><mrow class="MJX-TeXAtom-ORD"><msub><mi>s</mi><mn>2</mn></msub></mrow><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow></msub><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mi mathvariant="normal">∂</mi><msub><mrow class="MJX-TeXAtom-ORD"><msub><mi mathvariant="bold">b</mi><mn mathvariant="bold">2</mn></msub></mrow><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>:</mo></mrow></msub><mo>=</mo><mn>0</mn><mo>,</mo><mspace width="thickmathspace"></mspace><mi mathvariant="normal">∀</mi><mi>k</mi><mo>≠</mo><mi>j</mi><mspace width="thickmathspace"></mspace><mo>.</mo></math></span></span><script type="math/tex" id="MathJax-Element-32">
  \partial {s_2}_{ij}/
  \partial \mathbf{W_2}_{k:}
  =
  \partial {s_2}_{ij}/
  \partial \mathbf{b_2}_{k:}
  =
  0,
  \; \forall k \neq j \; .
</script>
<!--
Da bismo postigli kompaktniji zapis
koristit ćemo funkciju
\(\mathrm{lone\_row}(j,\mathbf{q})\)
koja vraća matricu \(\mathbf{Q}\)
čiji j-ti redak je vektor \(\mathbf{q}\),
dok su ostali retci nul-vektori.
Dogovorit ćemo se i da ta ista funkcija
primijenjena na skalarni argument
vraća stupčani vektor
čija j-ta komponenta odgovara skalarnom argumentu
dok su ostali elementi jednaki nuli.
-->
Da bismo postigli kompaktniji zapis koristit ćemo
matricu aposteriornih vjerojatnosti <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-33-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;P&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-473" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-474" class="mjx-mrow"><span id="MJXc-Node-475" class="mjx-texatom"><span id="MJXc-Node-476" class="mjx-mrow"><span id="MJXc-Node-477" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.37em; padding-bottom: 0.37em;">P</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">P</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-33">\mathbf{P}</script>
te matricu vektorski kodiranih oznaka <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-34-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;Y&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-478" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-479" class="mjx-mrow"><span id="MJXc-Node-480" class="mjx-texatom"><span id="MJXc-Node-481" class="mjx-mrow"><span id="MJXc-Node-482" class="mjx-msup"><span class="mjx-base"><span id="MJXc-Node-483" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.37em; padding-bottom: 0.37em;">Y</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-484" class="mjx-mo" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.265em; padding-bottom: 0.318em;">′</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><msup><mi mathvariant="bold">Y</mi><mo>′</mo></msup></mrow></math></span></span><script type="math/tex" id="MathJax-Element-34">\mathbf{Y'}</script>
koje smo uveli u nultoj vježbi.
Na kraju dobivamo sljedeće izraze:

</p><p>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-35-Frame" class="mjx-full-width mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2202;&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2202;&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;W&lt;/mi&gt;&lt;mn mathvariant=&quot;bold&quot;&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;:&lt;/mo&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2202;&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2202;&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2202;&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2202;&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;W&lt;/mi&gt;&lt;mn mathvariant=&quot;bold&quot;&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;:&lt;/mo&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;msubsup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;h&lt;/mi&gt;&lt;mn mathvariant=&quot;bold&quot;&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x22A4;&lt;/mi&gt;&lt;/msubsup&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mspace linebreak=&quot;newline&quot; /&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2202;&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2202;&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2202;&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2202;&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;s&lt;/mi&gt;&lt;mn mathvariant=&quot;bold&quot;&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2202;&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;s&lt;/mi&gt;&lt;mn mathvariant=&quot;bold&quot;&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2202;&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; min-width: 17.543em; position: relative;"><span id="MJXc-Node-485" class="mjx-math" style="width: 100%;" aria-hidden="true"><span id="MJXc-Node-486" class="mjx-mrow" style="width: 100%;"><span class="mjx-stack" style="width: 100%; vertical-align: -2.327em;"><span class="mjx-block"><span class="mjx-box"><span id="MJXc-Node-487" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 2.04em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 2.885em; top: -1.497em;"><span id="MJXc-Node-488" class="mjx-mrow" style=""><span id="MJXc-Node-489" class="mjx-texatom"><span id="MJXc-Node-490" class="mjx-mrow"><span id="MJXc-Node-491" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.37em;">∂</span></span></span></span><span id="MJXc-Node-492" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-493" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.265em;">L</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-494" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.423em; padding-bottom: 0.265em;">i</span></span></span></span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 2.885em; bottom: -0.98em;"><span id="MJXc-Node-495" class="mjx-mrow" style=""><span id="MJXc-Node-496" class="mjx-texatom"><span id="MJXc-Node-497" class="mjx-mrow"><span id="MJXc-Node-498" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.37em;">∂</span></span></span></span><span id="MJXc-Node-499" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-500" class="mjx-texatom"><span id="MJXc-Node-501" class="mjx-mrow"><span id="MJXc-Node-502" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-503" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.37em; padding-bottom: 0.37em;">W</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-504" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.318em; padding-bottom: 0.37em;">2</span></span></span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.287em; padding-right: 0.071em;"><span id="MJXc-Node-505" class="mjx-texatom" style=""><span id="MJXc-Node-506" class="mjx-mrow"><span id="MJXc-Node-507" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.423em; padding-bottom: 0.475em;">j</span></span><span id="MJXc-Node-508" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.16em; padding-bottom: 0.318em;">:</span></span></span></span></span></span></span></span><span class="mjx-line" style="border-bottom: 1.3px solid; top: -0.283em; width: 2.04em;"></span></span><span class="mjx-vsize" style="height: 1.751em; vertical-align: -0.693em;"></span></span><span id="MJXc-Node-509" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.055em; padding-bottom: 0.318em;">=</span></span><span id="MJXc-Node-510" class="mjx-mfrac MJXc-space3"><span class="mjx-box MJXc-stacked" style="width: 1.527em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 2.16em; top: -1.497em;"><span id="MJXc-Node-511" class="mjx-mrow" style=""><span id="MJXc-Node-512" class="mjx-texatom"><span id="MJXc-Node-513" class="mjx-mrow"><span id="MJXc-Node-514" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.37em;">∂</span></span></span></span><span id="MJXc-Node-515" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-516" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.265em;">L</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-517" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.423em; padding-bottom: 0.265em;">i</span></span></span></span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 2.16em; bottom: -0.98em;"><span id="MJXc-Node-518" class="mjx-mrow" style=""><span id="MJXc-Node-519" class="mjx-texatom"><span id="MJXc-Node-520" class="mjx-mrow"><span id="MJXc-Node-521" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.37em;">∂</span></span></span></span><span id="MJXc-Node-522" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-523" class="mjx-texatom"><span id="MJXc-Node-524" class="mjx-mrow"><span id="MJXc-Node-525" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-526" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.213em; padding-bottom: 0.265em;">s</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-527" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.37em; padding-bottom: 0.318em;">2</span></span></span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.287em; padding-right: 0.071em;"><span id="MJXc-Node-528" class="mjx-texatom" style=""><span id="MJXc-Node-529" class="mjx-mrow"><span id="MJXc-Node-530" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.423em; padding-bottom: 0.265em;">i</span></span><span id="MJXc-Node-531" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.423em; padding-bottom: 0.475em;">j</span></span></span></span></span></span></span></span><span class="mjx-line" style="border-bottom: 1.3px solid; top: -0.283em; width: 1.527em;"></span></span><span class="mjx-vsize" style="height: 1.751em; vertical-align: -0.693em;"></span></span><span id="MJXc-Node-532" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.003em; padding-bottom: 0.318em;">⋅</span></span><span id="MJXc-Node-533" class="mjx-mfrac MJXc-space2"><span class="mjx-box MJXc-stacked" style="width: 2.04em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 2.885em; top: -1.687em;"><span id="MJXc-Node-534" class="mjx-mrow" style=""><span id="MJXc-Node-535" class="mjx-texatom"><span id="MJXc-Node-536" class="mjx-mrow"><span id="MJXc-Node-537" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.37em;">∂</span></span></span></span><span id="MJXc-Node-538" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-539" class="mjx-texatom"><span id="MJXc-Node-540" class="mjx-mrow"><span id="MJXc-Node-541" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-542" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.213em; padding-bottom: 0.265em;">s</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-543" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.37em; padding-bottom: 0.318em;">2</span></span></span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.287em; padding-right: 0.071em;"><span id="MJXc-Node-544" class="mjx-texatom" style=""><span id="MJXc-Node-545" class="mjx-mrow"><span id="MJXc-Node-546" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.423em; padding-bottom: 0.265em;">i</span></span><span id="MJXc-Node-547" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.423em; padding-bottom: 0.475em;">j</span></span></span></span></span></span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 2.885em; bottom: -0.98em;"><span id="MJXc-Node-548" class="mjx-mrow" style=""><span id="MJXc-Node-549" class="mjx-texatom"><span id="MJXc-Node-550" class="mjx-mrow"><span id="MJXc-Node-551" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.37em;">∂</span></span></span></span><span id="MJXc-Node-552" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-553" class="mjx-texatom"><span id="MJXc-Node-554" class="mjx-mrow"><span id="MJXc-Node-555" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-556" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.37em; padding-bottom: 0.37em;">W</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-557" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.318em; padding-bottom: 0.37em;">2</span></span></span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.287em; padding-right: 0.071em;"><span id="MJXc-Node-558" class="mjx-texatom" style=""><span id="MJXc-Node-559" class="mjx-mrow"><span id="MJXc-Node-560" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.423em; padding-bottom: 0.475em;">j</span></span><span id="MJXc-Node-561" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.16em; padding-bottom: 0.318em;">:</span></span></span></span></span></span></span></span><span class="mjx-line" style="border-bottom: 1.3px solid; top: -0.283em; width: 2.04em;"></span></span><span class="mjx-vsize" style="height: 1.885em; vertical-align: -0.693em;"></span></span><span id="MJXc-Node-562" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.055em; padding-bottom: 0.318em;">=</span></span><span id="MJXc-Node-563" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">(</span></span><span id="MJXc-Node-564" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.109em;"><span id="MJXc-Node-565" class="mjx-texatom"><span id="MJXc-Node-566" class="mjx-mrow"><span id="MJXc-Node-567" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.265em; padding-right: 0.109em;">P</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-568" class="mjx-texatom" style=""><span id="MJXc-Node-569" class="mjx-mrow"><span id="MJXc-Node-570" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.423em; padding-bottom: 0.265em;">i</span></span><span id="MJXc-Node-571" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.423em; padding-bottom: 0.475em;">j</span></span></span></span></span></span><span id="MJXc-Node-572" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.318em; padding-bottom: 0.423em;">−</span></span><span id="MJXc-Node-573" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-574" class="mjx-texatom"><span id="MJXc-Node-575" class="mjx-mrow"><span id="MJXc-Node-576" class="mjx-msup"><span class="mjx-base" style="margin-right: -0.182em;"><span id="MJXc-Node-577" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.265em; padding-right: 0.182em;">Y</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0.405em; padding-right: 0.071em;"><span id="MJXc-Node-578" class="mjx-mo" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.265em; padding-bottom: 0.318em;">′</span></span></span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-579" class="mjx-texatom" style=""><span id="MJXc-Node-580" class="mjx-mrow"><span id="MJXc-Node-581" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.423em; padding-bottom: 0.265em;">i</span></span><span id="MJXc-Node-582" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.423em; padding-bottom: 0.475em;">j</span></span></span></span></span></span><span id="MJXc-Node-583" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">)</span></span><span id="MJXc-Node-584" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.003em; padding-bottom: 0.318em;">⋅</span></span><span id="MJXc-Node-585" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-586" class="mjx-texatom"><span id="MJXc-Node-587" class="mjx-mrow"><span id="MJXc-Node-588" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-589" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.37em; padding-bottom: 0.37em;">h</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-590" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.318em; padding-bottom: 0.37em;">1</span></span></span></span></span></span></span><span class="mjx-stack" style="vertical-align: -0.247em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.269em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-592" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.37em; padding-bottom: 0.318em;">⊤</span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-591" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.423em; padding-bottom: 0.265em;">i</span></span></span></span></span><span id="MJXc-Node-593" class="mjx-mspace" style="width: 0.278em; height: 0px;"></span><span id="MJXc-Node-594" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.155em; padding-bottom: 0.528em;">,</span></span></span></span><span class="mjx-block" style="padding-top: 0.442em;"><span class="mjx-box"><span id="MJXc-Node-595" class="mjx-mspace" style="width: 0px; height: 0px;"></span><span id="MJXc-Node-596" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 1.301em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 1.84em; top: -1.497em;"><span id="MJXc-Node-597" class="mjx-mrow" style=""><span id="MJXc-Node-598" class="mjx-texatom"><span id="MJXc-Node-599" class="mjx-mrow"><span id="MJXc-Node-600" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.37em;">∂</span></span></span></span><span id="MJXc-Node-601" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-602" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.265em;">L</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-603" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.423em; padding-bottom: 0.265em;">i</span></span></span></span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 1.84em; bottom: -0.926em;"><span id="MJXc-Node-604" class="mjx-mrow" style=""><span id="MJXc-Node-605" class="mjx-texatom"><span id="MJXc-Node-606" class="mjx-mrow"><span id="MJXc-Node-607" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.37em;">∂</span></span></span></span><span id="MJXc-Node-608" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-609" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.265em;">b</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-610" class="mjx-texatom" style=""><span id="MJXc-Node-611" class="mjx-mrow"><span id="MJXc-Node-612" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.37em; padding-bottom: 0.318em;">2</span></span><span id="MJXc-Node-613" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.423em; padding-bottom: 0.475em;">j</span></span></span></span></span></span></span></span><span class="mjx-line" style="border-bottom: 1.3px solid; top: -0.283em; width: 1.301em;"></span></span><span class="mjx-vsize" style="height: 1.714em; vertical-align: -0.655em;"></span></span><span id="MJXc-Node-614" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.055em; padding-bottom: 0.318em;">=</span></span><span id="MJXc-Node-615" class="mjx-mfrac MJXc-space3"><span class="mjx-box MJXc-stacked" style="width: 1.554em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 2.198em; top: -1.497em;"><span id="MJXc-Node-616" class="mjx-mrow" style=""><span id="MJXc-Node-617" class="mjx-texatom"><span id="MJXc-Node-618" class="mjx-mrow"><span id="MJXc-Node-619" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.37em;">∂</span></span></span></span><span id="MJXc-Node-620" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-621" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.265em;">L</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-622" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.423em; padding-bottom: 0.265em;">i</span></span></span></span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 2.198em; bottom: -0.98em;"><span id="MJXc-Node-623" class="mjx-mrow" style=""><span id="MJXc-Node-624" class="mjx-texatom"><span id="MJXc-Node-625" class="mjx-mrow"><span id="MJXc-Node-626" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.37em;">∂</span></span></span></span><span id="MJXc-Node-627" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-628" class="mjx-texatom"><span id="MJXc-Node-629" class="mjx-mrow"><span id="MJXc-Node-630" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-631" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.16em; padding-bottom: 0.37em;">s</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-632" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.318em; padding-bottom: 0.37em;">2</span></span></span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.287em; padding-right: 0.071em;"><span id="MJXc-Node-633" class="mjx-texatom" style=""><span id="MJXc-Node-634" class="mjx-mrow"><span id="MJXc-Node-635" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.423em; padding-bottom: 0.265em;">i</span></span><span id="MJXc-Node-636" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.423em; padding-bottom: 0.475em;">j</span></span></span></span></span></span></span></span><span class="mjx-line" style="border-bottom: 1.3px solid; top: -0.283em; width: 1.554em;"></span></span><span class="mjx-vsize" style="height: 1.751em; vertical-align: -0.693em;"></span></span><span id="MJXc-Node-637" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.003em; padding-bottom: 0.318em;">⋅</span></span><span id="MJXc-Node-638" class="mjx-mfrac MJXc-space2"><span class="mjx-box MJXc-stacked" style="width: 1.554em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 2.198em; top: -1.687em;"><span id="MJXc-Node-639" class="mjx-mrow" style=""><span id="MJXc-Node-640" class="mjx-texatom"><span id="MJXc-Node-641" class="mjx-mrow"><span id="MJXc-Node-642" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.37em;">∂</span></span></span></span><span id="MJXc-Node-643" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-644" class="mjx-texatom"><span id="MJXc-Node-645" class="mjx-mrow"><span id="MJXc-Node-646" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-647" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.16em; padding-bottom: 0.37em;">s</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-648" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.318em; padding-bottom: 0.37em;">2</span></span></span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.287em; padding-right: 0.071em;"><span id="MJXc-Node-649" class="mjx-texatom" style=""><span id="MJXc-Node-650" class="mjx-mrow"><span id="MJXc-Node-651" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.423em; padding-bottom: 0.265em;">i</span></span><span id="MJXc-Node-652" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.423em; padding-bottom: 0.475em;">j</span></span></span></span></span></span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 2.198em; bottom: -0.926em;"><span id="MJXc-Node-653" class="mjx-mrow" style=""><span id="MJXc-Node-654" class="mjx-texatom"><span id="MJXc-Node-655" class="mjx-mrow"><span id="MJXc-Node-656" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.37em;">∂</span></span></span></span><span id="MJXc-Node-657" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-658" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.265em;">b</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-659" class="mjx-texatom" style=""><span id="MJXc-Node-660" class="mjx-mrow"><span id="MJXc-Node-661" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.37em; padding-bottom: 0.318em;">2</span></span><span id="MJXc-Node-662" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.423em; padding-bottom: 0.475em;">j</span></span></span></span></span></span></span></span><span class="mjx-line" style="border-bottom: 1.3px solid; top: -0.283em; width: 1.554em;"></span></span><span class="mjx-vsize" style="height: 1.848em; vertical-align: -0.655em;"></span></span><span id="MJXc-Node-663" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.055em; padding-bottom: 0.318em;">=</span></span><span id="MJXc-Node-664" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">(</span></span><span id="MJXc-Node-665" class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.109em;"><span id="MJXc-Node-666" class="mjx-texatom"><span id="MJXc-Node-667" class="mjx-mrow"><span id="MJXc-Node-668" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.265em; padding-right: 0.109em;">P</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-669" class="mjx-texatom" style=""><span id="MJXc-Node-670" class="mjx-mrow"><span id="MJXc-Node-671" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.423em; padding-bottom: 0.265em;">i</span></span><span id="MJXc-Node-672" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.423em; padding-bottom: 0.475em;">j</span></span></span></span></span></span><span id="MJXc-Node-673" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.318em; padding-bottom: 0.423em;">−</span></span><span id="MJXc-Node-674" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-675" class="mjx-texatom"><span id="MJXc-Node-676" class="mjx-mrow"><span id="MJXc-Node-677" class="mjx-msup"><span class="mjx-base" style="margin-right: -0.182em;"><span id="MJXc-Node-678" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.265em; padding-right: 0.182em;">Y</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0.405em; padding-right: 0.071em;"><span id="MJXc-Node-679" class="mjx-mo" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.265em; padding-bottom: 0.318em;">′</span></span></span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-680" class="mjx-texatom" style=""><span id="MJXc-Node-681" class="mjx-mrow"><span id="MJXc-Node-682" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.423em; padding-bottom: 0.265em;">i</span></span><span id="MJXc-Node-683" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.423em; padding-bottom: 0.475em;">j</span></span></span></span></span></span><span id="MJXc-Node-684" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">)</span></span><span id="MJXc-Node-685" class="mjx-mspace" style="width: 0.278em; height: 0px;"></span><span id="MJXc-Node-686" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.155em; padding-bottom: 0.318em;">.</span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mrow><mrow class="MJX-TeXAtom-ORD"><mo>∂</mo></mrow><msub><mi>L</mi><mi>i</mi></msub></mrow><mrow><mrow class="MJX-TeXAtom-ORD"><mo>∂</mo></mrow><msub><mrow class="MJX-TeXAtom-ORD"><msub><mi mathvariant="bold">W</mi><mn mathvariant="bold">2</mn></msub></mrow><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>:</mo></mrow></msub></mrow></mfrac><mo>=</mo><mfrac><mrow><mrow class="MJX-TeXAtom-ORD"><mo>∂</mo></mrow><msub><mi>L</mi><mi>i</mi></msub></mrow><mrow><mrow class="MJX-TeXAtom-ORD"><mo>∂</mo></mrow><msub><mrow class="MJX-TeXAtom-ORD"><msub><mi>s</mi><mn>2</mn></msub></mrow><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow></msub></mrow></mfrac><mo>⋅</mo><mfrac><mrow><mrow class="MJX-TeXAtom-ORD"><mo>∂</mo></mrow><msub><mrow class="MJX-TeXAtom-ORD"><msub><mi>s</mi><mn>2</mn></msub></mrow><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow></msub></mrow><mrow><mrow class="MJX-TeXAtom-ORD"><mo>∂</mo></mrow><msub><mrow class="MJX-TeXAtom-ORD"><msub><mi mathvariant="bold">W</mi><mn mathvariant="bold">2</mn></msub></mrow><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>:</mo></mrow></msub></mrow></mfrac><mo>=</mo><mo stretchy="false">(</mo><msub><mrow class="MJX-TeXAtom-ORD"><mi>P</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow></msub><mo>−</mo><msub><mrow class="MJX-TeXAtom-ORD"><msup><mi>Y</mi><mo>′</mo></msup></mrow><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false">)</mo><mo>⋅</mo><msubsup><mrow class="MJX-TeXAtom-ORD"><msub><mi mathvariant="bold">h</mi><mn mathvariant="bold">1</mn></msub></mrow><mi>i</mi><mi mathvariant="normal">⊤</mi></msubsup><mspace width="thickmathspace"></mspace><mo>,</mo><mspace linebreak="newline"></mspace><mfrac><mrow><mrow class="MJX-TeXAtom-ORD"><mo>∂</mo></mrow><msub><mi>L</mi><mi>i</mi></msub></mrow><mrow><mrow class="MJX-TeXAtom-ORD"><mo>∂</mo></mrow><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mn>2</mn><mi>j</mi></mrow></msub></mrow></mfrac><mo>=</mo><mfrac><mrow><mrow class="MJX-TeXAtom-ORD"><mo>∂</mo></mrow><msub><mi>L</mi><mi>i</mi></msub></mrow><mrow><mrow class="MJX-TeXAtom-ORD"><mo>∂</mo></mrow><msub><mrow class="MJX-TeXAtom-ORD"><msub><mi mathvariant="bold">s</mi><mn mathvariant="bold">2</mn></msub></mrow><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow></msub></mrow></mfrac><mo>⋅</mo><mfrac><mrow><mrow class="MJX-TeXAtom-ORD"><mo>∂</mo></mrow><msub><mrow class="MJX-TeXAtom-ORD"><msub><mi mathvariant="bold">s</mi><mn mathvariant="bold">2</mn></msub></mrow><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow></msub></mrow><mrow><mrow class="MJX-TeXAtom-ORD"><mo>∂</mo></mrow><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mn>2</mn><mi>j</mi></mrow></msub></mrow></mfrac><mo>=</mo><mo stretchy="false">(</mo><msub><mrow class="MJX-TeXAtom-ORD"><mi>P</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow></msub><mo>−</mo><msub><mrow class="MJX-TeXAtom-ORD"><msup><mi>Y</mi><mo>′</mo></msup></mrow><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false">)</mo><mspace width="thickmathspace"></mspace><mo>.</mo></math></span></span><script type="math/tex" id="MathJax-Element-35">
\frac{∂L_i}{∂\mathbf{W_2}_{j:}} 
  =
  \frac{∂L_i}{∂{s_2}_{ij}} \cdot
  \frac{∂{s_2}_{ij}}{∂\mathbf{W_2}_{j:}}
  =
  ({P}_{ij} - {Y'}_{ij}) \cdot
   \mathbf{h_1}_i^\top \; ,
  \\
\frac{∂L_i}{∂b_{2j}}
  =
  \frac{∂L_i}{∂\mathbf{s_2}_{ij}} \cdot
  \frac{∂\mathbf{s_2}_{ij}}{∂b_{2j}}
  =
  ({P}_{ij} - {Y'}_{ij}) \; .
</script>

<!--
<p>
\(
\frac{∂L_i}{∂\mathbf{W_2}_{j:}} =
  \frac{∂L_i}{∂\mathbf{s_2}_i} \cdot
  \frac{∂\mathbf{s_2}_i}{∂\mathbf{W_2}_{j:}} =
  (\mathbf{P}_{i:} - \mathbf{Y'}_{i:}) \cdot
  \mathrm{lone\_row}(j,\mathbf{h_1}_i) =
  (\mathbf{P}_{ij} - \mathbf{Y'}_{ij}) \cdot
   \mathbf{h_1}_i^\top \; ,
  \\
\frac{∂L_i}{∂b_{2j}} =
  \frac{∂L_i}{∂\mathbf{s_2}_i} \cdot
  \frac{∂\mathbf{s_2}_i}{∂b_{2j}} = 
  (\mathbf{P}_{i:} - \mathbf{Y'}_{i:}) \cdot
  \mathrm{lone\_row}(j,1) =
  (\mathbf{P}_{ij} - \mathbf{Y'}_{ij}) \; .
\)
-->
 
</p><p>
Put do gradijenata po
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-36-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;W&lt;/mi&gt;&lt;mn mathvariant=&quot;bold&quot;&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-687" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-688" class="mjx-mrow"><span id="MJXc-Node-689" class="mjx-texatom"><span id="MJXc-Node-690" class="mjx-mrow"><span id="MJXc-Node-691" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-692" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.37em; padding-bottom: 0.37em;">W</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-693" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.318em; padding-bottom: 0.37em;">1</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><msub><mi mathvariant="bold">W</mi><mn mathvariant="bold">1</mn></msub></mrow></math></span></span><script type="math/tex" id="MathJax-Element-36">\mathbf{W_1}</script> i <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-37-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;b&lt;/mi&gt;&lt;mn mathvariant=&quot;bold&quot;&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-694" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-695" class="mjx-mrow"><span id="MJXc-Node-696" class="mjx-texatom"><span id="MJXc-Node-697" class="mjx-mrow"><span id="MJXc-Node-698" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-699" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.37em; padding-bottom: 0.37em;">b</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-700" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.318em; padding-bottom: 0.37em;">1</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><msub><mi mathvariant="bold">b</mi><mn mathvariant="bold">1</mn></msub></mrow></math></span></span><script type="math/tex" id="MathJax-Element-37">\mathbf{b_1}</script>
nešto je složeniji,
jer gradijente treba propagirati
preko svih komponenata drugog sloja.
Međutim, to propagiranje nije komplicirano
jer Jakobijan linearnog sloja odgovara matrici težina,
dok je Jakobijan zglobnice dijagonalna matrica
koja na dijagonali ima nule i jedinice
ovisno o predznaku odgovarajuće komponente prvog sloja.
Kad konačno dođemo do linearne mjere prvog sloja,
možemo iskoristiti izvode
koje smo bili dobili u drugom sloju.
Ovisnost linearne klasifikacijske mjere drugog sloja
o parametrima drugog sloja posve je jednaka
ovisnosti linearne mjere prvog sloja
o parametrima prvog sloja.
Stoga su analitički izrazi parcijalnih derivacija
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-38-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;s&lt;/mi&gt;&lt;/mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;W&lt;/mi&gt;&lt;mn mathvariant=&quot;bold&quot;&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-701" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-702" class="mjx-mrow"><span id="MJXc-Node-703" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.37em; padding-right: 0.035em;">∂</span></span><span id="MJXc-Node-704" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-705" class="mjx-texatom"><span id="MJXc-Node-706" class="mjx-mrow"><span id="MJXc-Node-707" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.16em; padding-bottom: 0.37em;">s</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-708" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.37em; padding-bottom: 0.318em;">1</span></span></span></span><span id="MJXc-Node-709" class="mjx-texatom"><span id="MJXc-Node-710" class="mjx-mrow"><span id="MJXc-Node-711" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">/</span></span></span></span><span id="MJXc-Node-712" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.37em; padding-right: 0.035em;">∂</span></span><span id="MJXc-Node-713" class="mjx-texatom"><span id="MJXc-Node-714" class="mjx-mrow"><span id="MJXc-Node-715" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-716" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.37em; padding-bottom: 0.37em;">W</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-717" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.318em; padding-bottom: 0.37em;">1</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">∂</mi><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">s</mi></mrow><mn>1</mn></msub><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mi mathvariant="normal">∂</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi mathvariant="bold">W</mi><mn mathvariant="bold">1</mn></msub></mrow></math></span></span><script type="math/tex" id="MathJax-Element-38">\partial \mathbf{s}_1/\partial \mathbf{W_1}</script>
vrlo slični odgovarajućim izrazima u drugom sloju:

</p><p>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-39-Frame" class="mjx-full-width mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2202;&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2202;&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;s&lt;/mi&gt;&lt;mn mathvariant=&quot;bold&quot;&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2202;&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2202;&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;s&lt;/mi&gt;&lt;mn mathvariant=&quot;bold&quot;&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2202;&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;s&lt;/mi&gt;&lt;mn mathvariant=&quot;bold&quot;&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2202;&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;h&lt;/mi&gt;&lt;mn mathvariant=&quot;bold&quot;&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2202;&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;h&lt;/mi&gt;&lt;mn mathvariant=&quot;bold&quot;&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2202;&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;s&lt;/mi&gt;&lt;mn mathvariant=&quot;bold&quot;&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;P&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;:&lt;/mo&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;Y&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;:&lt;/mo&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;W&lt;/mi&gt;&lt;mn mathvariant=&quot;bold&quot;&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;d&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;i&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;a&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;g&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mspace width=&quot;negativethinmathspace&quot; /&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;:&lt;/mo&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;gt;&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mspace width=&quot;negativethinmathspace&quot; /&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mspace linebreak=&quot;newline&quot; /&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2202;&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2202;&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;W&lt;/mi&gt;&lt;mn mathvariant=&quot;bold&quot;&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;:&lt;/mo&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2202;&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2202;&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2202;&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;s&lt;/mi&gt;&lt;mn mathvariant=&quot;bold&quot;&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2202;&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;W&lt;/mi&gt;&lt;mn mathvariant=&quot;bold&quot;&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;:&lt;/mo&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2202;&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2202;&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x22A4;&lt;/mi&gt;&lt;/msup&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mspace linebreak=&quot;newline&quot; /&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2202;&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2202;&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2202;&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2202;&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2202;&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;s&lt;/mi&gt;&lt;mn mathvariant=&quot;bold&quot;&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2202;&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2202;&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2202;&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; min-width: 26.328em; position: relative;"><span id="MJXc-Node-718" class="mjx-math" style="width: 100%;" aria-hidden="true"><span id="MJXc-Node-719" class="mjx-mrow" style="width: 100%;"><span class="mjx-stack" style="width: 100%; vertical-align: -4.558em;"><span class="mjx-block"><span class="mjx-box"><span id="MJXc-Node-720" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 1.348em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 1.906em; top: -1.497em;"><span id="MJXc-Node-721" class="mjx-mrow" style=""><span id="MJXc-Node-722" class="mjx-texatom"><span id="MJXc-Node-723" class="mjx-mrow"><span id="MJXc-Node-724" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.37em;">∂</span></span></span></span><span id="MJXc-Node-725" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-726" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.265em;">L</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-727" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.423em; padding-bottom: 0.265em;">i</span></span></span></span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 1.906em; bottom: -0.843em;"><span id="MJXc-Node-728" class="mjx-mrow" style=""><span id="MJXc-Node-729" class="mjx-texatom"><span id="MJXc-Node-730" class="mjx-mrow"><span id="MJXc-Node-731" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.37em;">∂</span></span></span></span><span id="MJXc-Node-732" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-733" class="mjx-texatom"><span id="MJXc-Node-734" class="mjx-mrow"><span id="MJXc-Node-735" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-736" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.16em; padding-bottom: 0.37em;">s</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-737" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.318em; padding-bottom: 0.37em;">1</span></span></span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.287em; padding-right: 0.071em;"><span id="MJXc-Node-738" class="mjx-texatom" style=""><span id="MJXc-Node-739" class="mjx-mrow"><span id="MJXc-Node-740" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.423em; padding-bottom: 0.265em;">i</span></span></span></span></span></span></span></span><span class="mjx-line" style="border-bottom: 1.3px solid; top: -0.283em; width: 1.348em;"></span></span><span class="mjx-vsize" style="height: 1.655em; vertical-align: -0.596em;"></span></span><span id="MJXc-Node-741" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.055em; padding-bottom: 0.318em;">=</span></span><span id="MJXc-Node-742" class="mjx-mfrac MJXc-space3"><span class="mjx-box MJXc-stacked" style="width: 1.348em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 1.906em; top: -1.497em;"><span id="MJXc-Node-743" class="mjx-mrow" style=""><span id="MJXc-Node-744" class="mjx-texatom"><span id="MJXc-Node-745" class="mjx-mrow"><span id="MJXc-Node-746" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.37em;">∂</span></span></span></span><span id="MJXc-Node-747" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-748" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.265em;">L</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-749" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.423em; padding-bottom: 0.265em;">i</span></span></span></span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 1.906em; bottom: -0.843em;"><span id="MJXc-Node-750" class="mjx-mrow" style=""><span id="MJXc-Node-751" class="mjx-texatom"><span id="MJXc-Node-752" class="mjx-mrow"><span id="MJXc-Node-753" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.37em;">∂</span></span></span></span><span id="MJXc-Node-754" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-755" class="mjx-texatom"><span id="MJXc-Node-756" class="mjx-mrow"><span id="MJXc-Node-757" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-758" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.16em; padding-bottom: 0.37em;">s</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-759" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.318em; padding-bottom: 0.37em;">2</span></span></span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.287em; padding-right: 0.071em;"><span id="MJXc-Node-760" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.423em; padding-bottom: 0.265em;">i</span></span></span></span></span></span><span class="mjx-line" style="border-bottom: 1.3px solid; top: -0.283em; width: 1.348em;"></span></span><span class="mjx-vsize" style="height: 1.655em; vertical-align: -0.596em;"></span></span><span id="MJXc-Node-761" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.003em; padding-bottom: 0.318em;">⋅</span></span><span id="MJXc-Node-762" class="mjx-mfrac MJXc-space2"><span class="mjx-box MJXc-stacked" style="width: 1.479em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 2.091em; top: -1.55em;"><span id="MJXc-Node-763" class="mjx-mrow" style=""><span id="MJXc-Node-764" class="mjx-texatom"><span id="MJXc-Node-765" class="mjx-mrow"><span id="MJXc-Node-766" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.37em;">∂</span></span></span></span><span id="MJXc-Node-767" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-768" class="mjx-texatom"><span id="MJXc-Node-769" class="mjx-mrow"><span id="MJXc-Node-770" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-771" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.16em; padding-bottom: 0.37em;">s</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-772" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.318em; padding-bottom: 0.37em;">2</span></span></span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.287em; padding-right: 0.071em;"><span id="MJXc-Node-773" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.423em; padding-bottom: 0.265em;">i</span></span></span></span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 2.091em; bottom: -0.843em;"><span id="MJXc-Node-774" class="mjx-mrow" style=""><span id="MJXc-Node-775" class="mjx-texatom"><span id="MJXc-Node-776" class="mjx-mrow"><span id="MJXc-Node-777" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.37em;">∂</span></span></span></span><span id="MJXc-Node-778" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-779" class="mjx-texatom"><span id="MJXc-Node-780" class="mjx-mrow"><span id="MJXc-Node-781" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-782" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.37em; padding-bottom: 0.37em;">h</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-783" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.318em; padding-bottom: 0.37em;">1</span></span></span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.287em; padding-right: 0.071em;"><span id="MJXc-Node-784" class="mjx-texatom" style=""><span id="MJXc-Node-785" class="mjx-mrow"><span id="MJXc-Node-786" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.423em; padding-bottom: 0.265em;">i</span></span></span></span></span></span></span></span><span class="mjx-line" style="border-bottom: 1.3px solid; top: -0.283em; width: 1.479em;"></span></span><span class="mjx-vsize" style="height: 1.692em; vertical-align: -0.596em;"></span></span><span id="MJXc-Node-787" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.003em; padding-bottom: 0.318em;">⋅</span></span><span id="MJXc-Node-788" class="mjx-mfrac MJXc-space2"><span class="mjx-box MJXc-stacked" style="width: 1.479em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 2.091em; top: -1.55em;"><span id="MJXc-Node-789" class="mjx-mrow" style=""><span id="MJXc-Node-790" class="mjx-texatom"><span id="MJXc-Node-791" class="mjx-mrow"><span id="MJXc-Node-792" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.37em;">∂</span></span></span></span><span id="MJXc-Node-793" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-794" class="mjx-texatom"><span id="MJXc-Node-795" class="mjx-mrow"><span id="MJXc-Node-796" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-797" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.37em; padding-bottom: 0.37em;">h</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-798" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.318em; padding-bottom: 0.37em;">1</span></span></span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.287em; padding-right: 0.071em;"><span id="MJXc-Node-799" class="mjx-texatom" style=""><span id="MJXc-Node-800" class="mjx-mrow"><span id="MJXc-Node-801" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.423em; padding-bottom: 0.265em;">i</span></span></span></span></span></span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 2.091em; bottom: -0.843em;"><span id="MJXc-Node-802" class="mjx-mrow" style=""><span id="MJXc-Node-803" class="mjx-texatom"><span id="MJXc-Node-804" class="mjx-mrow"><span id="MJXc-Node-805" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.37em;">∂</span></span></span></span><span id="MJXc-Node-806" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-807" class="mjx-texatom"><span id="MJXc-Node-808" class="mjx-mrow"><span id="MJXc-Node-809" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-810" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.16em; padding-bottom: 0.37em;">s</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-811" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.318em; padding-bottom: 0.37em;">1</span></span></span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.287em; padding-right: 0.071em;"><span id="MJXc-Node-812" class="mjx-texatom" style=""><span id="MJXc-Node-813" class="mjx-mrow"><span id="MJXc-Node-814" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.423em; padding-bottom: 0.265em;">i</span></span></span></span></span></span></span></span><span class="mjx-line" style="border-bottom: 1.3px solid; top: -0.283em; width: 1.479em;"></span></span><span class="mjx-vsize" style="height: 1.692em; vertical-align: -0.596em;"></span></span><span id="MJXc-Node-815" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.003em; padding-bottom: 0.318em;">⋅</span></span><span id="MJXc-Node-816" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.055em; padding-bottom: 0.318em;">=</span></span><span id="MJXc-Node-817" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">(</span></span><span id="MJXc-Node-818" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-819" class="mjx-texatom"><span id="MJXc-Node-820" class="mjx-mrow"><span id="MJXc-Node-821" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.37em; padding-bottom: 0.37em;">P</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-822" class="mjx-texatom" style=""><span id="MJXc-Node-823" class="mjx-mrow"><span id="MJXc-Node-824" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.423em; padding-bottom: 0.265em;">i</span></span><span id="MJXc-Node-825" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.16em; padding-bottom: 0.318em;">:</span></span></span></span></span></span><span id="MJXc-Node-826" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.318em; padding-bottom: 0.423em;">−</span></span><span id="MJXc-Node-827" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-828" class="mjx-texatom"><span id="MJXc-Node-829" class="mjx-mrow"><span id="MJXc-Node-830" class="mjx-msup"><span class="mjx-base"><span id="MJXc-Node-831" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.37em; padding-bottom: 0.37em;">Y</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-832" class="mjx-mo" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.265em; padding-bottom: 0.318em;">′</span></span></span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-833" class="mjx-texatom" style=""><span id="MJXc-Node-834" class="mjx-mrow"><span id="MJXc-Node-835" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.423em; padding-bottom: 0.265em;">i</span></span><span id="MJXc-Node-836" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.16em; padding-bottom: 0.318em;">:</span></span></span></span></span></span><span id="MJXc-Node-837" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">)</span></span><span id="MJXc-Node-838" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.003em; padding-bottom: 0.318em;">⋅</span></span><span id="MJXc-Node-839" class="mjx-texatom MJXc-space2"><span id="MJXc-Node-840" class="mjx-mrow"><span id="MJXc-Node-841" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-842" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.37em; padding-bottom: 0.37em;">W</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-843" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.318em; padding-bottom: 0.37em;">2</span></span></span></span></span></span><span id="MJXc-Node-844" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.003em; padding-bottom: 0.318em;">⋅</span></span><span id="MJXc-Node-845" class="mjx-texatom MJXc-space2"><span id="MJXc-Node-846" class="mjx-mrow"><span id="MJXc-Node-847" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.37em;">d</span></span><span id="MJXc-Node-848" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.37em; padding-bottom: 0.318em;">i</span></span><span id="MJXc-Node-849" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.16em; padding-bottom: 0.37em;">a</span></span><span id="MJXc-Node-850" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.16em; padding-bottom: 0.528em;">g</span></span></span></span><span id="MJXc-Node-851" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">(</span></span><span id="MJXc-Node-852" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">[</span></span><span id="MJXc-Node-853" class="mjx-mspace" style="margin-right: -0.167em; width: 0px; height: 0px;"></span><span id="MJXc-Node-854" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">[</span></span><span id="MJXc-Node-855" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-856" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.213em; padding-bottom: 0.265em;">s</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-857" class="mjx-texatom" style=""><span id="MJXc-Node-858" class="mjx-mrow"><span id="MJXc-Node-859" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.37em; padding-bottom: 0.318em;">1</span></span><span id="MJXc-Node-860" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.423em; padding-bottom: 0.265em;">i</span></span><span id="MJXc-Node-861" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.16em; padding-bottom: 0.318em;">:</span></span></span></span></span></span><span id="MJXc-Node-862" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.265em; padding-bottom: 0.37em;">&gt;</span></span><span id="MJXc-Node-863" class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.37em; padding-bottom: 0.37em;">0</span></span><span id="MJXc-Node-864" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">]</span></span><span id="MJXc-Node-865" class="mjx-mspace" style="margin-right: -0.167em; width: 0px; height: 0px;"></span><span id="MJXc-Node-866" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">]</span></span><span id="MJXc-Node-867" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">)</span></span><span id="MJXc-Node-868" class="mjx-mspace" style="width: 0.278em; height: 0px;"></span><span id="MJXc-Node-869" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.155em; padding-bottom: 0.528em;">,</span></span></span></span><span class="mjx-block" style="padding-top: 0.442em;"><span class="mjx-box"><span id="MJXc-Node-870" class="mjx-mspace" style="width: 0px; height: 0px;"></span><span id="MJXc-Node-871" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 2.04em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 2.885em; top: -1.497em;"><span id="MJXc-Node-872" class="mjx-mrow" style=""><span id="MJXc-Node-873" class="mjx-texatom"><span id="MJXc-Node-874" class="mjx-mrow"><span id="MJXc-Node-875" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.37em;">∂</span></span></span></span><span id="MJXc-Node-876" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-877" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.265em;">L</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-878" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.423em; padding-bottom: 0.265em;">i</span></span></span></span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 2.885em; bottom: -0.98em;"><span id="MJXc-Node-879" class="mjx-mrow" style=""><span id="MJXc-Node-880" class="mjx-texatom"><span id="MJXc-Node-881" class="mjx-mrow"><span id="MJXc-Node-882" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.37em;">∂</span></span></span></span><span id="MJXc-Node-883" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-884" class="mjx-texatom"><span id="MJXc-Node-885" class="mjx-mrow"><span id="MJXc-Node-886" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-887" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.37em; padding-bottom: 0.37em;">W</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-888" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.318em; padding-bottom: 0.37em;">1</span></span></span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.287em; padding-right: 0.071em;"><span id="MJXc-Node-889" class="mjx-texatom" style=""><span id="MJXc-Node-890" class="mjx-mrow"><span id="MJXc-Node-891" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.423em; padding-bottom: 0.475em;">j</span></span><span id="MJXc-Node-892" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.16em; padding-bottom: 0.318em;">:</span></span></span></span></span></span></span></span><span class="mjx-line" style="border-bottom: 1.3px solid; top: -0.283em; width: 2.04em;"></span></span><span class="mjx-vsize" style="height: 1.751em; vertical-align: -0.693em;"></span></span><span id="MJXc-Node-893" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.055em; padding-bottom: 0.318em;">=</span></span><span id="MJXc-Node-894" class="mjx-mfrac MJXc-space3"><span class="mjx-box MJXc-stacked" style="width: 1.527em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 2.16em; top: -1.497em;"><span id="MJXc-Node-895" class="mjx-mrow" style=""><span id="MJXc-Node-896" class="mjx-texatom"><span id="MJXc-Node-897" class="mjx-mrow"><span id="MJXc-Node-898" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.37em;">∂</span></span></span></span><span id="MJXc-Node-899" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-900" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.265em;">L</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-901" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.423em; padding-bottom: 0.265em;">i</span></span></span></span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 2.16em; bottom: -0.98em;"><span id="MJXc-Node-902" class="mjx-mrow" style=""><span id="MJXc-Node-903" class="mjx-texatom"><span id="MJXc-Node-904" class="mjx-mrow"><span id="MJXc-Node-905" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.37em;">∂</span></span></span></span><span id="MJXc-Node-906" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-907" class="mjx-texatom"><span id="MJXc-Node-908" class="mjx-mrow"><span id="MJXc-Node-909" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-910" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.213em; padding-bottom: 0.265em;">s</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-911" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.37em; padding-bottom: 0.318em;">1</span></span></span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.287em; padding-right: 0.071em;"><span id="MJXc-Node-912" class="mjx-texatom" style=""><span id="MJXc-Node-913" class="mjx-mrow"><span id="MJXc-Node-914" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.423em; padding-bottom: 0.265em;">i</span></span><span id="MJXc-Node-915" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.423em; padding-bottom: 0.475em;">j</span></span></span></span></span></span></span></span><span class="mjx-line" style="border-bottom: 1.3px solid; top: -0.283em; width: 1.527em;"></span></span><span class="mjx-vsize" style="height: 1.751em; vertical-align: -0.693em;"></span></span><span id="MJXc-Node-916" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 2.04em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 2.885em; top: -1.687em;"><span id="MJXc-Node-917" class="mjx-mrow" style=""><span id="MJXc-Node-918" class="mjx-texatom"><span id="MJXc-Node-919" class="mjx-mrow"><span id="MJXc-Node-920" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.37em;">∂</span></span></span></span><span id="MJXc-Node-921" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-922" class="mjx-texatom"><span id="MJXc-Node-923" class="mjx-mrow"><span id="MJXc-Node-924" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-925" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.16em; padding-bottom: 0.37em;">s</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-926" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.318em; padding-bottom: 0.37em;">1</span></span></span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.287em; padding-right: 0.071em;"><span id="MJXc-Node-927" class="mjx-texatom" style=""><span id="MJXc-Node-928" class="mjx-mrow"><span id="MJXc-Node-929" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.423em; padding-bottom: 0.265em;">i</span></span><span id="MJXc-Node-930" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.423em; padding-bottom: 0.475em;">j</span></span></span></span></span></span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 2.885em; bottom: -0.98em;"><span id="MJXc-Node-931" class="mjx-mrow" style=""><span id="MJXc-Node-932" class="mjx-texatom"><span id="MJXc-Node-933" class="mjx-mrow"><span id="MJXc-Node-934" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.37em;">∂</span></span></span></span><span id="MJXc-Node-935" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-936" class="mjx-texatom"><span id="MJXc-Node-937" class="mjx-mrow"><span id="MJXc-Node-938" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-939" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.37em; padding-bottom: 0.37em;">W</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-940" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.318em; padding-bottom: 0.37em;">1</span></span></span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.287em; padding-right: 0.071em;"><span id="MJXc-Node-941" class="mjx-texatom" style=""><span id="MJXc-Node-942" class="mjx-mrow"><span id="MJXc-Node-943" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.423em; padding-bottom: 0.475em;">j</span></span><span id="MJXc-Node-944" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.16em; padding-bottom: 0.318em;">:</span></span></span></span></span></span></span></span><span class="mjx-line" style="border-bottom: 1.3px solid; top: -0.283em; width: 2.04em;"></span></span><span class="mjx-vsize" style="height: 1.885em; vertical-align: -0.693em;"></span></span><span id="MJXc-Node-945" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.055em; padding-bottom: 0.318em;">=</span></span><span id="MJXc-Node-946" class="mjx-mfrac MJXc-space3"><span class="mjx-box MJXc-stacked" style="width: 1.527em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 2.16em; top: -1.497em;"><span id="MJXc-Node-947" class="mjx-mrow" style=""><span id="MJXc-Node-948" class="mjx-texatom"><span id="MJXc-Node-949" class="mjx-mrow"><span id="MJXc-Node-950" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.37em;">∂</span></span></span></span><span id="MJXc-Node-951" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-952" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.265em;">L</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-953" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.423em; padding-bottom: 0.265em;">i</span></span></span></span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 2.16em; bottom: -0.98em;"><span id="MJXc-Node-954" class="mjx-mrow" style=""><span id="MJXc-Node-955" class="mjx-texatom"><span id="MJXc-Node-956" class="mjx-mrow"><span id="MJXc-Node-957" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.37em;">∂</span></span></span></span><span id="MJXc-Node-958" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-959" class="mjx-texatom"><span id="MJXc-Node-960" class="mjx-mrow"><span id="MJXc-Node-961" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-962" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.213em; padding-bottom: 0.265em;">s</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-963" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.37em; padding-bottom: 0.318em;">1</span></span></span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.287em; padding-right: 0.071em;"><span id="MJXc-Node-964" class="mjx-texatom" style=""><span id="MJXc-Node-965" class="mjx-mrow"><span id="MJXc-Node-966" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.423em; padding-bottom: 0.265em;">i</span></span><span id="MJXc-Node-967" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.423em; padding-bottom: 0.475em;">j</span></span></span></span></span></span></span></span><span class="mjx-line" style="border-bottom: 1.3px solid; top: -0.283em; width: 1.527em;"></span></span><span class="mjx-vsize" style="height: 1.751em; vertical-align: -0.693em;"></span></span><span id="MJXc-Node-968" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-969" class="mjx-texatom"><span id="MJXc-Node-970" class="mjx-mrow"><span id="MJXc-Node-971" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-972" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.108em; padding-bottom: 0.37em;">x</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.22em; padding-right: 0.071em;"><span id="MJXc-Node-973" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.37em; padding-bottom: 0.37em;">i</span></span></span></span></span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-974" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.37em; padding-bottom: 0.318em;">⊤</span></span></span></span><span id="MJXc-Node-975" class="mjx-mspace" style="width: 0.278em; height: 0px;"></span><span id="MJXc-Node-976" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.155em; padding-bottom: 0.528em;">,</span></span></span></span><span class="mjx-block" style="padding-top: 0.442em;"><span class="mjx-box"><span id="MJXc-Node-977" class="mjx-mspace" style="width: 0px; height: 0px;"></span><span id="MJXc-Node-978" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 1.301em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 1.84em; top: -1.497em;"><span id="MJXc-Node-979" class="mjx-mrow" style=""><span id="MJXc-Node-980" class="mjx-texatom"><span id="MJXc-Node-981" class="mjx-mrow"><span id="MJXc-Node-982" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.37em;">∂</span></span></span></span><span id="MJXc-Node-983" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-984" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.265em;">L</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-985" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.423em; padding-bottom: 0.265em;">i</span></span></span></span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 1.84em; bottom: -0.926em;"><span id="MJXc-Node-986" class="mjx-mrow" style=""><span id="MJXc-Node-987" class="mjx-texatom"><span id="MJXc-Node-988" class="mjx-mrow"><span id="MJXc-Node-989" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.37em;">∂</span></span></span></span><span id="MJXc-Node-990" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-991" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.265em;">b</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-992" class="mjx-texatom" style=""><span id="MJXc-Node-993" class="mjx-mrow"><span id="MJXc-Node-994" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.37em; padding-bottom: 0.318em;">1</span></span><span id="MJXc-Node-995" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.423em; padding-bottom: 0.475em;">j</span></span></span></span></span></span></span></span><span class="mjx-line" style="border-bottom: 1.3px solid; top: -0.283em; width: 1.301em;"></span></span><span class="mjx-vsize" style="height: 1.714em; vertical-align: -0.655em;"></span></span><span id="MJXc-Node-996" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.055em; padding-bottom: 0.318em;">=</span></span><span id="MJXc-Node-997" class="mjx-mfrac MJXc-space3"><span class="mjx-box MJXc-stacked" style="width: 1.527em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 2.16em; top: -1.497em;"><span id="MJXc-Node-998" class="mjx-mrow" style=""><span id="MJXc-Node-999" class="mjx-texatom"><span id="MJXc-Node-1000" class="mjx-mrow"><span id="MJXc-Node-1001" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.37em;">∂</span></span></span></span><span id="MJXc-Node-1002" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1003" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.265em;">L</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1004" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.423em; padding-bottom: 0.265em;">i</span></span></span></span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 2.16em; bottom: -0.98em;"><span id="MJXc-Node-1005" class="mjx-mrow" style=""><span id="MJXc-Node-1006" class="mjx-texatom"><span id="MJXc-Node-1007" class="mjx-mrow"><span id="MJXc-Node-1008" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.37em;">∂</span></span></span></span><span id="MJXc-Node-1009" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1010" class="mjx-texatom"><span id="MJXc-Node-1011" class="mjx-mrow"><span id="MJXc-Node-1012" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1013" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.213em; padding-bottom: 0.265em;">s</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1014" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.37em; padding-bottom: 0.318em;">1</span></span></span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.287em; padding-right: 0.071em;"><span id="MJXc-Node-1015" class="mjx-texatom" style=""><span id="MJXc-Node-1016" class="mjx-mrow"><span id="MJXc-Node-1017" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.423em; padding-bottom: 0.265em;">i</span></span><span id="MJXc-Node-1018" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.423em; padding-bottom: 0.475em;">j</span></span></span></span></span></span></span></span><span class="mjx-line" style="border-bottom: 1.3px solid; top: -0.283em; width: 1.527em;"></span></span><span class="mjx-vsize" style="height: 1.751em; vertical-align: -0.693em;"></span></span><span id="MJXc-Node-1019" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 1.554em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 2.198em; top: -1.687em;"><span id="MJXc-Node-1020" class="mjx-mrow" style=""><span id="MJXc-Node-1021" class="mjx-texatom"><span id="MJXc-Node-1022" class="mjx-mrow"><span id="MJXc-Node-1023" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.37em;">∂</span></span></span></span><span id="MJXc-Node-1024" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1025" class="mjx-texatom"><span id="MJXc-Node-1026" class="mjx-mrow"><span id="MJXc-Node-1027" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1028" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.16em; padding-bottom: 0.37em;">s</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1029" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.318em; padding-bottom: 0.37em;">1</span></span></span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.287em; padding-right: 0.071em;"><span id="MJXc-Node-1030" class="mjx-texatom" style=""><span id="MJXc-Node-1031" class="mjx-mrow"><span id="MJXc-Node-1032" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.423em; padding-bottom: 0.265em;">i</span></span><span id="MJXc-Node-1033" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.423em; padding-bottom: 0.475em;">j</span></span></span></span></span></span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 2.198em; bottom: -0.98em;"><span id="MJXc-Node-1034" class="mjx-mrow" style=""><span id="MJXc-Node-1035" class="mjx-texatom"><span id="MJXc-Node-1036" class="mjx-mrow"><span id="MJXc-Node-1037" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.37em;">∂</span></span></span></span><span id="MJXc-Node-1038" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1039" class="mjx-texatom"><span id="MJXc-Node-1040" class="mjx-mrow"><span id="MJXc-Node-1041" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1042" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.265em;">b</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1043" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.37em; padding-bottom: 0.318em;">1</span></span></span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.287em; padding-right: 0.071em;"><span id="MJXc-Node-1044" class="mjx-texatom" style=""><span id="MJXc-Node-1045" class="mjx-mrow"><span id="MJXc-Node-1046" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.423em; padding-bottom: 0.475em;">j</span></span></span></span></span></span></span></span><span class="mjx-line" style="border-bottom: 1.3px solid; top: -0.283em; width: 1.554em;"></span></span><span class="mjx-vsize" style="height: 1.885em; vertical-align: -0.693em;"></span></span><span id="MJXc-Node-1047" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.055em; padding-bottom: 0.318em;">=</span></span><span id="MJXc-Node-1048" class="mjx-mfrac MJXc-space3"><span class="mjx-box MJXc-stacked" style="width: 1.527em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 2.16em; top: -1.497em;"><span id="MJXc-Node-1049" class="mjx-mrow" style=""><span id="MJXc-Node-1050" class="mjx-texatom"><span id="MJXc-Node-1051" class="mjx-mrow"><span id="MJXc-Node-1052" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.37em;">∂</span></span></span></span><span id="MJXc-Node-1053" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1054" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.265em;">L</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1055" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.423em; padding-bottom: 0.265em;">i</span></span></span></span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 2.16em; bottom: -0.98em;"><span id="MJXc-Node-1056" class="mjx-mrow" style=""><span id="MJXc-Node-1057" class="mjx-texatom"><span id="MJXc-Node-1058" class="mjx-mrow"><span id="MJXc-Node-1059" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.37em;">∂</span></span></span></span><span id="MJXc-Node-1060" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1061" class="mjx-texatom"><span id="MJXc-Node-1062" class="mjx-mrow"><span id="MJXc-Node-1063" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1064" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.213em; padding-bottom: 0.265em;">s</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1065" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.37em; padding-bottom: 0.318em;">1</span></span></span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.287em; padding-right: 0.071em;"><span id="MJXc-Node-1066" class="mjx-texatom" style=""><span id="MJXc-Node-1067" class="mjx-mrow"><span id="MJXc-Node-1068" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.423em; padding-bottom: 0.265em;">i</span></span><span id="MJXc-Node-1069" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.423em; padding-bottom: 0.475em;">j</span></span></span></span></span></span></span></span><span class="mjx-line" style="border-bottom: 1.3px solid; top: -0.283em; width: 1.527em;"></span></span><span class="mjx-vsize" style="height: 1.751em; vertical-align: -0.693em;"></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mrow><mrow class="MJX-TeXAtom-ORD"><mo>∂</mo></mrow><msub><mi>L</mi><mi>i</mi></msub></mrow><mrow><mrow class="MJX-TeXAtom-ORD"><mo>∂</mo></mrow><msub><mrow class="MJX-TeXAtom-ORD"><msub><mi mathvariant="bold">s</mi><mn mathvariant="bold">1</mn></msub></mrow><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub></mrow></mfrac><mo>=</mo><mfrac><mrow><mrow class="MJX-TeXAtom-ORD"><mo>∂</mo></mrow><msub><mi>L</mi><mi>i</mi></msub></mrow><mrow><mrow class="MJX-TeXAtom-ORD"><mo>∂</mo></mrow><msub><mrow class="MJX-TeXAtom-ORD"><msub><mi mathvariant="bold">s</mi><mn mathvariant="bold">2</mn></msub></mrow><mi>i</mi></msub></mrow></mfrac><mo>⋅</mo><mfrac><mrow><mrow class="MJX-TeXAtom-ORD"><mo>∂</mo></mrow><msub><mrow class="MJX-TeXAtom-ORD"><msub><mi mathvariant="bold">s</mi><mn mathvariant="bold">2</mn></msub></mrow><mi>i</mi></msub></mrow><mrow><mrow class="MJX-TeXAtom-ORD"><mo>∂</mo></mrow><msub><mrow class="MJX-TeXAtom-ORD"><msub><mi mathvariant="bold">h</mi><mn mathvariant="bold">1</mn></msub></mrow><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub></mrow></mfrac><mo>⋅</mo><mfrac><mrow><mrow class="MJX-TeXAtom-ORD"><mo>∂</mo></mrow><msub><mrow class="MJX-TeXAtom-ORD"><msub><mi mathvariant="bold">h</mi><mn mathvariant="bold">1</mn></msub></mrow><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub></mrow><mrow><mrow class="MJX-TeXAtom-ORD"><mo>∂</mo></mrow><msub><mrow class="MJX-TeXAtom-ORD"><msub><mi mathvariant="bold">s</mi><mn mathvariant="bold">1</mn></msub></mrow><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub></mrow></mfrac><mo>⋅</mo><mo>=</mo><mo stretchy="false">(</mo><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">P</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>:</mo></mrow></msub><mo>−</mo><msub><mrow class="MJX-TeXAtom-ORD"><msup><mi mathvariant="bold">Y</mi><mo>′</mo></msup></mrow><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>:</mo></mrow></msub><mo stretchy="false">)</mo><mo>⋅</mo><mrow class="MJX-TeXAtom-ORD"><msub><mi mathvariant="bold">W</mi><mn mathvariant="bold">2</mn></msub></mrow><mo>⋅</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">d</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">g</mi></mrow><mo stretchy="false">(</mo><mo stretchy="false">[</mo><mspace width="negativethinmathspace"></mspace><mo stretchy="false">[</mo><msub><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn><mi>i</mi><mo>:</mo></mrow></msub><mo>&gt;</mo><mn>0</mn><mo stretchy="false">]</mo><mspace width="negativethinmathspace"></mspace><mo stretchy="false">]</mo><mo stretchy="false">)</mo><mspace width="thickmathspace"></mspace><mo>,</mo><mspace linebreak="newline"></mspace><mfrac><mrow><mrow class="MJX-TeXAtom-ORD"><mo>∂</mo></mrow><msub><mi>L</mi><mi>i</mi></msub></mrow><mrow><mrow class="MJX-TeXAtom-ORD"><mo>∂</mo></mrow><msub><mrow class="MJX-TeXAtom-ORD"><msub><mi mathvariant="bold">W</mi><mn mathvariant="bold">1</mn></msub></mrow><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>:</mo></mrow></msub></mrow></mfrac><mo>=</mo><mfrac><mrow><mrow class="MJX-TeXAtom-ORD"><mo>∂</mo></mrow><msub><mi>L</mi><mi>i</mi></msub></mrow><mrow><mrow class="MJX-TeXAtom-ORD"><mo>∂</mo></mrow><msub><mrow class="MJX-TeXAtom-ORD"><msub><mi>s</mi><mn>1</mn></msub></mrow><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow></msub></mrow></mfrac><mfrac><mrow><mrow class="MJX-TeXAtom-ORD"><mo>∂</mo></mrow><msub><mrow class="MJX-TeXAtom-ORD"><msub><mi mathvariant="bold">s</mi><mn mathvariant="bold">1</mn></msub></mrow><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow></msub></mrow><mrow><mrow class="MJX-TeXAtom-ORD"><mo>∂</mo></mrow><msub><mrow class="MJX-TeXAtom-ORD"><msub><mi mathvariant="bold">W</mi><mn mathvariant="bold">1</mn></msub></mrow><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>:</mo></mrow></msub></mrow></mfrac><mo>=</mo><mfrac><mrow><mrow class="MJX-TeXAtom-ORD"><mo>∂</mo></mrow><msub><mi>L</mi><mi>i</mi></msub></mrow><mrow><mrow class="MJX-TeXAtom-ORD"><mo>∂</mo></mrow><msub><mrow class="MJX-TeXAtom-ORD"><msub><mi>s</mi><mn>1</mn></msub></mrow><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow></msub></mrow></mfrac><msup><mrow class="MJX-TeXAtom-ORD"><msub><mi mathvariant="bold">x</mi><mi mathvariant="bold">i</mi></msub></mrow><mi mathvariant="normal">⊤</mi></msup><mspace width="thickmathspace"></mspace><mo>,</mo><mspace linebreak="newline"></mspace><mfrac><mrow><mrow class="MJX-TeXAtom-ORD"><mo>∂</mo></mrow><msub><mi>L</mi><mi>i</mi></msub></mrow><mrow><mrow class="MJX-TeXAtom-ORD"><mo>∂</mo></mrow><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn><mi>j</mi></mrow></msub></mrow></mfrac><mo>=</mo><mfrac><mrow><mrow class="MJX-TeXAtom-ORD"><mo>∂</mo></mrow><msub><mi>L</mi><mi>i</mi></msub></mrow><mrow><mrow class="MJX-TeXAtom-ORD"><mo>∂</mo></mrow><msub><mrow class="MJX-TeXAtom-ORD"><msub><mi>s</mi><mn>1</mn></msub></mrow><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow></msub></mrow></mfrac><mfrac><mrow><mrow class="MJX-TeXAtom-ORD"><mo>∂</mo></mrow><msub><mrow class="MJX-TeXAtom-ORD"><msub><mi mathvariant="bold">s</mi><mn mathvariant="bold">1</mn></msub></mrow><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow></msub></mrow><mrow><mrow class="MJX-TeXAtom-ORD"><mo>∂</mo></mrow><msub><mrow class="MJX-TeXAtom-ORD"><msub><mi>b</mi><mn>1</mn></msub></mrow><mrow class="MJX-TeXAtom-ORD"><mi>j</mi></mrow></msub></mrow></mfrac><mo>=</mo><mfrac><mrow><mrow class="MJX-TeXAtom-ORD"><mo>∂</mo></mrow><msub><mi>L</mi><mi>i</mi></msub></mrow><mrow><mrow class="MJX-TeXAtom-ORD"><mo>∂</mo></mrow><msub><mrow class="MJX-TeXAtom-ORD"><msub><mi>s</mi><mn>1</mn></msub></mrow><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow></msub></mrow></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-39">
\frac{∂L_i}{∂\mathbf{s_1}_{i}}
  =
  \frac{∂L_i}{∂\mathbf{s_2}_i} \cdot
  \frac{∂\mathbf{s_2}_i}{∂\mathbf{h_1}_{i}} \cdot
  \frac{∂\mathbf{h_1}_{i}}{∂\mathbf{s_1}_{i}} \cdot
  =
  (\mathbf{P}_{i:} - \mathbf{Y'}_{i:}) \cdot
  \mathbf{W_2} \cdot
  \mathrm{diag}([\![s_{1i:}>0]\!]) \;,
\\
\frac{∂L_i}{∂\mathbf{W_1}_{j:}}
  =
  \frac{∂L_i}{∂{s_1}_{ij}}
  \frac{∂\mathbf{s_1}_{ij}}{∂\mathbf{W_1}_{j:}}
  =
  \frac{∂L_i}{∂{s_1}_{ij}}
  \mathbf{x_i}^\top \;,
\\
\frac{∂L_i}{∂b_{1j}} 
  =
  \frac{∂L_i}{∂{s_1}_{ij}}
  \frac{∂\mathbf{s_1}_{ij}}{∂{b_1}_{j}}
  =
  \frac{∂L_i}{∂{s_1}_{ij}}
</script>

</p><p>
Ovdje valja primijetiti kako
naša ambicija nije brzo izračunati
<em>pojedine</em> gradijente
za <em>pojedine</em> podatke.
Naprotiv, naš cilj je brzo izračunati
<em>sve</em> gradijente za <em>sve</em> podatke
oslanjanjem na optimirane biblioteke matrične algebre.
S obzirom na to da najveći doprinos brzini
možemo ostvariti memorijskim optimizacijama,
model trebamo izraziti matričnim operacijama
koje djeluju nad svim podatcima.
Stoga ćemo, kao i kod logističke regresije
gradijente svakog sloja računati odjednom
za sve retke parametara i za sve podatke.

</p><p>
Međutim, za razliku od logističke regresije,
u dubokim mrežama moramo donijeti odluku
o redoslijedu računanja gradijenata
(npr. hoćemo li prije računati 
 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-40-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2202;&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2202;&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;b&lt;/mi&gt;&lt;mn mathvariant=&quot;bold&quot;&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-1070" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1071" class="mjx-mrow"><span id="MJXc-Node-1072" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 1.281em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 1.812em; top: -1.497em;"><span id="MJXc-Node-1073" class="mjx-mrow" style=""><span id="MJXc-Node-1074" class="mjx-texatom"><span id="MJXc-Node-1075" class="mjx-mrow"><span id="MJXc-Node-1076" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.37em;">∂</span></span></span></span><span id="MJXc-Node-1077" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1078" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.265em;">L</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1079" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.423em; padding-bottom: 0.265em;">i</span></span></span></span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 1.812em; bottom: -0.782em;"><span id="MJXc-Node-1080" class="mjx-mrow" style=""><span id="MJXc-Node-1081" class="mjx-texatom"><span id="MJXc-Node-1082" class="mjx-mrow"><span id="MJXc-Node-1083" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.37em;">∂</span></span></span></span><span id="MJXc-Node-1084" class="mjx-texatom"><span id="MJXc-Node-1085" class="mjx-mrow"><span id="MJXc-Node-1086" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1087" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.37em; padding-bottom: 0.37em;">b</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1088" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.318em; padding-bottom: 0.37em;">1</span></span></span></span></span></span></span></span><span class="mjx-line" style="border-bottom: 1.3px solid; top: -0.283em; width: 1.281em;"></span></span><span class="mjx-vsize" style="height: 1.612em; vertical-align: -0.553em;"></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mrow><mrow class="MJX-TeXAtom-ORD"><mo>∂</mo></mrow><msub><mi>L</mi><mi>i</mi></msub></mrow><mrow><mrow class="MJX-TeXAtom-ORD"><mo>∂</mo></mrow><mrow class="MJX-TeXAtom-ORD"><msub><mi mathvariant="bold">b</mi><mn mathvariant="bold">1</mn></msub></mrow></mrow></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-40">\frac{∂L_i}{∂\mathbf{b_1}}</script>
 ili 
 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-41-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2202;&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2202;&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;b&lt;/mi&gt;&lt;mn mathvariant=&quot;bold&quot;&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-1089" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1090" class="mjx-mrow"><span id="MJXc-Node-1091" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 1.281em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 1.812em; top: -1.497em;"><span id="MJXc-Node-1092" class="mjx-mrow" style=""><span id="MJXc-Node-1093" class="mjx-texatom"><span id="MJXc-Node-1094" class="mjx-mrow"><span id="MJXc-Node-1095" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.37em;">∂</span></span></span></span><span id="MJXc-Node-1096" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1097" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.265em;">L</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1098" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.423em; padding-bottom: 0.265em;">i</span></span></span></span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 1.812em; bottom: -0.782em;"><span id="MJXc-Node-1099" class="mjx-mrow" style=""><span id="MJXc-Node-1100" class="mjx-texatom"><span id="MJXc-Node-1101" class="mjx-mrow"><span id="MJXc-Node-1102" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.37em;">∂</span></span></span></span><span id="MJXc-Node-1103" class="mjx-texatom"><span id="MJXc-Node-1104" class="mjx-mrow"><span id="MJXc-Node-1105" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1106" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.37em; padding-bottom: 0.37em;">b</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1107" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.318em; padding-bottom: 0.37em;">2</span></span></span></span></span></span></span></span><span class="mjx-line" style="border-bottom: 1.3px solid; top: -0.283em; width: 1.281em;"></span></span><span class="mjx-vsize" style="height: 1.612em; vertical-align: -0.553em;"></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mrow><mrow class="MJX-TeXAtom-ORD"><mo>∂</mo></mrow><msub><mi>L</mi><mi>i</mi></msub></mrow><mrow><mrow class="MJX-TeXAtom-ORD"><mo>∂</mo></mrow><mrow class="MJX-TeXAtom-ORD"><msub><mi mathvariant="bold">b</mi><mn mathvariant="bold">2</mn></msub></mrow></mrow></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-41">\frac{∂L_i}{∂\mathbf{b_2}}</script>).
Putokaz za rješavanje tog rebusa
daje nam algoritam širenja unatrag.

</p><h5>Računanje gradijenata širenjem unatrag</h5>

<p>
U prikazanim jednadžbama možemo uočiti
jednu specifičnost dubokih modela:
vidimo da se parcijalna derivacija
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-42-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2202;&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2202;&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;s&lt;/mi&gt;&lt;mn mathvariant=&quot;bold&quot;&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-1108" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1109" class="mjx-mrow"><span id="MJXc-Node-1110" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 1.348em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 1.906em; top: -1.497em;"><span id="MJXc-Node-1111" class="mjx-mrow" style=""><span id="MJXc-Node-1112" class="mjx-texatom"><span id="MJXc-Node-1113" class="mjx-mrow"><span id="MJXc-Node-1114" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.37em;">∂</span></span></span></span><span id="MJXc-Node-1115" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1116" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.265em;">L</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1117" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.423em; padding-bottom: 0.265em;">i</span></span></span></span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 1.906em; bottom: -0.843em;"><span id="MJXc-Node-1118" class="mjx-mrow" style=""><span id="MJXc-Node-1119" class="mjx-texatom"><span id="MJXc-Node-1120" class="mjx-mrow"><span id="MJXc-Node-1121" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.37em;">∂</span></span></span></span><span id="MJXc-Node-1122" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1123" class="mjx-texatom"><span id="MJXc-Node-1124" class="mjx-mrow"><span id="MJXc-Node-1125" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1126" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.16em; padding-bottom: 0.37em;">s</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1127" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.318em; padding-bottom: 0.37em;">2</span></span></span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.287em; padding-right: 0.071em;"><span id="MJXc-Node-1128" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.423em; padding-bottom: 0.265em;">i</span></span></span></span></span></span><span class="mjx-line" style="border-bottom: 1.3px solid; top: -0.283em; width: 1.348em;"></span></span><span class="mjx-vsize" style="height: 1.655em; vertical-align: -0.596em;"></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mrow><mrow class="MJX-TeXAtom-ORD"><mo>∂</mo></mrow><msub><mi>L</mi><mi>i</mi></msub></mrow><mrow><mrow class="MJX-TeXAtom-ORD"><mo>∂</mo></mrow><msub><mrow class="MJX-TeXAtom-ORD"><msub><mi mathvariant="bold">s</mi><mn mathvariant="bold">2</mn></msub></mrow><mi>i</mi></msub></mrow></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-42"> \frac{∂L_i}{∂\mathbf{s_2}_i} </script>
javlja u sva četiri gradijenta 
po parametrima funkcije gubitka.
Tu specifičnost možemo iskoristiti
kako bismo do željenih gradijenata
došli uz minimalni računski napor.
Parcijalne derivacije funkcije cilja
po čvorovima računskog grafa
nećemo morati računati više od jednom 
ako ih budemo računali <em>unatrag</em>,
od izlaza prema ulazu mreže.
Taj jednostavni ali vrlo efikasni pristup
formalizira algoritam širenja unatrag (engl. backprop).

</p><p>
Postupak širenja pogreške unatrag
prikazali smo na sljedećoj slici.
Crne strelice prikazuju evaluiranje modela
i računanje gubitka u zadanom podatku
(tzv. unaprijedni prolaz, engl. forward pass).
Crvene strelice prikazuju
postupno računanje gradijenata
prema algoritmu širenja unatrag
(tzv. unatražni prolaz, engl. backward pass).

</p><p>
<img src="./lab1_task_croatian_files/backprop3.png" alt="data">

</p><p>
Sad se čini da su nam poznate
sve komponente rješenja našeg problema.
Znamo kako računati gradijente
s obzirom na pojedine parametre,
kao i kojim redoslijedom to obaviti.
Međutim, htjeli bismo prije kraja 
još jednom naglasiti dva netrivijalna detalja.
Prvi detalj je petlja po podatcima.
Ako želimo uživati prednosti optimiranih biblioteka
i izbjeći iteriranje u Pythonu,
onda svaki pojedini gradijent
trebamo odjednom izračunati za sve podatke.
Ako imamo 100000 podataka, prvo ćemo izračunati
100000 redaka matrice
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-43-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;G&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;s&lt;/mi&gt;&lt;mn mathvariant=&quot;bold&quot;&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2202;&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2202;&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;s&lt;/mi&gt;&lt;mn mathvariant=&quot;bold&quot;&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;msubsup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/msubsup&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-1129" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1130" class="mjx-mrow"><span id="MJXc-Node-1131" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1132" class="mjx-texatom"><span id="MJXc-Node-1133" class="mjx-mrow"><span id="MJXc-Node-1134" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.37em; padding-bottom: 0.37em;">G</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1135" class="mjx-texatom" style=""><span id="MJXc-Node-1136" class="mjx-mrow"><span id="MJXc-Node-1137" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1138" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.16em; padding-bottom: 0.37em;">s</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1139" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.318em; padding-bottom: 0.37em;">2</span></span></span></span></span></span></span></span><span id="MJXc-Node-1140" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.055em; padding-bottom: 0.318em;">=</span></span><span id="MJXc-Node-1141" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">[</span></span><span id="MJXc-Node-1142" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">(</span></span><span id="MJXc-Node-1143" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 1.348em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 1.906em; top: -1.497em;"><span id="MJXc-Node-1144" class="mjx-mrow" style=""><span id="MJXc-Node-1145" class="mjx-texatom"><span id="MJXc-Node-1146" class="mjx-mrow"><span id="MJXc-Node-1147" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.37em;">∂</span></span></span></span><span id="MJXc-Node-1148" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1149" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.265em;">L</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1150" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.423em; padding-bottom: 0.265em;">i</span></span></span></span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 1.906em; bottom: -0.843em;"><span id="MJXc-Node-1151" class="mjx-mrow" style=""><span id="MJXc-Node-1152" class="mjx-texatom"><span id="MJXc-Node-1153" class="mjx-mrow"><span id="MJXc-Node-1154" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.37em;">∂</span></span></span></span><span id="MJXc-Node-1155" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1156" class="mjx-texatom"><span id="MJXc-Node-1157" class="mjx-mrow"><span id="MJXc-Node-1158" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1159" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.16em; padding-bottom: 0.37em;">s</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1160" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.318em; padding-bottom: 0.37em;">2</span></span></span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.287em; padding-right: 0.071em;"><span id="MJXc-Node-1161" class="mjx-texatom" style=""><span id="MJXc-Node-1162" class="mjx-mrow"><span id="MJXc-Node-1163" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.423em; padding-bottom: 0.265em;">i</span></span></span></span></span></span></span></span><span class="mjx-line" style="border-bottom: 1.3px solid; top: -0.283em; width: 1.348em;"></span></span><span class="mjx-vsize" style="height: 1.655em; vertical-align: -0.596em;"></span></span><span id="MJXc-Node-1164" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1165" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">)</span></span></span><span class="mjx-stack" style="vertical-align: -0.315em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1171" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.265em; padding-right: 0.085em;">N</span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-1166" class="mjx-texatom" style=""><span id="MJXc-Node-1167" class="mjx-mrow"><span id="MJXc-Node-1168" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.423em; padding-bottom: 0.265em;">i</span></span><span id="MJXc-Node-1169" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.055em; padding-bottom: 0.318em;">=</span></span><span id="MJXc-Node-1170" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.37em; padding-bottom: 0.318em;">1</span></span></span></span></span></span></span><span id="MJXc-Node-1172" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">]</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">G</mi></mrow><mrow class="MJX-TeXAtom-ORD"><msub><mi mathvariant="bold">s</mi><mn mathvariant="bold">2</mn></msub></mrow></msub><mo>=</mo><mo stretchy="false">[</mo><mo stretchy="false">(</mo><mfrac><mrow><mrow class="MJX-TeXAtom-ORD"><mo>∂</mo></mrow><msub><mi>L</mi><mi>i</mi></msub></mrow><mrow><mrow class="MJX-TeXAtom-ORD"><mo>∂</mo></mrow><msub><mrow class="MJX-TeXAtom-ORD"><msub><mi mathvariant="bold">s</mi><mn mathvariant="bold">2</mn></msub></mrow><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub></mrow></mfrac><msubsup><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-43">
        \mathbf{G}_\mathbf{s_2} =
        [
          (\frac{∂L_i}{∂\mathbf{s_2}_{i}})_{i=1}^N
        ]
</script>,
zatim 100000 redaka matrice
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-44-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;G&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;h&lt;/mi&gt;&lt;mn mathvariant=&quot;bold&quot;&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2202;&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2202;&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;h&lt;/mi&gt;&lt;mn mathvariant=&quot;bold&quot;&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;msubsup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/msubsup&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-1173" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1174" class="mjx-mrow"><span id="MJXc-Node-1175" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1176" class="mjx-texatom"><span id="MJXc-Node-1177" class="mjx-mrow"><span id="MJXc-Node-1178" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.37em; padding-bottom: 0.37em;">G</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span id="MJXc-Node-1179" class="mjx-texatom" style=""><span id="MJXc-Node-1180" class="mjx-mrow"><span id="MJXc-Node-1181" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1182" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.37em; padding-bottom: 0.37em;">h</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1183" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.318em; padding-bottom: 0.37em;">1</span></span></span></span></span></span></span></span><span id="MJXc-Node-1184" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.055em; padding-bottom: 0.318em;">=</span></span><span id="MJXc-Node-1185" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">[</span></span><span id="MJXc-Node-1186" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">(</span></span><span id="MJXc-Node-1187" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 1.479em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 2.091em; top: -1.497em;"><span id="MJXc-Node-1188" class="mjx-mrow" style=""><span id="MJXc-Node-1189" class="mjx-texatom"><span id="MJXc-Node-1190" class="mjx-mrow"><span id="MJXc-Node-1191" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.37em;">∂</span></span></span></span><span id="MJXc-Node-1192" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1193" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.265em;">L</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1194" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.423em; padding-bottom: 0.265em;">i</span></span></span></span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 2.091em; bottom: -0.843em;"><span id="MJXc-Node-1195" class="mjx-mrow" style=""><span id="MJXc-Node-1196" class="mjx-texatom"><span id="MJXc-Node-1197" class="mjx-mrow"><span id="MJXc-Node-1198" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.37em;">∂</span></span></span></span><span id="MJXc-Node-1199" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1200" class="mjx-texatom"><span id="MJXc-Node-1201" class="mjx-mrow"><span id="MJXc-Node-1202" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1203" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.37em; padding-bottom: 0.37em;">h</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1204" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.318em; padding-bottom: 0.37em;">1</span></span></span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.287em; padding-right: 0.071em;"><span id="MJXc-Node-1205" class="mjx-texatom" style=""><span id="MJXc-Node-1206" class="mjx-mrow"><span id="MJXc-Node-1207" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.423em; padding-bottom: 0.265em;">i</span></span></span></span></span></span></span></span><span class="mjx-line" style="border-bottom: 1.3px solid; top: -0.283em; width: 1.479em;"></span></span><span class="mjx-vsize" style="height: 1.655em; vertical-align: -0.596em;"></span></span><span id="MJXc-Node-1208" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1209" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">)</span></span></span><span class="mjx-stack" style="vertical-align: -0.315em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1215" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.265em; padding-right: 0.085em;">N</span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-1210" class="mjx-texatom" style=""><span id="MJXc-Node-1211" class="mjx-mrow"><span id="MJXc-Node-1212" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.423em; padding-bottom: 0.265em;">i</span></span><span id="MJXc-Node-1213" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.055em; padding-bottom: 0.318em;">=</span></span><span id="MJXc-Node-1214" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.37em; padding-bottom: 0.318em;">1</span></span></span></span></span></span></span><span id="MJXc-Node-1216" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">]</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">G</mi></mrow><mrow class="MJX-TeXAtom-ORD"><msub><mi mathvariant="bold">h</mi><mn mathvariant="bold">1</mn></msub></mrow></msub><mo>=</mo><mo stretchy="false">[</mo><mo stretchy="false">(</mo><mfrac><mrow><mrow class="MJX-TeXAtom-ORD"><mo>∂</mo></mrow><msub><mi>L</mi><mi>i</mi></msub></mrow><mrow><mrow class="MJX-TeXAtom-ORD"><mo>∂</mo></mrow><msub><mrow class="MJX-TeXAtom-ORD"><msub><mi mathvariant="bold">h</mi><mn mathvariant="bold">1</mn></msub></mrow><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub></mrow></mfrac><msubsup><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-44">
        \mathbf{G}_\mathbf{h_1} =
        [
          (\frac{∂L_i}{∂\mathbf{h_1}_{i}})_{i=1}^N
        ]
</script>,
itd.
Ovakav pristup je vrlo neobičan za inženjere
koji su navikli sve pisati u vlastitom aranžmanu,
jer strahovito povećava memorijske zahtjeve postupka.
Međutim, tu cijenu moramo platiti,
jer u suprotnom naš algoritam ne bismo mogli izraziti
optimiranim lego-kockicama za matrične operacije
pa bi nam učenje bilo sporije za nekoliko redova veličine.

</p><p>
Drugi detalj je računanje gradijenata težina.
Ovdje vam preporučamo da umjesto odvojenog računanja
gradijenata po retcima težina
(kao što sugeriraju gore navedene jednadžbe)
koristite pristup kojeg smo u nultoj vježbi
pokazali na logističkoj regresiji
(isp. odjeljak 0d uvodne vježbe).
Naime, nije previše teško pokazati
da se kompletna matrica gradijenata
(koja se u iteraciji gradijentnog spusta
naprosto dodaje matrici težina)
može izraziti jednostavnim matričnim umnoškom.
Gradijente težina u k-tom sloju 
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-45-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;g&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;r&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;a&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;d&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;W&lt;/mi&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-1217" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1218" class="mjx-mrow"><span id="MJXc-Node-1219" class="mjx-texatom"><span id="MJXc-Node-1220" class="mjx-mrow"><span id="MJXc-Node-1221" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.16em; padding-bottom: 0.528em;">g</span></span><span id="MJXc-Node-1222" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.16em; padding-bottom: 0.318em;">r</span></span><span id="MJXc-Node-1223" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.16em; padding-bottom: 0.37em;">a</span></span><span id="MJXc-Node-1224" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.37em;">d</span></span></span></span><span id="MJXc-Node-1225" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">(</span></span><span id="MJXc-Node-1226" class="mjx-texatom"><span id="MJXc-Node-1227" class="mjx-mrow"><span id="MJXc-Node-1228" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1229" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.37em; padding-bottom: 0.37em;">W</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span id="MJXc-Node-1230" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.37em; padding-bottom: 0.37em;">k</span></span></span></span></span></span><span id="MJXc-Node-1231" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">g</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">d</mi></mrow><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><msub><mi mathvariant="bold">W</mi><mi mathvariant="bold">k</mi></msub></mrow><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-45">\mathrm{grad}(\mathbf{W_k}) </script>
dobivamo množenjem transponirane matrice gradijenata gubitka
po linearnoj mjeri k-tog sloja u svim podatcima 
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-46-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;G&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;s&lt;/mi&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-1232" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1233" class="mjx-mrow"><span id="MJXc-Node-1234" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1235" class="mjx-texatom"><span id="MJXc-Node-1236" class="mjx-mrow"><span id="MJXc-Node-1237" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.37em; padding-bottom: 0.37em;">G</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1238" class="mjx-texatom" style=""><span id="MJXc-Node-1239" class="mjx-mrow"><span id="MJXc-Node-1240" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1241" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.16em; padding-bottom: 0.37em;">s</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span id="MJXc-Node-1242" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.37em; padding-bottom: 0.37em;">k</span></span></span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">G</mi></mrow><mrow class="MJX-TeXAtom-ORD"><msub><mi mathvariant="bold">s</mi><mi mathvariant="bold">k</mi></msub></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-46">\mathbf{G}_\mathbf{s_k}</script>
s matricom svih ulaza u k-ti sloj
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-47-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;H&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-1243" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1244" class="mjx-mrow"><span id="MJXc-Node-1245" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1246" class="mjx-texatom"><span id="MJXc-Node-1247" class="mjx-mrow"><span id="MJXc-Node-1248" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.37em; padding-bottom: 0.37em;">H</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span id="MJXc-Node-1249" class="mjx-texatom" style=""><span id="MJXc-Node-1250" class="mjx-mrow"><span id="MJXc-Node-1251" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.265em;">k</span></span><span id="MJXc-Node-1252" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.318em; padding-bottom: 0.423em;">−</span></span><span id="MJXc-Node-1253" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.37em; padding-bottom: 0.318em;">1</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">H</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-47">\mathbf{H}_{k-1}</script>.
<!--
\(
  \mathrm{grad}(\mathbf{W_k}) =
    \mathbf{G}_\mathbf{s_k}^\top 
    \cdot
    \mathbf{H}_{k-1} \; .
\) 
-->
Na sličan način računamo i sve gradijente
po komponentama pomaka k-tog sloja.
Ovdje nam umjesto matričnog množenja
treba zbrajanje stupaca matrice <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-48-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;G&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;s&lt;/mi&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-1254" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1255" class="mjx-mrow"><span id="MJXc-Node-1256" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1257" class="mjx-texatom"><span id="MJXc-Node-1258" class="mjx-mrow"><span id="MJXc-Node-1259" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.37em; padding-bottom: 0.37em;">G</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1260" class="mjx-texatom" style=""><span id="MJXc-Node-1261" class="mjx-mrow"><span id="MJXc-Node-1262" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1263" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.16em; padding-bottom: 0.37em;">s</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span id="MJXc-Node-1264" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.37em; padding-bottom: 0.37em;">k</span></span></span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">G</mi></mrow><mrow class="MJX-TeXAtom-ORD"><msub><mi mathvariant="bold">s</mi><mi mathvariant="bold">k</mi></msub></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-48">\mathbf{G}_\mathbf{s_k}</script>,
a za to možemo koristiti funkciju <code>np.sum</code>.

</p><p>
U konkretnom primjeru naše dvoslojne mreže,
imali bismo sljedeći redoslijed računanja
parcijalnih derivacija funkcije gubitka:

</p><ol>
  <li>
  gradijenti gubitka obzirom na 
  linearnu mjeru drugog sloja
  u svim podatcima:
  <ul style="list-style-type:none">
    <li>
      <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-49-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;G&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;s&lt;/mi&gt;&lt;mn mathvariant=&quot;bold&quot;&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2202;&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2202;&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;s&lt;/mi&gt;&lt;mn mathvariant=&quot;bold&quot;&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;msubsup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/msubsup&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-1265" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1266" class="mjx-mrow"><span id="MJXc-Node-1267" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1268" class="mjx-texatom"><span id="MJXc-Node-1269" class="mjx-mrow"><span id="MJXc-Node-1270" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.37em; padding-bottom: 0.37em;">G</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1271" class="mjx-texatom" style=""><span id="MJXc-Node-1272" class="mjx-mrow"><span id="MJXc-Node-1273" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1274" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.16em; padding-bottom: 0.37em;">s</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1275" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.318em; padding-bottom: 0.37em;">2</span></span></span></span></span></span></span></span><span id="MJXc-Node-1276" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.055em; padding-bottom: 0.318em;">=</span></span><span id="MJXc-Node-1277" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">[</span></span><span id="MJXc-Node-1278" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">(</span></span><span id="MJXc-Node-1279" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 1.348em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 1.906em; top: -1.497em;"><span id="MJXc-Node-1280" class="mjx-mrow" style=""><span id="MJXc-Node-1281" class="mjx-texatom"><span id="MJXc-Node-1282" class="mjx-mrow"><span id="MJXc-Node-1283" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.37em;">∂</span></span></span></span><span id="MJXc-Node-1284" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1285" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.265em;">L</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1286" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.423em; padding-bottom: 0.265em;">i</span></span></span></span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 1.906em; bottom: -0.843em;"><span id="MJXc-Node-1287" class="mjx-mrow" style=""><span id="MJXc-Node-1288" class="mjx-texatom"><span id="MJXc-Node-1289" class="mjx-mrow"><span id="MJXc-Node-1290" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.37em;">∂</span></span></span></span><span id="MJXc-Node-1291" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1292" class="mjx-texatom"><span id="MJXc-Node-1293" class="mjx-mrow"><span id="MJXc-Node-1294" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1295" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.16em; padding-bottom: 0.37em;">s</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1296" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.318em; padding-bottom: 0.37em;">2</span></span></span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.287em; padding-right: 0.071em;"><span id="MJXc-Node-1297" class="mjx-texatom" style=""><span id="MJXc-Node-1298" class="mjx-mrow"><span id="MJXc-Node-1299" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.423em; padding-bottom: 0.265em;">i</span></span></span></span></span></span></span></span><span class="mjx-line" style="border-bottom: 1.3px solid; top: -0.283em; width: 1.348em;"></span></span><span class="mjx-vsize" style="height: 1.655em; vertical-align: -0.596em;"></span></span><span id="MJXc-Node-1300" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1301" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">)</span></span></span><span class="mjx-stack" style="vertical-align: -0.315em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1307" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.265em; padding-right: 0.085em;">N</span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-1302" class="mjx-texatom" style=""><span id="MJXc-Node-1303" class="mjx-mrow"><span id="MJXc-Node-1304" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.423em; padding-bottom: 0.265em;">i</span></span><span id="MJXc-Node-1305" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.055em; padding-bottom: 0.318em;">=</span></span><span id="MJXc-Node-1306" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.37em; padding-bottom: 0.318em;">1</span></span></span></span></span></span></span><span id="MJXc-Node-1308" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">]</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">G</mi></mrow><mrow class="MJX-TeXAtom-ORD"><msub><mi mathvariant="bold">s</mi><mn mathvariant="bold">2</mn></msub></mrow></msub><mo>=</mo><mo stretchy="false">[</mo><mo stretchy="false">(</mo><mfrac><mrow><mrow class="MJX-TeXAtom-ORD"><mo>∂</mo></mrow><msub><mi>L</mi><mi>i</mi></msub></mrow><mrow><mrow class="MJX-TeXAtom-ORD"><mo>∂</mo></mrow><msub><mrow class="MJX-TeXAtom-ORD"><msub><mi mathvariant="bold">s</mi><mn mathvariant="bold">2</mn></msub></mrow><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub></mrow></mfrac><msubsup><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-49">
        \mathbf{G}_\mathbf{s_2} =
        [
          (\frac{∂L_i}{∂\mathbf{s_2}_{i}})_{i=1}^N
        ]
      </script>
    (matrica dimenzija NxC);
  </li></ul>
  </li><li>
  gradijenti gubitka obzirom
  na parametre drugog sloja 
  <ul>
    <li> 
      grad(<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-50-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;W&lt;/mi&gt;&lt;mn mathvariant=&quot;bold&quot;&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-1309" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1310" class="mjx-mrow"><span id="MJXc-Node-1311" class="mjx-texatom"><span id="MJXc-Node-1312" class="mjx-mrow"><span id="MJXc-Node-1313" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1314" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.37em; padding-bottom: 0.37em;">W</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1315" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.318em; padding-bottom: 0.37em;">2</span></span></span></span></span></span><span id="MJXc-Node-1316" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><msub><mi mathvariant="bold">W</mi><mn mathvariant="bold">2</mn></msub></mrow><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-50">\mathbf{W_2})</script>
        <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-51-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2202;&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2202;&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;W&lt;/mi&gt;&lt;mn mathvariant=&quot;bold&quot;&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;:&lt;/mo&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x22A4;&lt;/mi&gt;&lt;/msup&gt;&lt;msubsup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;/msubsup&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x22A4;&lt;/mi&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msubsup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;G&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;s&lt;/mi&gt;&lt;mn mathvariant=&quot;bold&quot;&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x22A4;&lt;/mi&gt;&lt;/msubsup&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;H&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-1317" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1318" class="mjx-mrow"><span id="MJXc-Node-1319" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.055em; padding-bottom: 0.318em;">=</span></span><span id="MJXc-Node-1320" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">[</span></span><span id="MJXc-Node-1321" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">(</span></span><span id="MJXc-Node-1322" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1323" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 2.04em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 2.885em; top: -1.369em;"><span id="MJXc-Node-1324" class="mjx-mrow" style=""><span id="MJXc-Node-1325" class="mjx-texatom"><span id="MJXc-Node-1326" class="mjx-mrow"><span id="MJXc-Node-1327" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.37em;">∂</span></span></span></span><span id="MJXc-Node-1328" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.265em;">L</span></span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 2.885em; bottom: -0.98em;"><span id="MJXc-Node-1329" class="mjx-mrow" style=""><span id="MJXc-Node-1330" class="mjx-texatom"><span id="MJXc-Node-1331" class="mjx-mrow"><span id="MJXc-Node-1332" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.37em;">∂</span></span></span></span><span id="MJXc-Node-1333" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1334" class="mjx-texatom"><span id="MJXc-Node-1335" class="mjx-mrow"><span id="MJXc-Node-1336" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1337" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.37em; padding-bottom: 0.37em;">W</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1338" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.318em; padding-bottom: 0.37em;">2</span></span></span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.287em; padding-right: 0.071em;"><span id="MJXc-Node-1339" class="mjx-texatom" style=""><span id="MJXc-Node-1340" class="mjx-mrow"><span id="MJXc-Node-1341" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.423em; padding-bottom: 0.475em;">j</span></span><span id="MJXc-Node-1342" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.16em; padding-bottom: 0.318em;">:</span></span></span></span></span></span></span></span><span class="mjx-line" style="border-bottom: 1.3px solid; top: -0.283em; width: 2.04em;"></span></span><span class="mjx-vsize" style="height: 1.66em; vertical-align: -0.693em;"></span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.983em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1343" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.37em; padding-bottom: 0.318em;">⊤</span></span></span></span><span id="MJXc-Node-1344" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1345" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">)</span></span></span><span class="mjx-stack" style="vertical-align: -0.315em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1351" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.318em; padding-right: 0.045em;">C</span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-1346" class="mjx-texatom" style=""><span id="MJXc-Node-1347" class="mjx-mrow"><span id="MJXc-Node-1348" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.423em; padding-bottom: 0.475em;">j</span></span><span id="MJXc-Node-1349" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.055em; padding-bottom: 0.318em;">=</span></span><span id="MJXc-Node-1350" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.37em; padding-bottom: 0.318em;">1</span></span></span></span></span></span></span><span id="MJXc-Node-1352" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1353" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">]</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1354" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.37em; padding-bottom: 0.318em;">⊤</span></span></span></span><span id="MJXc-Node-1355" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.055em; padding-bottom: 0.318em;">=</span></span><span id="MJXc-Node-1356" class="mjx-msubsup MJXc-space3"><span class="mjx-base"><span id="MJXc-Node-1357" class="mjx-texatom"><span id="MJXc-Node-1358" class="mjx-mrow"><span id="MJXc-Node-1359" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.37em; padding-bottom: 0.37em;">G</span></span></span></span></span><span class="mjx-stack" style="vertical-align: -0.247em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.482em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1365" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.37em; padding-bottom: 0.318em;">⊤</span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-1360" class="mjx-texatom" style=""><span id="MJXc-Node-1361" class="mjx-mrow"><span id="MJXc-Node-1362" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1363" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.16em; padding-bottom: 0.37em;">s</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1364" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.318em; padding-bottom: 0.37em;">2</span></span></span></span></span></span></span></span></span><span id="MJXc-Node-1366" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.003em; padding-bottom: 0.318em;">⋅</span></span><span id="MJXc-Node-1367" class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span id="MJXc-Node-1368" class="mjx-texatom"><span id="MJXc-Node-1369" class="mjx-mrow"><span id="MJXc-Node-1370" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.37em; padding-bottom: 0.37em;">H</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1371" class="mjx-texatom" style=""><span id="MJXc-Node-1372" class="mjx-mrow"><span id="MJXc-Node-1373" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.37em; padding-bottom: 0.318em;">1</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>=</mo><mo stretchy="false">[</mo><mo stretchy="false">(</mo><msup><mfrac><mrow><mrow class="MJX-TeXAtom-ORD"><mo>∂</mo></mrow><mi>L</mi></mrow><mrow><mrow class="MJX-TeXAtom-ORD"><mo>∂</mo></mrow><msub><mrow class="MJX-TeXAtom-ORD"><msub><mi mathvariant="bold">W</mi><mn mathvariant="bold">2</mn></msub></mrow><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>:</mo></mrow></msub></mrow></mfrac><mi mathvariant="normal">⊤</mi></msup><msubsup><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>C</mi></msubsup><msup><mo stretchy="false">]</mo><mi mathvariant="normal">⊤</mi></msup><mo>=</mo><msubsup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">G</mi></mrow><mrow class="MJX-TeXAtom-ORD"><msub><mi mathvariant="bold">s</mi><mn mathvariant="bold">2</mn></msub></mrow><mi mathvariant="normal">⊤</mi></msubsup><mo>⋅</mo><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">H</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-51">
        =[ (\frac{∂L}{∂\mathbf{W_2}_{j:}}^\top)_{j=1}^C ]^\top
        =\mathbf{G}_\mathbf{s_2}^\top
         \cdot
         \mathbf{H}_{1}
        </script>
        (matrica dimenzija CxH),
    </li><li> 
       grad(<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-52-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;b&lt;/mi&gt;&lt;mn mathvariant=&quot;bold&quot;&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-1374" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1375" class="mjx-mrow"><span id="MJXc-Node-1376" class="mjx-texatom"><span id="MJXc-Node-1377" class="mjx-mrow"><span id="MJXc-Node-1378" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1379" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.37em; padding-bottom: 0.37em;">b</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1380" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.318em; padding-bottom: 0.37em;">2</span></span></span></span></span></span><span id="MJXc-Node-1381" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><msub><mi mathvariant="bold">b</mi><mn mathvariant="bold">2</mn></msub></mrow><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-52">\mathbf{b_2})</script> =
         <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-53-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2202;&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2202;&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;msubsup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;/msubsup&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x22A4;&lt;/mi&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-1382" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1383" class="mjx-mrow"><span id="MJXc-Node-1384" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">[</span></span><span id="MJXc-Node-1385" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">(</span></span><span id="MJXc-Node-1386" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 1.326em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 1.876em; top: -1.369em;"><span id="MJXc-Node-1387" class="mjx-mrow" style=""><span id="MJXc-Node-1388" class="mjx-texatom"><span id="MJXc-Node-1389" class="mjx-mrow"><span id="MJXc-Node-1390" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.37em;">∂</span></span></span></span><span id="MJXc-Node-1391" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.265em;">L</span></span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 1.876em; bottom: -0.98em;"><span id="MJXc-Node-1392" class="mjx-mrow" style=""><span id="MJXc-Node-1393" class="mjx-texatom"><span id="MJXc-Node-1394" class="mjx-mrow"><span id="MJXc-Node-1395" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.37em;">∂</span></span></span></span><span id="MJXc-Node-1396" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1397" class="mjx-texatom"><span id="MJXc-Node-1398" class="mjx-mrow"><span id="MJXc-Node-1399" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1400" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.265em;">b</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1401" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.37em; padding-bottom: 0.318em;">2</span></span></span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.287em; padding-right: 0.071em;"><span id="MJXc-Node-1402" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.423em; padding-bottom: 0.475em;">j</span></span></span></span></span></span><span class="mjx-line" style="border-bottom: 1.3px solid; top: -0.283em; width: 1.326em;"></span></span><span class="mjx-vsize" style="height: 1.66em; vertical-align: -0.693em;"></span></span><span id="MJXc-Node-1403" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1404" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">)</span></span></span><span class="mjx-stack" style="vertical-align: -0.315em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1410" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.318em; padding-right: 0.045em;">C</span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-1405" class="mjx-texatom" style=""><span id="MJXc-Node-1406" class="mjx-mrow"><span id="MJXc-Node-1407" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.423em; padding-bottom: 0.475em;">j</span></span><span id="MJXc-Node-1408" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.055em; padding-bottom: 0.318em;">=</span></span><span id="MJXc-Node-1409" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.37em; padding-bottom: 0.318em;">1</span></span></span></span></span></span></span><span id="MJXc-Node-1411" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1412" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">]</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1413" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.37em; padding-bottom: 0.318em;">⊤</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mo stretchy="false">(</mo><mfrac><mrow><mrow class="MJX-TeXAtom-ORD"><mo>∂</mo></mrow><mi>L</mi></mrow><mrow><mrow class="MJX-TeXAtom-ORD"><mo>∂</mo></mrow><msub><mrow class="MJX-TeXAtom-ORD"><msub><mi>b</mi><mn>2</mn></msub></mrow><mi>j</mi></msub></mrow></mfrac><msubsup><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>C</mi></msubsup><msup><mo stretchy="false">]</mo><mi mathvariant="normal">⊤</mi></msup></math></span></span><script type="math/tex" id="MathJax-Element-53">[ (\frac{∂L}{∂{b_2}_j})_{j=1}^C ]^\top </script>
         (matrica dimenzija Cx1);
  </li></ul>
  </li><li>
  gradijenti gubitka obzirom na 
  nelinearni izlaz prvog sloja
  u svim podatcima:
  <ul style="list-style-type:none">
    <li> 
      <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-54-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;G&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;h&lt;/mi&gt;&lt;mn mathvariant=&quot;bold&quot;&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2202;&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2202;&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;h&lt;/mi&gt;&lt;mn mathvariant=&quot;bold&quot;&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;msubsup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/msubsup&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-1414" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1415" class="mjx-mrow"><span id="MJXc-Node-1416" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1417" class="mjx-texatom"><span id="MJXc-Node-1418" class="mjx-mrow"><span id="MJXc-Node-1419" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.37em; padding-bottom: 0.37em;">G</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;"><span id="MJXc-Node-1420" class="mjx-texatom" style=""><span id="MJXc-Node-1421" class="mjx-mrow"><span id="MJXc-Node-1422" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1423" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.37em; padding-bottom: 0.37em;">h</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1424" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.318em; padding-bottom: 0.37em;">1</span></span></span></span></span></span></span></span><span id="MJXc-Node-1425" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.055em; padding-bottom: 0.318em;">=</span></span><span id="MJXc-Node-1426" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">[</span></span><span id="MJXc-Node-1427" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">(</span></span><span id="MJXc-Node-1428" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 1.479em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 2.091em; top: -1.497em;"><span id="MJXc-Node-1429" class="mjx-mrow" style=""><span id="MJXc-Node-1430" class="mjx-texatom"><span id="MJXc-Node-1431" class="mjx-mrow"><span id="MJXc-Node-1432" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.37em;">∂</span></span></span></span><span id="MJXc-Node-1433" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1434" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.265em;">L</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1435" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.423em; padding-bottom: 0.265em;">i</span></span></span></span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 2.091em; bottom: -0.843em;"><span id="MJXc-Node-1436" class="mjx-mrow" style=""><span id="MJXc-Node-1437" class="mjx-texatom"><span id="MJXc-Node-1438" class="mjx-mrow"><span id="MJXc-Node-1439" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.37em;">∂</span></span></span></span><span id="MJXc-Node-1440" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1441" class="mjx-texatom"><span id="MJXc-Node-1442" class="mjx-mrow"><span id="MJXc-Node-1443" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1444" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.37em; padding-bottom: 0.37em;">h</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1445" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.318em; padding-bottom: 0.37em;">1</span></span></span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.287em; padding-right: 0.071em;"><span id="MJXc-Node-1446" class="mjx-texatom" style=""><span id="MJXc-Node-1447" class="mjx-mrow"><span id="MJXc-Node-1448" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.423em; padding-bottom: 0.265em;">i</span></span></span></span></span></span></span></span><span class="mjx-line" style="border-bottom: 1.3px solid; top: -0.283em; width: 1.479em;"></span></span><span class="mjx-vsize" style="height: 1.655em; vertical-align: -0.596em;"></span></span><span id="MJXc-Node-1449" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1450" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">)</span></span></span><span class="mjx-stack" style="vertical-align: -0.315em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1456" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.265em; padding-right: 0.085em;">N</span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-1451" class="mjx-texatom" style=""><span id="MJXc-Node-1452" class="mjx-mrow"><span id="MJXc-Node-1453" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.423em; padding-bottom: 0.265em;">i</span></span><span id="MJXc-Node-1454" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.055em; padding-bottom: 0.318em;">=</span></span><span id="MJXc-Node-1455" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.37em; padding-bottom: 0.318em;">1</span></span></span></span></span></span></span><span id="MJXc-Node-1457" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">]</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">G</mi></mrow><mrow class="MJX-TeXAtom-ORD"><msub><mi mathvariant="bold">h</mi><mn mathvariant="bold">1</mn></msub></mrow></msub><mo>=</mo><mo stretchy="false">[</mo><mo stretchy="false">(</mo><mfrac><mrow><mrow class="MJX-TeXAtom-ORD"><mo>∂</mo></mrow><msub><mi>L</mi><mi>i</mi></msub></mrow><mrow><mrow class="MJX-TeXAtom-ORD"><mo>∂</mo></mrow><msub><mrow class="MJX-TeXAtom-ORD"><msub><mi mathvariant="bold">h</mi><mn mathvariant="bold">1</mn></msub></mrow><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub></mrow></mfrac><msubsup><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-54">
        \mathbf{G}_\mathbf{h_1} =
        [
          (\frac{∂L_i}{∂\mathbf{h_1}_{i}})_{i=1}^N
        ]
      </script>
      (matrica dimenzija NxH);
  </li></ul>
  </li><li>
  gradijent gubitka obzirom na 
  linearnu mjeru prvog sloja
  u svim podatcima:
  <ul style="list-style-type:none">
    <li> 
      <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-55-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;G&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;s&lt;/mi&gt;&lt;mn mathvariant=&quot;bold&quot;&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2202;&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2202;&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;s&lt;/mi&gt;&lt;mn mathvariant=&quot;bold&quot;&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;msubsup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/msubsup&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-1458" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1459" class="mjx-mrow"><span id="MJXc-Node-1460" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1461" class="mjx-texatom"><span id="MJXc-Node-1462" class="mjx-mrow"><span id="MJXc-Node-1463" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.37em; padding-bottom: 0.37em;">G</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1464" class="mjx-texatom" style=""><span id="MJXc-Node-1465" class="mjx-mrow"><span id="MJXc-Node-1466" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1467" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.16em; padding-bottom: 0.37em;">s</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1468" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.318em; padding-bottom: 0.37em;">1</span></span></span></span></span></span></span></span><span id="MJXc-Node-1469" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.055em; padding-bottom: 0.318em;">=</span></span><span id="MJXc-Node-1470" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">[</span></span><span id="MJXc-Node-1471" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">(</span></span><span id="MJXc-Node-1472" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 1.348em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 1.906em; top: -1.497em;"><span id="MJXc-Node-1473" class="mjx-mrow" style=""><span id="MJXc-Node-1474" class="mjx-texatom"><span id="MJXc-Node-1475" class="mjx-mrow"><span id="MJXc-Node-1476" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.37em;">∂</span></span></span></span><span id="MJXc-Node-1477" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1478" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.265em;">L</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1479" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.423em; padding-bottom: 0.265em;">i</span></span></span></span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 1.906em; bottom: -0.843em;"><span id="MJXc-Node-1480" class="mjx-mrow" style=""><span id="MJXc-Node-1481" class="mjx-texatom"><span id="MJXc-Node-1482" class="mjx-mrow"><span id="MJXc-Node-1483" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.37em;">∂</span></span></span></span><span id="MJXc-Node-1484" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1485" class="mjx-texatom"><span id="MJXc-Node-1486" class="mjx-mrow"><span id="MJXc-Node-1487" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1488" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.16em; padding-bottom: 0.37em;">s</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1489" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.318em; padding-bottom: 0.37em;">1</span></span></span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.287em; padding-right: 0.071em;"><span id="MJXc-Node-1490" class="mjx-texatom" style=""><span id="MJXc-Node-1491" class="mjx-mrow"><span id="MJXc-Node-1492" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.423em; padding-bottom: 0.265em;">i</span></span></span></span></span></span></span></span><span class="mjx-line" style="border-bottom: 1.3px solid; top: -0.283em; width: 1.348em;"></span></span><span class="mjx-vsize" style="height: 1.655em; vertical-align: -0.596em;"></span></span><span id="MJXc-Node-1493" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1494" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">)</span></span></span><span class="mjx-stack" style="vertical-align: -0.315em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1500" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.265em; padding-right: 0.085em;">N</span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-1495" class="mjx-texatom" style=""><span id="MJXc-Node-1496" class="mjx-mrow"><span id="MJXc-Node-1497" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.423em; padding-bottom: 0.265em;">i</span></span><span id="MJXc-Node-1498" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.055em; padding-bottom: 0.318em;">=</span></span><span id="MJXc-Node-1499" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.37em; padding-bottom: 0.318em;">1</span></span></span></span></span></span></span><span id="MJXc-Node-1501" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">]</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">G</mi></mrow><mrow class="MJX-TeXAtom-ORD"><msub><mi mathvariant="bold">s</mi><mn mathvariant="bold">1</mn></msub></mrow></msub><mo>=</mo><mo stretchy="false">[</mo><mo stretchy="false">(</mo><mfrac><mrow><mrow class="MJX-TeXAtom-ORD"><mo>∂</mo></mrow><msub><mi>L</mi><mi>i</mi></msub></mrow><mrow><mrow class="MJX-TeXAtom-ORD"><mo>∂</mo></mrow><msub><mrow class="MJX-TeXAtom-ORD"><msub><mi mathvariant="bold">s</mi><mn mathvariant="bold">1</mn></msub></mrow><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub></mrow></mfrac><msubsup><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-55">
        \mathbf{G}_\mathbf{s_1} =
        [
          (\frac{∂L_i}{∂\mathbf{s_1}_{i}})_{i=1}^N
        ]
      </script>
      (matrica dimenzija NxH);
  </li></ul>
  </li><li>
  gradijenti gubitka obzirom na parametre prvog sloja:
  <ul>
    <li> 
      grad(<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-56-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;W&lt;/mi&gt;&lt;mn mathvariant=&quot;bold&quot;&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-1502" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1503" class="mjx-mrow"><span id="MJXc-Node-1504" class="mjx-texatom"><span id="MJXc-Node-1505" class="mjx-mrow"><span id="MJXc-Node-1506" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1507" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.37em; padding-bottom: 0.37em;">W</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1508" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.318em; padding-bottom: 0.37em;">1</span></span></span></span></span></span><span id="MJXc-Node-1509" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><msub><mi mathvariant="bold">W</mi><mn mathvariant="bold">1</mn></msub></mrow><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-56">\mathbf{W_1})</script> 
        <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-57-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2202;&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2202;&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;W&lt;/mi&gt;&lt;mn mathvariant=&quot;bold&quot;&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;:&lt;/mo&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x22A4;&lt;/mi&gt;&lt;/msup&gt;&lt;msubsup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;H&lt;/mi&gt;&lt;/msubsup&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x22A4;&lt;/mi&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msubsup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;G&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;s&lt;/mi&gt;&lt;mn mathvariant=&quot;bold&quot;&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x22A4;&lt;/mi&gt;&lt;/msubsup&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;X&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-1510" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1511" class="mjx-mrow"><span id="MJXc-Node-1512" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.055em; padding-bottom: 0.318em;">=</span></span><span id="MJXc-Node-1513" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">[</span></span><span id="MJXc-Node-1514" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">(</span></span><span id="MJXc-Node-1515" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1516" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 2.04em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 2.885em; top: -1.369em;"><span id="MJXc-Node-1517" class="mjx-mrow" style=""><span id="MJXc-Node-1518" class="mjx-texatom"><span id="MJXc-Node-1519" class="mjx-mrow"><span id="MJXc-Node-1520" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.37em;">∂</span></span></span></span><span id="MJXc-Node-1521" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.265em;">L</span></span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 2.885em; bottom: -0.98em;"><span id="MJXc-Node-1522" class="mjx-mrow" style=""><span id="MJXc-Node-1523" class="mjx-texatom"><span id="MJXc-Node-1524" class="mjx-mrow"><span id="MJXc-Node-1525" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.37em;">∂</span></span></span></span><span id="MJXc-Node-1526" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1527" class="mjx-texatom"><span id="MJXc-Node-1528" class="mjx-mrow"><span id="MJXc-Node-1529" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1530" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.37em; padding-bottom: 0.37em;">W</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1531" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.318em; padding-bottom: 0.37em;">1</span></span></span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.287em; padding-right: 0.071em;"><span id="MJXc-Node-1532" class="mjx-texatom" style=""><span id="MJXc-Node-1533" class="mjx-mrow"><span id="MJXc-Node-1534" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.423em; padding-bottom: 0.475em;">j</span></span><span id="MJXc-Node-1535" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.16em; padding-bottom: 0.318em;">:</span></span></span></span></span></span></span></span><span class="mjx-line" style="border-bottom: 1.3px solid; top: -0.283em; width: 2.04em;"></span></span><span class="mjx-vsize" style="height: 1.66em; vertical-align: -0.693em;"></span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.983em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1536" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.37em; padding-bottom: 0.318em;">⊤</span></span></span></span><span id="MJXc-Node-1537" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1538" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">)</span></span></span><span class="mjx-stack" style="vertical-align: -0.315em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1544" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.265em; padding-right: 0.057em;">H</span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-1539" class="mjx-texatom" style=""><span id="MJXc-Node-1540" class="mjx-mrow"><span id="MJXc-Node-1541" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.423em; padding-bottom: 0.475em;">j</span></span><span id="MJXc-Node-1542" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.055em; padding-bottom: 0.318em;">=</span></span><span id="MJXc-Node-1543" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.37em; padding-bottom: 0.318em;">1</span></span></span></span></span></span></span><span id="MJXc-Node-1545" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1546" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">]</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1547" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.37em; padding-bottom: 0.318em;">⊤</span></span></span></span><span id="MJXc-Node-1548" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.055em; padding-bottom: 0.318em;">=</span></span><span id="MJXc-Node-1549" class="mjx-msubsup MJXc-space3"><span class="mjx-base"><span id="MJXc-Node-1550" class="mjx-texatom"><span id="MJXc-Node-1551" class="mjx-mrow"><span id="MJXc-Node-1552" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.37em; padding-bottom: 0.37em;">G</span></span></span></span></span><span class="mjx-stack" style="vertical-align: -0.247em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.482em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1558" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.37em; padding-bottom: 0.318em;">⊤</span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-1553" class="mjx-texatom" style=""><span id="MJXc-Node-1554" class="mjx-mrow"><span id="MJXc-Node-1555" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1556" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.16em; padding-bottom: 0.37em;">s</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1557" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.318em; padding-bottom: 0.37em;">1</span></span></span></span></span></span></span></span></span><span id="MJXc-Node-1559" class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.003em; padding-bottom: 0.318em;">⋅</span></span><span id="MJXc-Node-1560" class="mjx-texatom MJXc-space2"><span id="MJXc-Node-1561" class="mjx-mrow"><span id="MJXc-Node-1562" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.37em; padding-bottom: 0.37em;">X</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>=</mo><mo stretchy="false">[</mo><mo stretchy="false">(</mo><msup><mfrac><mrow><mrow class="MJX-TeXAtom-ORD"><mo>∂</mo></mrow><mi>L</mi></mrow><mrow><mrow class="MJX-TeXAtom-ORD"><mo>∂</mo></mrow><msub><mrow class="MJX-TeXAtom-ORD"><msub><mi mathvariant="bold">W</mi><mn mathvariant="bold">1</mn></msub></mrow><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>:</mo></mrow></msub></mrow></mfrac><mi mathvariant="normal">⊤</mi></msup><msubsup><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>H</mi></msubsup><msup><mo stretchy="false">]</mo><mi mathvariant="normal">⊤</mi></msup><mo>=</mo><msubsup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">G</mi></mrow><mrow class="MJX-TeXAtom-ORD"><msub><mi mathvariant="bold">s</mi><mn mathvariant="bold">1</mn></msub></mrow><mi mathvariant="normal">⊤</mi></msubsup><mo>⋅</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">X</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-57">
        =[ (\frac{∂L}{∂\mathbf{W_1}_{j:}}^\top)_{j=1}^H ]^\top 
        =\mathbf{G}_\mathbf{s_1}^\top
         \cdot
         \mathbf{X}
        </script>
        (matrica dimenzija HxD),
    </li><li> 
      grad(<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-58-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;b&lt;/mi&gt;&lt;mn mathvariant=&quot;bold&quot;&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-1563" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1564" class="mjx-mrow"><span id="MJXc-Node-1565" class="mjx-texatom"><span id="MJXc-Node-1566" class="mjx-mrow"><span id="MJXc-Node-1567" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1568" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.37em; padding-bottom: 0.37em;">b</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1569" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.318em; padding-bottom: 0.37em;">1</span></span></span></span></span></span><span id="MJXc-Node-1570" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><msub><mi mathvariant="bold">b</mi><mn mathvariant="bold">1</mn></msub></mrow><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-58">\mathbf{b_1})</script> =
         <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-59-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2202;&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2202;&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;msubsup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;H&lt;/mi&gt;&lt;/msubsup&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x22A4;&lt;/mi&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-1571" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1572" class="mjx-mrow"><span id="MJXc-Node-1573" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">[</span></span><span id="MJXc-Node-1574" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">(</span></span><span id="MJXc-Node-1575" class="mjx-mfrac"><span class="mjx-box MJXc-stacked" style="width: 1.326em; padding: 0px 0.12em;"><span class="mjx-numerator" style="font-size: 70.7%; width: 1.876em; top: -1.369em;"><span id="MJXc-Node-1576" class="mjx-mrow" style=""><span id="MJXc-Node-1577" class="mjx-texatom"><span id="MJXc-Node-1578" class="mjx-mrow"><span id="MJXc-Node-1579" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.37em;">∂</span></span></span></span><span id="MJXc-Node-1580" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.265em;">L</span></span></span></span><span class="mjx-denominator" style="font-size: 70.7%; width: 1.876em; bottom: -0.98em;"><span id="MJXc-Node-1581" class="mjx-mrow" style=""><span id="MJXc-Node-1582" class="mjx-texatom"><span id="MJXc-Node-1583" class="mjx-mrow"><span id="MJXc-Node-1584" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.423em; padding-bottom: 0.37em;">∂</span></span></span></span><span id="MJXc-Node-1585" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1586" class="mjx-texatom"><span id="MJXc-Node-1587" class="mjx-mrow"><span id="MJXc-Node-1588" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1589" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.265em;">b</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-1590" class="mjx-mn" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.37em; padding-bottom: 0.318em;">1</span></span></span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.287em; padding-right: 0.071em;"><span id="MJXc-Node-1591" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.423em; padding-bottom: 0.475em;">j</span></span></span></span></span></span><span class="mjx-line" style="border-bottom: 1.3px solid; top: -0.283em; width: 1.326em;"></span></span><span class="mjx-vsize" style="height: 1.66em; vertical-align: -0.693em;"></span></span><span id="MJXc-Node-1592" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1593" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">)</span></span></span><span class="mjx-stack" style="vertical-align: -0.315em;"><span class="mjx-sup" style="font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1599" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.475em; padding-bottom: 0.265em; padding-right: 0.057em;">H</span></span></span><span class="mjx-sub" style="font-size: 70.7%; padding-right: 0.071em;"><span id="MJXc-Node-1594" class="mjx-texatom" style=""><span id="MJXc-Node-1595" class="mjx-mrow"><span id="MJXc-Node-1596" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.423em; padding-bottom: 0.475em;">j</span></span><span id="MJXc-Node-1597" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.055em; padding-bottom: 0.318em;">=</span></span><span id="MJXc-Node-1598" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.37em; padding-bottom: 0.318em;">1</span></span></span></span></span></span></span><span id="MJXc-Node-1600" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-1601" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.475em; padding-bottom: 0.58em;">]</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1602" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.37em; padding-bottom: 0.318em;">⊤</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mo stretchy="false">(</mo><mfrac><mrow><mrow class="MJX-TeXAtom-ORD"><mo>∂</mo></mrow><mi>L</mi></mrow><mrow><mrow class="MJX-TeXAtom-ORD"><mo>∂</mo></mrow><msub><mrow class="MJX-TeXAtom-ORD"><msub><mi>b</mi><mn>1</mn></msub></mrow><mi>j</mi></msub></mrow></mfrac><msubsup><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>H</mi></msubsup><msup><mo stretchy="false">]</mo><mi mathvariant="normal">⊤</mi></msup></math></span></span><script type="math/tex" id="MathJax-Element-59">[ (\frac{∂L}{∂{b_1}_j})_{j=1}^H ]^\top </script>
         (matrica dimenzija Hx1).
  </li></ul>
</li></ol>

<h5>Izbjeljivanje podataka i inicijalizacija parametara</h5>

<p>
Kod modela učenih s gradijentnim spustom
početna inicijalizacija parametara
predstavlja jako važnu odluku.
Kod latentnih slojeva aktiviranih zglobnicom,
aktivacije moraju biti centrirane oko nule
tako da zglobnica dođe do izražaja.
Primjerice, kad bi svi ulazi bili pozitivni
i kad bi sve težine bile pozitivne,
sve zglobnice bi bile propusne
i učinak sloja bio bi u potpunosti linearan.
To ne može biti dobro
jer je kombinacija linearnih transformacija
ponovo linearna transformacija,
a znamo da linearne transformacije imaju
puno manji kapacitet od
duboke kompozicije nelinearnih transformacija.
Pouka ove rasprave jest da će učenje dubokog modela
dobro napredovati ako:
</p><ul>
<li>
  inicijaliziramo težine prema distribuciji
  koja je centrirana u nuli
  (npr. np.random.randn),
</li><li>
  izbijelimo podatke tako da im oduzmemo srednju vrijednost
  i podijelimo ih sa standardnom devijacijom.
</li></ul>


<h4 id="z0b">0b. Uvodne napomene o PyTorchu</h4>

<p>
PyTorch je biblioteka otvorenog koda 
za oblikovanje metoda strojnog učenja
s naglaskom na sljedeće ključne mogućnosti:
</p><ul>
<li>
  automatsko diferenciranje
</li><li>
  izvršavanje na raspodijeljenim i GPU arhitekturama
</li><li>
  bogato klijentsko sučelje prema Pythonu
</li></ul>

<p>
Iako postoje i drugi slični alati (TensorFlow, MXNet, ...), 
PyTorch je trenutno najpopularniji među istraživačima,
pogodan je i za početnike zbog čiste organizacije
i dobre dokumentacije.

</p><p>
PyTorch podržava različite operacijske sustave.
Za strojno učenje općenito najviše podrške ima i najažurniji je Linux.
Najsvježije informacije o PyTorchu možete naći na
<a href="https://www.pytorch.org/">službenim stranicama</a>.


<!-- TODO: statički i dinamički računski grafovi -->

</p><p>
Ilustrirajmo zadavanje programa
u PyTorchu na jednostavnom primjeru:
</p><pre><code class="python hljs"><span class="hljs-keyword">import</span> torch
<span class="hljs-comment"># definiranje operacije</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">f</span><span class="hljs-params">(x, a, b)</span>:</span>   
    <span class="hljs-keyword">return</span> a * x + b

<span class="hljs-comment"># definiranje varijabli i izgradnja dinamičnog </span>
<span class="hljs-comment"># računskog grafa s unaprijednim prolazom</span>
a = torch.tensor(<span class="hljs-number">5.</span>, requires_grad=<span class="hljs-keyword">True</span>)
b = torch.tensor(<span class="hljs-number">8.</span>, requires_grad=<span class="hljs-keyword">True</span>)
x = torch.tensor(<span class="hljs-number">2.</span>)
y = f(x, a, b)
s = a ** <span class="hljs-number">2</span>

<span class="hljs-comment"># unatražni prolaz koji računa gradijent </span>
<span class="hljs-comment"># po svim tenzorima zadanim s requires_grad=True</span>
y.backward()
s.backward()               <span class="hljs-comment"># gradijent se akumulira</span>
<span class="hljs-keyword">assert</span> x.grad <span class="hljs-keyword">is</span> <span class="hljs-keyword">None</span>      <span class="hljs-comment"># pytorch ne računa gradijente po x</span>
<span class="hljs-keyword">assert</span> a.grad == x + <span class="hljs-number">2</span> * a <span class="hljs-comment"># dy/da + ds/da</span>
<span class="hljs-keyword">assert</span> b.grad == <span class="hljs-number">1</span>         <span class="hljs-comment"># dy/db + ds/db</span>

<span class="hljs-comment"># ispis rezultata</span>
print(f<span class="hljs-string">"y={y}, g_a={a.grad}, g_b={b.grad}"</span>)
</code></pre>

<p>
Prvi dio prikazanog primjera 
definira običnu funkciju u Pythonu.
Povratna vrijednost te funkcije 
transparentno će se uklopiti 
u računski graf PyTorcha.

</p><p>
Drugi dio primjera stvara objekte 
<code>a</code>, <code>b</code> i <code>x</code> tipa <code>torch.Tensor</code>
koij će odgovarati listovima računskog grafa. 
Tenzori <code>a</code> i <code>b</code> 
imaju atribut <code>requires_grad=True</code>,
što znači da če za njih PyTorch 
pri automatskom unatražnom prolazu izračunati gradijent.
Pozivanje operacija <code>*</code>, <code>+</code> i <code>**</code>
stvara nove objekta tipa <code>torch.Tensor</code>
koji su također čvorovi računskog grafa. 
Dalje ćemo objekte tipa <code>torch.Tensor</code> nazivati tenzorima.
PyTorch pri izračunavanju vrijednosti čvorova računskog grafa 
pamti sve međurezultate koji su potrebni za računanje gradijenta.
Detalje određuje algoritam za automatsku diferencijaciju
kojeg možemo skraćeno zvati 
<a href="https://pytorch.org/tutorials/beginner/blitz/autograd_tutorial.html">autograd</a>. 

</p><p>
Treći dio primjera računa gradijente
s obzirom na čvorove <code>y</code> i <code>s</code> 
pozivima metode <code>backward</code>.
Autograd provodi unatražnu propagaciju 
sve do <code>a</code> i <code>b</code>
te tako računa njihov gradijent.
Višestruki pozivi metode <code>backward</code>
akumuliraju gradijente u atributu <code>grad</code> 
svakog od tenzora deklariranih s <code>requires_grad=True</code>. 
Primijetite da slijed poziva <code>y.backward(); a.backward()</code> 
postiže isti učinak kao i <code>(y + a).backward()</code>.

</p><p>
Atribut <code>grad</code> također je primjerak razreda
<code>torch.Tensor</code>, ali je najčešće odvojen 
od računskog grafa u kojem je njegov matični tenzor. 
Računanje viših derivacija možemo postići
pozivanjem metode <code>backward</code> 
s argumentom <code>create_graph=True</code>,
čime se traži da u računski graf uđu i derivacije tenzora.

</p><p>
Ako želimo iznova izračunati gradijent 
(npr. za neki drugi <code>x</code>),
onda moramo poništiti postojeći gradijent
kako bismo izbjegli akumuliranje. 
To možemo postići brisanjem atributa <code>grad</code> 
postavljanjem npr. <code>a.grad=None</code>.
<!-- 
ili, još bolje, s <code>a.grad.detach_(); a.grad.zero_</code>.
Navedeni slijed prvo odvaja gradijent od tenzora <code>a</code>
(podvlaka označava operaciju koja mijenja tenzor) 
kako bi bilo manje alokacija i dealokacija memorije.
-->

</p><p>
Ako nam za neki proračun ne treba izračun gradijenta, 
dobro je izraziti ga u tijelu 
upravitelja konteksta <code>torch.no_grad()</code>
koji isključuje Autograd (tada se PyTorch ponaša kao NumPy). 
Ovdje je primjer procedure koja računa konfuzijsku 
matricu na temelju vektora indeksa točnih oznaka <code>y_true</code> 
i predikcija <code>y_pred</code>
te vraća konfuzijsku matricu dimenzija 
<code>class_count</code>×<code>class_count</code>.

</p><pre><code class="python hljs"><span class="hljs-keyword">import</span> torch.nn.functional <span class="hljs-keyword">as</span> F

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">multiclass_confusion_matrix</span><span class="hljs-params">(y_true, y_pred, class_count)</span>:</span>
  <span class="hljs-keyword">with</span> torch.no_grad():
    y_pred = F.one_hot(y_pred, class_count)
    cm = torch.zeros([class_count] * <span class="hljs-number">2</span>, dtype=torch.int64, device=y_true.device)
    <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> range(class_count):
      cm[c, :] = y_pred[y_true == c, :].sum(<span class="hljs-number">0</span>)
    <span class="hljs-keyword">return</span> cm  
</code></pre>

<p>
Ovaj primjer pokazuje da PyTorch omogućuje kopiranje tenzora (i izračuna)
između različitih platformi/uređaja primjenom 
opcionalnog argumenta <code>device</code>,
koji primaju sve funkcije PyTorcha koje stvaraju nove tenzore.
Primijetite da pri tome tip podatka možemo zadati 
primjenom opcionalnog argumenta <code>dtype</code>.
Umjesto pokazanog poziva funkcije <code>torch.zeros</code> 
mogli bismo navesti i eksplicitnu konverziju
<code>torch.zeros([class_count] * 2).to(dtype=torch.int64, device=y_true.device)</code>,
koja bi dala jednak rezultat, ali bi prouzročila nepotrebno stvaranje jednog privremenog tenzora.
Tipične vrijednosti argumenta <code>device</code> su 
<code>torch.device('cpu')</code> (glavni procesor i memorija)
ili <code>torch.device('cuda:0')</code> (prvi GPU pod platformom CUDA).
Uređaj možemo zadati i znakovnim nizom: 
<code>device='cpu'</code> ili <code>device='cuda:0'</code>.

</p><p> 
Više informacija možete naći u 
<a href="https://pytorch.org/docs/stable/">službenoj dokumentaciji</a> PyTorcha.

<!-- <p>
TODO
- asinkrona evaluacija
- funkcija autograda -->


</p><h4 id="z0c">0c. Primjena PyTorcha u strojnom učenju</h4>

<p>
Program koji koristi PyTorch tipično sadrži sljedeće komponente:
</p><ol>
<li>
  model predstavljen objektom tipa izvedenog iz <code>torch.nn.Module</code>
  koji tipično sadrži druge module s parametrima,  
</li><li>
  procedure za učitavanje i obradu ulaznih podataka,
</li><li>      
  algoritam učenja.
</li></ol>

<p>
Procedure za učitavanje i obradu podataka tipično uključuju:
</p><ol>
<li>
  skup podataka – obično objekt tipa izvedenog iz 
  <code>torch.utils.data.Dataset</code> 
  <ul>
  
    metoda <code>__len__</code> tog objekta
    tipično vraća broj podataka,
  <li>
    metoda <code>__getitem__</code> tog objekta
    često učitava podatak iz datotečnog sustava
    zato što svi podatci ne mogu stati u radnu memoriju;
   </li></ul>
  </li><li>
    komponente za predobradu podataka na procesoru,
  </li><li>
    komponente za uzorkovanje podataka
    tj. određivanje redoslijeda učitavanja
    (<code>torch.utils.data.Sampler</code>),
  </li><li>
    komponentu za paralelno učitavanje i predobradu podataka 
    (<code>torch.utils.data.DataLoader</code>).
  </li></ol>

<p>
Elementi algoritma učenja tipično uključuju:
</p><ol>
<li>
  procedure za inicijalizaciju parametara,
</li><li>
  funkciju gubitka,
</li><li>
  optimizacijski algoritam – 
  obično objekt tipa izvedenog iz <code>torch.optim.Optimizer</code>
</li><li>
  petlju za učenje koja pribavlja podatke, računa gradijente gubitka 
  te primjenjuje korak optimizacije koji ažurira parametre.
</li></ol>

<p>
Sljedeći kod prikazuje primjer modela 
koji obavlja afinu transformaciju:
</p><pre><code class="python hljs"><span class="hljs-keyword">import</span> torch

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Affine</span><span class="hljs-params">(torch.nn.Module)</span>:</span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span><span class="hljs-params">(self, in_features, out_features)</span>:</span>
    super().__init__()
    self.out_features = out_features
    self.linear = torch.nn.Linear(in_features, out_features, bias=<span class="hljs-keyword">False</span>)
    self.bias = torch.nn.Parameter(torch.zeros(out_features))

  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">forward</span><span class="hljs-params">(self, input)</span>:</span>
    <span class="hljs-keyword">return</span> self.linear(input) + self.bias
</code></pre>

<p>
Prikazani primjer sadrži podmodel tipa <code>torch.nn.Linear</code> 
(koji već sam po sebi podržava pomak, ali to radi primjera ne koristimo)
i parametar tipa <code>torch.nn.Parameter</code>. 
Tip <code>torch.nn.Parameter</code>
je izveden iz <code>torch.Tensor</code> i uglavnom služi 
za razlikovanje parametara od drugih tenzora
(atribut <code>requires_grad</code> 
 podrazumijevano se postavlja na <code>True</code>).
<!-- nebitno? 
Razred <code>torch.nn.Module</code> 
ima posebno definiranu metodu 
<code>__setattr__(self, name, value)</code> 
koja se poziva pri postavljanju atributa kodom oblika <code>self.bias = b</code> 
ili <code>setattr(self, 'bias', b)</code> i u njoj razvrstava atribute u riječnike kao što su
<code>_modules</code> (moduli djeca), <code>_parameters</code> (parametri)
ili <code>_buffers</code> (ostali tenzori).
<code>modules</code> rekurzivno obilazi i vraća sve podmodule, 
--> 
Razred <code>torch.nn.Module</code> 
definira metode koje vraćaju iteratore 
po podmodulima (<code>children</code>), <code>modules</code>), 
parametrima (<code>parameters</code>) itd.
Metode s prefiksom <code>named_</code> vraćaju 
parove imena (putova) i objekata,
kao što pokazuje sljedeći primjer:
</p><pre><code class="python hljs"><span class="hljs-meta">&gt;&gt;&gt; </span>affine = Affine(<span class="hljs-number">3</span>, <span class="hljs-number">4</span>)
<span class="hljs-meta">&gt;&gt;&gt; </span>print(list(affine.named_parameters()))
[(<span class="hljs-string">'bias'</span>,
  Parameter containing:
  tensor([<span class="hljs-number">0.000</span>, <span class="hljs-number">0.000</span>, <span class="hljs-number">0.000</span>], requires_grad=<span class="hljs-keyword">True</span>)),
 (<span class="hljs-string">'linear.weight'</span>,
  Parameter containing:
  tensor([[<span class="hljs-number">-0.052</span>, <span class="hljs-number">-0.204</span>, <span class="hljs-number">-0.134</span>],
          [ <span class="hljs-number">0.167</span>,  <span class="hljs-number">0.467</span>, <span class="hljs-number">-0.180</span>],
          [ <span class="hljs-number">0.285</span>, <span class="hljs-number">-0.055</span>,  <span class="hljs-number">0.469</span>]], requires_grad=<span class="hljs-keyword">True</span>))]         
</code></pre>

<p>
Module obično oblikujemo tako da mogu raditi 
nad mini-grupama podataka. 
Primjerice, poziv
<code>affine(torch.randn(5, 3))</code>
rezultira tenzorom dimenzija (5, 4),
pri čemu <code>torch.randn(5, 3)</code>
stvara matricu slučajnih normalno distribuiranih elemenata.

<!--
<p>
Kao i tenzori, moduli isto imaju metodu <code>to</code> kojom se mogu svi parametri (i drugi tenzori) prebaciti 
u drugi tip ili na drugi uređaj. 
Imaju i metode <eval>train</eval> i <eval>eval</eval> koje mijenjaju
stanje podmodula koji se trebaju drugačije ponašati tijekom učenja i evaluacije.
-->

</p><p>
Više o modulima se može naći u <a href="https://pytorch.org/docs/stable/nn.html">službenoj dokumentaciji</a>.
Različite procedure za inicijalizaciju parametara su u paketu <code>torch.nn.init</code>. 

</p><p>
Sljedeći primjer demonstrira osnove učitavanja podataka:
</p><pre><code class="python hljs"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-keyword">import</span> torch
<span class="hljs-keyword">from</span> torch.utils.data <span class="hljs-keyword">import</span> DataLoader

dataset = [(torch.randn(<span class="hljs-number">4</span>, <span class="hljs-number">4</span>), torch.randint(<span class="hljs-number">5</span>, size=())) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> range(<span class="hljs-number">25</span>)]
dataset = [(x.numpy(), y.numpy()) <span class="hljs-keyword">for</span> x, y <span class="hljs-keyword">in</span> dataset]
loader = DataLoader(dataset, batch_size=<span class="hljs-number">8</span>, shuffle=<span class="hljs-keyword">False</span>, 
                    num_workers=<span class="hljs-number">0</span>, collate_fn=<span class="hljs-keyword">None</span>, drop_last=<span class="hljs-keyword">False</span>)
<span class="hljs-keyword">for</span> x, y <span class="hljs-keyword">in</span> loader:
  print(x.shape, y.shape)
</code></pre>

<p>
Primjer prvo generira slučajan skup od 25 
slučajnih parova matrica 4x4 i skalara. 
Podatci se iz demonstrativnih razloga 
bez kopiranja prebacuju u tip <code>numpy.ndarray</code> 
pozivanjem metode <code>numpy</code>. 
Skup podataka predaje se konstruktoru razreda <code>DataLoader</code> 
čiji primjerak ostvaruje iteriranje po mini-grupama. 
Slijede neki bitniji argumenti koje prima konstruktor. 
Argument <code>batch_size</code> je veličina mini-grupe. 
Argument <code>shuffle</code> je logička vrijednost 
koja određuje hoće li se prije svakog prolaza
odabrati nasumični redoslijed. 
Argument <code>num_workers</code> je broj paralelnih procesa za učitavanje podataka. 
Argument <code>collate_fn</code> je funkcija koja iz pojedinih podataka slaže mini-grupe. 
U podrazumijevanom slučaju <code>collate_fn=None</code> 
poziva se funkcija <code>torch.as_tensor</code>, 
što NumPyjev niz bez kopiranja pretvara u <code>torch.Tensor</code>.
Argument <code>drop_last</code> je Booleova vrijednost
koja određuje hoće li se ispustiti zadnja 
mini-grupa ako je preostalo manje ods
 <code>batch_size</code> elemenata za zadnu mini-grupu.
U prikazanom slučaju program će 3 puta ispisati
<code>torch.Size([8, 4, 4]) torch.Size([8])</code> 
i jednom <code>torch.Size([1, 4, 4]) torch.Size([1])</code>. 
Više o učitavanju podataka se može naći u 
<a href="https://pytorch.org/docs/stable/nn.html">službenoj dokumentaciji</a>.

</p><p>
Sljedeća procedura opisuje primjer iteracije 
kod nadziranog učenja:
</p><pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">supervised_training_step</span><span class="hljs-params">(ctx, x, y)</span>:</span>
  ctx.model.train()  <span class="hljs-comment"># postavljanje modela u stanje za učenje</span>
  output = ctx.model(x)  <span class="hljs-comment"># unaprijedni prolaz</span>
  loss = ctx.loss(output, y).mean()  <span class="hljs-comment"># izračun gubitka</span>

  ctx.optimizer.zero_grad()  <span class="hljs-comment"># postavljanje gradijenta u 0</span>
  loss.backward()  <span class="hljs-comment"># unatražni prolaz</span>
  ctx.optimizer.step()  <span class="hljs-comment"># primjena koraka optimizacije</span>
</code></pre>

<p>
<code>ctx</code> je pristupni objekt koji obuhvaća 
model <code>model</code>,
funkciju gubitka <code>loss</code> i 
optimizacijski algoritam <code>optimizer</code>. 
<code>x</code> i <code>y</code> su ulazna i izlazna mini-grupa.
Prvo se model postavlja u stanje za učenje 
jer može sadržavati module kao što su dropout ili normalizacija po podacima 
koji se pri učenju različito ponašaju nego kod evaluacije. 
Zatim se u unaprijednom prolazu računaju izlaz modela 
i srednji gubitak na mini-grupi. 
Nakon toga slijedi korak optimizacije. 
Objekt <code>optimizer</code> je tipa izvedenog iz <code>torch.optim.Optimizer</code> 
te referencira parametre.

</p><p>
Ovako izgleda jednostavan primjer stvaranja optimizatora:
</p><pre><code class="python hljs"><span class="hljs-keyword">from</span> torch.optim <span class="hljs-keyword">import</span> SGD
optimizer = SGD(model.parameters(), lr=<span class="hljs-number">1e-2</span>, weight_decay=<span class="hljs-number">1e-4</span>)
</code></pre>

<p>
Osnovni argumenti su parametri i 
veličina optimizacijskog koraka <code>lr</code>.
Radi efikasnosti, PyTorch nudi mogućnost provođenja 
L2 regularizacije izravno u optimizatoru. 
Zbog toga se u konstruktoru pojavljuje argument <code>weight_decay</code>.
Glavne metode optimizatora su <code>zero_grad</code> i <code>step</code>.
Metodu <code>zero_grad</code> treba pozvati 
prije svakog računanja gradijenta ako ga ne želimo akumulirati.
Metoda <code>step</code> izvršava korak optimizacije. 
U slučaju gradijentnog spusta, 
ta metoda umanjuje sve parametre
za odgovarajući gradijent 
pomnožen veličinom koraka.

Više o optimizatorima se može naći u 
<a href="https://pytorch.org/docs/stable/optim.html">službenoj dokumentaciji</a>.


</p><h4 id="z1">1. Generiranje linearno nerazdvojivih podataka</h4>

<p>
Rješenje ove vježbe slobodno preuzmite
<a href="http://www.zemris.fer.hr/~ssegvic/du/src/data.py">ovdje</a>.

</p><p>
U dosadašnjim eksperimentima
logistička regresija je postizala
iznimno dobre klasifikacijske rezultate.
To nije nikakvo čudo jer se pokazuje da 
aposteriorna vjerojatnost razreda podataka 
generiranih Gaussovim razdiobama s dijeljenom kovarijancom 
odgovara upravo sigmoidi afino transformiranih podataka.
Istina, u našim smo eksperimentima mrvicu odstupili
od teoretskih pretpostavki 
(naši razredi su imali različite kovarijance),
ali rezultati pokazuju da to odstupanje nije bilo presudno.
Sada ćemo situaciju malo otežati 
na način da pozitivne i negativne podatke
generiramo nešto složenijim generativnim modelom.

</p><p>
Upute:
</p><ul>
<li>
  Napišite potprogram <code>sample_gmm_2d(K, C, N)</code>
  koja stvara <code>K ≥ C</code> slučajnih
  bivarijatnih Gaussovih razdioba,
  te iz svake od njih uzorkuje <code>N</code> podataka.
  Za razliku od funkcije <code>sample_gauss_2d</code>
  ovdje svakoj bivarijatnoj razdiobi G<sub>i</sub>
  trebamo pridružiti razred c<sub>i</sub>
  koji slučajno biramo iz skupa {0, 1, ..., C-1}.
  Na taj način dobivamo podatkovne razrede generirane
  mješavinama slučajno odabranih Gaussovih razdioba.
  Kao i ranije, funkcija treba vratiti matricu <code>X</code>
  čiji retci odgovaraju uzorkovanim podatcima
  te matricu <code>Y</code> čiji jedini stupac sadrži
  indeks razreda odgovarajućeg podatka.
</li><li>
  U izvedbi potprograma potrebno je prvo
  instancirati slučajne distribucije
  i svakoj od njih dodijeliti slučajan razred
  od <code>0</code> do <code>C - 1</code>.
  Zatim je potrebno iz svake distribucije 
  uzorkovati traženi broj podataka. 
  Svi podatci uzorkovani iz iste distribucije
  trebaju dobiti indeks razreda koji je 
  dodijeljen toj distribuciji.
</li><li>
  Potprogram treba vratiti sljedeće podatke:
<pre><code class="python hljs"><span class="hljs-string">'''
  X  ... podatci u matrici [K·N x 2 ]
  Y_ ... indeksi razreda podataka [K·N]
'''</span>
</code></pre>
</li></ul>
  
<p>
Izvedite potprogram <code>sample_gmm_2d</code>
te ga ispitajte uz pomoć prethodno razvijenih
potprograma za crtanje 
(<code>graph_surface</code> i <code>graph_data</code>). 
Ovisno o parametrima i stanju generatora slučajnih brojeva,
vaš rezultat mogao bi izgledati kao na sljedećoj slici.
Naši parametri bili su 
 <code>K=4</code>, 
 <code>C=2</code>, 
 <code>N=30</code>.

</p><p>
<img src="./lab1_task_croatian_files/data_gmm.png" alt="data">

</p><p>
Ako je rezultat izvođenja prihvatljiv,
pohranite kod u datoteku <code>data.py</code>.

</p><h4 id="z2">2. Višeslojna klasifikacija u Pythonu (20% bodova)</h4>

<p>
Oblikujte i izvedite modul <code>fcann2</code>
za rad s probabilističkim klasifikacijskim modelom
s jednim skrivenim slojem prema uputama iz odjeljka
<a href="http://www.zemris.fer.hr/~ssegvic/du/lab1.shtml#z0a">0a</a>.
Neka organizacija vašeg koda bude sukladna 
organizaciji modula <code>logreg</code>
iz prethodne vježbe.
Napišite metode <code>fcann2_train</code>,
<code>fcann2_classify</code>.
Isprobajte njihov rad na umjetnom skupu
2D podataka dvaju razreda dobivenih
iz Gaussove mješavine od 6 komponenata.

</p><p>
Ovisno o parametrima i stanju generatora slučajnih brojeva,
vaš rezultat mogao bi izgledati kao na sljedećoj slici.
Naši parametri bili su:
 <code>K=6</code>, 
 <code>C=2</code>, 
 <code>N=10</code>,
 <code>param_niter=1e5</code>,
 <code>param_delta=0.05</code>,
 <code>param_lambda=1e-3</code> (koeficijent regularizacije),
 dimenzija skrivenog sloja: 5.

</p><p>
<img src="./lab1_task_croatian_files/graph_surface_gmm_ann.png" alt="data">

</p><p>
Ako je rezultat prihvatljiv, pohranite kod
u datoteku <code>fcann2.py</code>.


</p><h4 id="z3">3. Linearna regresija u PyTorchu (10% bodova)</h4>

<p>
Jednostavan primjer implementacije algoritma strojnog učenja
u PyTorchu prikazat ćemo na potpunom primjeru
optimizacijskog postupka za određivanje parametara
pravca <code>y = a * x + b</code>
koji prolazi kroz točke 
<code>(1,3)</code> i <code>(2,5)</code>.

</p><pre><code class="python hljs"><span class="hljs-keyword">import</span> torch
<span class="hljs-keyword">import</span> torch.nn <span class="hljs-keyword">as</span> nn
<span class="hljs-keyword">import</span> torch.optim <span class="hljs-keyword">as</span> optim


<span class="hljs-comment">## Definicija računskog grafa</span>
<span class="hljs-comment"># podaci i parametri, inicijalizacija parametara</span>
a = torch.randn(<span class="hljs-number">1</span>, requires_grad=<span class="hljs-keyword">True</span>)
b = torch.randn(<span class="hljs-number">1</span>, requires_grad=<span class="hljs-keyword">True</span>)

X = torch.tensor([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>])
Y = torch.tensor([<span class="hljs-number">3</span>, <span class="hljs-number">5</span>])

<span class="hljs-comment"># optimizacijski postupak: gradijentni spust</span>
optimizer = optim.SGD([a, b], lr=<span class="hljs-number">0.1</span>)

<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">100</span>):
    <span class="hljs-comment"># afin regresijski model</span>
    Y_ = a*X + b

    diff = (Y-Y_)

    <span class="hljs-comment"># kvadratni gubitak</span>
    loss = torch.sum(diff**<span class="hljs-number">2</span>)

    <span class="hljs-comment"># računanje gradijenata</span>
    loss.backward()

    <span class="hljs-comment"># korak optimizacije</span>
    optimizer.step()

    <span class="hljs-comment"># Postavljanje gradijenata na nulu</span>
    optimizer.zero_grad()

    print(f<span class="hljs-string">'step: {i}, loss:{loss}, Y_:{Y_}, a:{a}, b {b}'</span>)
</code></pre>

<p>
Zadatci:
</p><ul>
<li>
  Ponovite osnove PyTorcha 
  navedene u odjeljcima
  <a href="http://www.zemris.fer.hr/~ssegvic/du/lab1.shtml#z0b">0b</a> i
  <a href="http://www.zemris.fer.hr/~ssegvic/du/lab1.shtml#z0c">0c</a>.
  Analizirajte prikazani program
  te provjerite ispravnost izvođenja.
</li><li>
  Modificirajte program na način
  da se pravac može provući kroz
  proizvoljan broj točaka.
  Pripazite da iznosi gradijenata
  budu neovisni o broju podataka.
</li><li>
  Ispišite vrijednosti gradijenata
  tijekom napredovanja postupka.
</li><li>
  Odredite analitičke izraze za
  gradijente funkcije gubitka po parametrima
  <code>a</code> i <code>b</code>.
  Izračunajte eksplicitno te gradijente.
  Ispišite vrijednosti gradijenata i uvjerite se
  da odgovaraju onima koje automatski određuje PyTorch.
</li></ul>

<p>
Ako je rezultat prihvatljiv, pohranite kod
u datoteku <code>pt_linreg.py</code>.

</p><h4 id="z4">4. Logistička regresija u PyTorchu (20% bodova)</h4>

<p>
U ovom zadatku ćemo postupak logističke regresije
izvesti uz pomoć PyTorcha.
Dobiveni kod će biti oko dvostruko kraći
od "ručnog rada" koji je bio predmet nulte vježbe.
Glavne prednosti PyTorcha su u tome
što ne moramo izvoditi gradijente te 
što se dobiveni program bez ikakvih izmjena
može izvršavati na moćnim grafičkim karticama.
Te prednosti će se pokazati presudnima kod velikih modela
sa stotinama milijuna slobodnih parametara
(kod malih modela procesori opće namjene
 mogu biti brži od grafičkih procesora
 zbog dugotrajnog prebacivanja podataka).

</p><p>
U PyTorchu model obično izražavamo 
nasljeđivanjem osnovnog razreda <code>torch.nn.Module</code>.
Pritom je potrebno definirati konstruktor i 
funkciju <code>forward</code> koja predstavlja 
unaprijedni prolaz kroz model.
Tenzore koji predstavljaju parametre modela 
kao atribute tipa <code>torch.nn.Parameter</code>.
To nam omogučava jednostavan 
pristup parametrima modela korištenjem
funkcije <code>torch.nn.Module.parameters()</code>.
Modul za učenje logističke regresije bi mogao 
izgledati ovako:
</p><pre><code class="python hljs"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PTLogreg</span><span class="hljs-params">(nn.Module)</span>:</span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span><span class="hljs-params">(self, D, C)</span>:</span>
    <span class="hljs-string">"""Arguments:
       - D: dimensions of each datapoint 
       - C: number of classes
    """</span>

    <span class="hljs-comment"># inicijalizirati parametre (koristite nn.Parameter):</span>
    <span class="hljs-comment"># imena mogu biti self.W, self.b</span>
    <span class="hljs-comment"># ...</span>

  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">forward</span><span class="hljs-params">(self, X)</span>:</span>
    <span class="hljs-comment"># unaprijedni prolaz modela: izračunati vjerojatnosti</span>
    <span class="hljs-comment">#   koristiti: torch.mm, torch.softmax</span>
    <span class="hljs-comment"># ...</span>

  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_loss</span><span class="hljs-params">(self, X, Yoh_)</span>:</span>
    <span class="hljs-comment"># formulacija gubitka</span>
    <span class="hljs-comment">#   koristiti: torch.log, torch.mean, torch.sum</span>
    <span class="hljs-comment"># ...</span>


<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">train</span><span class="hljs-params">(model, X, Yoh_, param_niter, param_delta)</span>:</span>
  <span class="hljs-string">"""Arguments:
     - X: model inputs [NxD], type: torch.Tensor
     - Yoh_: ground truth [NxC], type: torch.Tensor
     - param_niter: number of training iterations
     - param_delta: learning rate
  """</span>
  
  <span class="hljs-comment"># inicijalizacija optimizatora</span>
  <span class="hljs-comment"># ...</span>

  <span class="hljs-comment"># petlja učenja</span>
  <span class="hljs-comment"># ispisujte gubitak tijekom učenja</span>
  <span class="hljs-comment"># ...</span>


<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">eval</span><span class="hljs-params">(model, X)</span>:</span>
  <span class="hljs-string">"""Arguments:
     - model: type: PTLogreg
     - X: actual datapoints [NxD], type: np.array
     Returns: predicted class probabilites [NxC], type: np.array
  """</span>
  <span class="hljs-comment"># ulaz je potrebno pretvoriti u torch.Tensor</span>
  <span class="hljs-comment"># izlaze je potrebno pretvoriti u numpy.array</span>
  <span class="hljs-comment"># koristite torch.Tensor.detach() i torch.Tensor.numpy()</span>
</code></pre>

<p>
Primijetite da, za razliku od prethodne vježbe,
točne oznake razreda podataka za učenje
sada nazivamo <code>Yoh_</code> umjesto <code>Y_</code>.
Razlog tome je što unakrsnu entropiju
lakše izražavamo kad su oznake smještene u matrici
gdje retci odgovaraju podatcima, a stupci razredima
(tzv. one-hot notacija).
Ako podatak <code>x_i</code> 
odgovara razredu <code>c_j</code>,
onda vrijedi <code>Yoh_[i,j] = 1</code> te 
<code>Yoh_[i,k] = 0</code> za <code>k!=j</code> ("one hot").
Podsjetimo se, tako organizirane oznake razreda
u ranijim matematičkim izrazima nazivali smo
matricom vektorski kodiranih oznaka <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-60-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;Y&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="font-size: 119%; position: relative;"><span id="MJXc-Node-1603" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-1604" class="mjx-mrow"><span id="MJXc-Node-1605" class="mjx-texatom"><span id="MJXc-Node-1606" class="mjx-mrow"><span id="MJXc-Node-1607" class="mjx-msup"><span class="mjx-base"><span id="MJXc-Node-1608" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-B" style="padding-top: 0.37em; padding-bottom: 0.37em;">Y</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span id="MJXc-Node-1609" class="mjx-mo" style=""><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.265em; padding-bottom: 0.318em;">′</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><msup><mi mathvariant="bold">Y</mi><mo>′</mo></msup></mrow></math></span></span><script type="math/tex" id="MathJax-Element-60">\mathbf{Y'}</script>.

</p><p>
Struktura ispitnog programa bila bi vrlo slična
ispitnim programima iz prethodne vježbe:
</p><pre><code class="python hljs"><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">"__main__"</span>:
  <span class="hljs-comment"># inicijaliziraj generatore slučajnih brojeva</span>
  np.random.seed(<span class="hljs-number">100</span>)

  <span class="hljs-comment"># instanciraj podatke X i labele Yoh_</span>

  <span class="hljs-comment"># definiraj model:</span>
  ptlr = PTLogreg(X.shape[<span class="hljs-number">1</span>], Yoh_.shape[<span class="hljs-number">1</span>])

  <span class="hljs-comment"># nauči parametre (X i Yoh_ moraju biti tipa torch.Tensor):</span>
  train(ptlr, X, Yoh_, <span class="hljs-number">1000</span>, <span class="hljs-number">0.5</span>)

  <span class="hljs-comment"># dohvati vjerojatnosti na skupu za učenje</span>
  probs = eval(ptlr, X)

  <span class="hljs-comment"># ispiši performansu (preciznost i odziv po razredima)</span>

  <span class="hljs-comment"># iscrtaj rezultate, decizijsku plohu</span>
</code></pre>

<p>
Zadatci:
</p><ul><li>
  Dopunite izvedbu razreda <code>PTLogreg</code>.
  Provjerite postiže li vaš program iste rezultate
  kao i odgovarajući program iz nulte vježbe
  za slučajeve dva i tri razreda podataka.
  Pripazite na to da gubitak karakterizirate tako
  da ne ovisi o broju podataka za učenje 
  (tako je lakše interpretirati iznos gubitka 
   te validirati korak učenja).
</li><li>  
  Dodajte regularizaciju na način da gubitak formulirate
  kao zbroj unakrsne entropije i 
  L2 norme vektorizirane matrice težina
  pomnožene hiperparametrom <code>param_lambda</code>.
  Ispitajte utjecaj regularizacije na oblik decizijske plohe.
</li><li>
  Eksperimentirajte s različitim vrijednostima hiperparametara. 
  Pronađite kombinacije hiperparametara 
  za koje vaš program ne uspijeva pronaći 
  zadovoljavajuće rješenje i pokušajte objasniti što se događa.
</li></ul>

<p>
Ako je rezultat izvođenja prihvatljiv,
pohranite kod u datoteku <code>pt_logreg.py</code>.


</p><h4 id="z5">5. Konfigurabilni duboki modeli u PyTorchu (20% bodova)</h4>
<p>
Naš sljedeći zadatak je proširiti izvedbu logističke regresije
na način da omogućimo jednostavno zadavanje 
potpuno povezanih modela proizvoljne dubine.
Nazovimo naš novi razred <code>PTDeep</code>.
Neka sučelje tog razreda bude posve identično
sučelju razreda <code>PTLogreg</code>,
osim što ćemo u konstruktoru
umjesto dimenzionalnosti podataka i broja razreda
zadati listu cijelih brojeva koji će
određivati broj neurona u svakom sloju.
Dodatno, u konstruktoru ćemo zadati i aktivacijsku funkciju
za skrivene slojeve dubokog modela.
Nulti element te konfiguracijske liste određuje
dimenzionalnost podataka, 
dok njen posljednji element 
(na rednom broju <code>n-1</code>)
odgovara broju razreda.
Elementi konfiguracije na indeksima od <code>1</code> 
do <code>n-2</code> (ako postoje)
sadržavaju brojeve neurona u skrivenim slojevima.
Tako konfiguracija <code>[2, 3]</code> 
odgovara logističkoj regresiji
dvodimenzionalnih podataka u tri razreda.
Konfiguracija <code>[2,5,3]</code> odgovara 
modelu s jednim skrivenim slojem <code>h</code>
koji se sastoji od 5 neurona:
</p><pre><code class="python hljs">h = f (X * W_1 + b_1)
probs = softmax(h * W_2 + b_2) 
</code></pre>
<p>
U posljednjem primjeru dimenzije čvorova grafa
trebaju biti kako slijedi
(upitnici označavaju nepoznatu brojnost
 skupa podataka na kojem primijenjujemo model):
</p><pre>  X     ... [?, 2]
  W_1   ... [2, 5]
  b_1   ... [1, 5]
  h_1   ... [?, 5]
  W_2   ... [5, 3]
  b_2   ... [1, 3]
  probs ... [?, 3]
</pre>
<p>
Implementacija razreda <code>PTDeep</code>
bit će vrlo slična implementaciji
razreda <code>PTLogreg</code>.
U konstruktoru moramo inicijalizirati 
matrice težina i vektora pomaka.
S obzirom na to da broj slojeva može biti različit,
matrice težina i vektore pomaka
trebat će smjestiti u liste
(nazovimo ih <code>self.weights</code> i <code>self.biases</code>).
Slično kao u prethodnom zadatku,
kako bismo iskoristili sve mogućnosti
nadrazreda <code>torch.nn.Module</code>
atribut koji predstavlja listu parametara
treba biti tipa
<code>torch.nn.ParameterList</code>,
dok članovi te kolekcije trebaju biti tipa
<code>torch.nn.Parameter</code>.
Nelinearnost u skrivenim slojevima 
možete izraziti uz pomoć
funkcija <code>torch.relu</code>,
<code>torch.sigmoid</code> odnosno <code>torch.tanh</code>.
<br>
<br>
<b>Napomena</b>: PyTorch sadrži i razrede za potpuno povezani sloj <code>torch.nn.Linear</code> 
i unaprijedni model zadan nizom slojeva <code>torch.nn.Sequential</code>. 
Ipak, iz edukativnih razloga zadatak ćemo riješiti na već opisani način.
Znatiželjni dodatno mogu zadatak riješiti korištenjem gotovih razreda.

</p><p>
Zadatci:
</p><ul>
<li>
  Izvedite razred <code>PTDeep</code>
  te isprobajte konfiguraciju [2, 3]
  na istim podatcima kao i u prethodnom zadatku
  (ispitni program će vam biti vrlo sličan).
  Provjerite da su rezultati isti kao i ranije.
</li><li>
  Napišite metodu <code>count_params</code>
  koja će ispisati simboličko ime i dimenzije
  tenzora svih parametara.
  Dodatno, neka funkcija računa i
  ukupan broj parametara modela
  (npr. za konfiguraciju [2, 3] rezultat bi trebao biti 9).
  Za obilazak svih parametara modela sada elegantno
  možemo koristiti iterator 
  <a href="https://pytorch.org/docs/stable/nn.html#torch.nn.Module.named_parameters">named_parameters</a>.
</li><li>
  Isprobajte vaš kod na podatcima dobivenim pozivima
  <code>data.sample_gmm_2d(4, 2, 40)</code> i
  <code>data.sample_gmm_2d(6, 2, 10)</code>,
  za konfiguracije [2, 2], [2, 10, 2] i [2, 10, 10, 2].
  Ispišite točnost, odziv, preciznost i prosječnu preciznost
  te grafički prikažite rezultate klasifikacije
  i izgled decizijske plohe.
  Ako ne dođe do konvergencije, obratite pažnju
  na vrijednosti hiperparametara.
</li><li>
  Usporedite rezultate s onim što se zbiva
  kad za prijenosnu funkciju postavite sigmoidu.
  Sigmoida bi za ovakve male probleme 
  zbog neprekidnosti trebala
  postići bolje rezultate od zglobnice.
  Glavna prednost zglobnice je u tome što nema zasićenje 
  pa kod dubljih modela gradijenti teže nestaju. 
</li></ul>

<p>
Ovisno o parametrima i stanju generatora slučajnih brojeva,
vaš rezultat mogao bi izgledati kao na sljedećoj animaciji
(naši parametri bili su:
 <code>K=6</code>, 
 <code>C=2</code>, 
 <code>N=10</code>,
 <code>param_niter=1e4</code>,
 <code>param_delta=0.1</code>,
 <code>param_lambda=1e-4</code> (koeficijent regularizacije),
 <code>config=[2, 10, 10, 2]</code>, ReLU).

</p><p>
<img src="./lab1_task_croatian_files/graph_surface_gmm_gd.gif" alt="data">

<!--
<p>
Zanimljivo je usporediti dobiveni animirani prikaz
s prikazom napredovanja programa
u kojem je zadan različiti optimizacijski postupak.
Usporedba pokazuje da postupci mogu napredovati
prema različitim lokalnim minimumima funkcije cilja.
Međutim, kapacitet dubokog modela
je toliko veliki da je to manje bitno:
prikazana rješenja odgovaraju
otprilike istoj vrijednosti funkcije cilja
te otprilike isti AP na skupu za učenje.
Rezultati su u skladu s dominantnim vjerovanjem
da krajobraz funkcija gubitka dubokih modela
u pravilu ima više lokalnih minimuma
koji su otprilike jednako dobri
u smislu postignute performanse.

<p>
<img src="figures/graph_surface_gmm_adam.gif" alt="data">
-->

</p><p>
Ako je rezultat izvođenja prihvatljiv,
vaš kod pohranite u datoteku <code>pt_deep.py</code>.

</p><h4 id="z6">6. Usporedba s jezgrenim SVM-om (10% bodova)</h4>

<p>
Podsjetite se na svojstva jezgrenog SVM-a
(model, gubitak, optimizacija)
te pročitajte dokumentaciju modula <code>svm</code>
biblioteke <code>scikit-learn</code>.
Oblikujte razred <code>KSVMWrap</code>
kao tanki omotač oko modula <code>sklearn.svm</code>
kojeg ćemo moći primijeniti na našim dvodimenzionalnim podatcima.
S obzirom na to da će omotač biti jednostavan,
učenje možemo provesti iz konstruktora
dok predikciju razreda, dohvat klasifikacijskih mjera 
(potrebne za prosječnu preciznost)
i dohvat potpornih vektora možemo izvesti u metodama.
Neka sučelje razreda bude kako slijedi:
</p><pre><code class="python hljs"><span class="hljs-string">'''
Metode:
  __init__(self, X, Y_, param_svm_c=1, param_svm_gamma='auto'):
    Konstruira omotač i uči RBF SVM klasifikator
    X, Y_:           podatci i točni indeksi razreda
    param_svm_c:     relativni značaj podatkovne cijene
    param_svm_gamma: širina RBF jezgre

  predict(self, X)
    Predviđa i vraća indekse razreda podataka X

  get_scores(self, X):
    Vraća klasifikacijske mjere
    (engl. classification scores) podataka X;
    ovo će vam trebati za računanje prosječne preciznosti.

  support
    Indeksi podataka koji su odabrani za potporne vektore
'''</span>
</code></pre>

<p>
Zadatci:
</p><ul>
<li>
  Modificirajte funkciju <code>data.graph_data</code>
  na način da joj dodate argument <code>special</code>.
  Argument <code>special</code> zadaje listu indeksa podataka 
  koje prilikom iscrtavanja treba posebno naglasiti
  udvostručavanjem veličine njihovih simbola.
</li><li>
  Isprobajte vaš razred na podacima dvaju razreda
  uzorkovanih iz mješavina Gaussovih distribucija.
  Kao i obično, ispišite pokazatelje performanse
  (točnost, odziv, preciznost, prosječnu preciznost).
</li><li>
  Usporedite performansu modela koje implementiraju razredi
  <code>PTDeep</code> i <code>KSVMWrap</code> 
  na većem broju slučajnih skupova podataka.
  Koje su prednosti i nedostatci njihovih funkcija gubitka?
  Koji od dvaju postupaka daje bolju garantiranu performansu?
  Koji od postupaka može primiti veći broj parametara?
  Koji bi od postupaka bio prikladniji 
  za 2D podatke uzorkovane 
  iz mješavine Gaussovi distribucija?
</li><li>
  Iscrtajte decizijsku plohu i rezultate klasifikacije RBF SVM-a.
  Iskoristite argument <code>special</code>
  funkcije <code>data.graph_data</code>
  da u prikazu podataka posebno istaknete potporne vektore.
  Ovisno o parametrima i stanju generatora slučajnih brojeva,
  vaš rezultat mogao bi izgledati kao na sljedećoj animaciji
  (naši parametri bili su:
   <code>K=6</code>, 
   <code>C=2</code>,
   <code>N=10</code>,
   <code>param_svm_c=1</code>, 
   <code>param_svm_gamma='auto'</code>).
</li></ul>

<p>
<img src="./lab1_task_croatian_files/graph_surface_svm.png" alt="data">

</p><p>
Ako je rezultat izvođenja prihvatljiv,
pohranite kod u datoteku <code>ksvm_wrap.py</code>.

</p><h4 id="z7">7. Studija slučaja: MNIST (20% bodova)</h4>

<p>
U dosadašnjim vježbama naučene modele
nismo evaluirali na nezavisnom skupu za testiranje.
Takvi eksperimenti ne bi nužno otkrili
generalizacijski potencijal algoritama,
jer se generativni modeli stvarnih podataka
ne moraju moći opisati Gaussovim razdiobama.
Zato ćemo se u ovoj vježbi posvetiti
generalizacijskoj performansi
na stvarnom skupu podataka MNIST.

</p><p>
MNIST predstavlja skup slika
rukom pisanih znamenki od 0 do 9.
Svaka znamenka predstavljena je slikom 
dimenzija 28x28 piksela.
MNIST sadrži 60000 slika u skupu za učenje,
i 10000 slika u skupu za testiranje.
MNIST možemo jednostavno učitati sljedećim kodom:
</p><pre><code class="python hljs"><span class="hljs-keyword">import</span> torch
<span class="hljs-keyword">import</span> torchvision

dataset_root = <span class="hljs-string">'/tmp/mnist'</span>  <span class="hljs-comment"># change this to your preference</span>
mnist_train = torchvision.datasets.MNIST(dataset_root, train=<span class="hljs-keyword">True</span>, download=<span class="hljs-keyword">True</span>)
mnist_test = torchvision.datasets.MNIST(dataset_root, train=<span class="hljs-keyword">False</span>, download=<span class="hljs-keyword">True</span>)

x_train, y_train = mnist_train.data, mnist_train.targets
x_test, y_test = mnist_test.data, mnist_test.targets
x_train, x_test = x_train.float().div_(<span class="hljs-number">255.0</span>), x_test.float().div_(<span class="hljs-number">255.0</span>)
</code></pre>

<p>
Sada su skupovi slika i indeksi razreda
predstavljeni PyTorchevim tenzorima
<code>x_train</code>,
<code>y_train</code>,
<code>x_test</code> i
<code>y_test</code>.
Do dimenzija podataka i broja razreda
možemo doći jednostavnim propitivanjem oblika tih matrica.
</p><pre><code class="python hljs">N = x_train.shape[<span class="hljs-number"><span class="hljs-number">0</span></span>]
D = x_train.shape[<span class="hljs-number"><span class="hljs-number">1</span></span>] * x_train.shape[<span class="hljs-number"><span class="hljs-number">2</span></span>]
C = y_train.max().add_(<span class="hljs-number">1</span>).item()
</code></pre>

<p>
Pojedinačne slike možemo prikazati
pozivom funkcije <code>plt.imshow</code>
pri čemu preporučamo koristiti argument
<code>cmap = plt.get_cmap('gray')</code>.

</p><p> 
Zadatci:
</p><ul>
<li>
  Za model konfiguracije [784, 10]
  iscrtajte i komentirajte naučene matrice težina
  za svaku pojedinu znamenku.
  Ponovite za različite iznose regularizacije.
</li><li>
  Naučite duboke modele s konfiguracijama
  [784, 10], [784, 100, 10],
  [784, 100, 100, 10] i [784, 100, 100, 100, 10].
  Ako nemate funkcionalan GPU ne morate provoditi 
  eksperimente s posljednje dvije konfiguracije.
  Nakon svake epohe učenja pohranite gubitak.
  Obratite pažnju na to da će dublji modeli
  bolje konvergirati s više iteracija s manjim korakom.
  Usporedite modele s obzirom na kretanje gubitka kroz epohe
  te pokazatelje performanse (točnost, preciznost, odziv)
  na skupovima za učenje i testiranje.
  Za najuspješniji model iscrtajte podatke
  koji najviše doprinose funkciji gubitka.
</li><li>
  Proučite utjecaj regularizacije na performansu
  dubokih modela na skupovima za učenje i testiranje.
</li><li>
  Slučajno izdvojite 1/5 podataka
  iz skupa za učenje u skup za validaciju.
  Tijekom treniranja evaluirajte validacijsku performansu
  nakon završetka petlje po grupama podataka
  te na kraju vratite model s najboljom 
  validacijskom performansom (engl. early stopping).
  Procijenite postignuti utjecaj na 
  konačnu vrijednost funkcije cilja
  i generalizacijsku performansu.
</li><li>
  Implementirajte stohastički gradijentni spust
  odnosno postupak učenja po mini-grupama.
  Prije svake epohe izmiješajte podatke,
  zatim ih podijelite u n grupa (engl. mini-batch) 
  i onda provedite korak učenja
  za svaku grupu posebno.
  Pripazite na to da gubitak karakterizirate tako
  da ne ovisi o veličini grupe jer je tako lakše
  interpretirati iznos gubitka te validirati korak učenja.
  Vaš kod pohranite u metodi <code>train_mb</code>.
  Procijenite utjecaj na kvalitetu konvergencije
  i postignutu performansu 
  za najuspješniju konfiguraciju iz prethodnog zadatka.

  Napomena: u svrhu razumijevanja postupka učenja po mini-grupama,
  u ovoj vježbi nije dozvoljeno korištenje razreda 
  <a href="https://pytorch.org/docs/stable/data.html?highlight=dataloader#torch.utils.data.DataLoader"><code>torch.utils.data.DataLoader</code></a>.
</li><li>
  Promijenite optimizator u
  <a href="https://pytorch.org/docs/stable/optim.html?highlight=adam#torch.optim.Adam"><code>torch.optim.Adam</code></a>
  s fiksnim korakom učenja <code>1e-4</code>.
  procijenite utjecaj te promjene na
  kvalitetu konvergencije i postignutu performansu.
</li><li>
  Isprobajte ADAM s varijabilnim korakom učenja.
  U izvedbi se pomognite funkcijom
  <a href="https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate"><code>torch.optim.lr_scheduler.ExponentialLR</code></a>,
  koju valja pozvati nakon svake epohe
  kao što je preporučeno u 
  <a href="https://pytorch.org/docs/stable/optim.html#torch.optim.lr_scheduler.StepLR">dokumentaciji</a>).
  Neka početni korak učenja bude isti kao i ranije,
  a ostale parametre postavite na
  <code>gamma=1-1e-4</code>.
</li><li>
  Izračunajte i interpretirajte gubitak
  slučajno incijaliziranog modela
  (dakle, modela koji nije vidio podatke za učenje).
</li><li>
  Naučite linearni i jezgreni SVM uz pomoć modula
  <code>sklearn.svm</code>.
  Koristite podrazumijevano one vs one proširenje
  SVM-a za klasificiranje podataka u više razreda.
  Pri eksperimentiranju budite strpljivi
  jer bi učenje i evaluacija mogli trajati
  više od pola sata.
  Usporedite dobivenu performansu 
  s performansom dubokih modela.
</li></ul>

<p>
Ako je rezultat izvođenja prihvatljiv,
pohranite kod u datoteku <code>mnist_shootout.py</code>.

</p><h4 id="z8">8. Normalizacija po podatcima (bonus)</h4>

<p>
Proučite <a href="https://pytorch.org/docs/stable/nn.html#batchnorm1d">postupak</a> 
normalizacije po podatcima (engl. batch normalization) 
za potpuno povezane modele.
Proširite duboki klasifikator iz zadatka 5 kodom 
koji normalizira izlaz linearnog dijela svakog skrivenog sloja
tako da za tekuću grupu ima sredinu nula i jediničnu varijancu.
Pripazite na to da parametre normalizacije 
valja mijenjati samo prilikom 
<a href="https://stackoverflow.com/a/51433411/5265233">učenja</a>.
Usporedite dobivenu performansu 
s performansom osnovnih dubokih modela.

</p><p>
Za sve bodove potrebno je razviti vlastitu implementaciju,
a ne koristiti <code>torch.nn.BatchNorm1d</code>.
<!-- TODO
  mini-grupe, adam, normalizacija
  early stopping
  anizotropna regularizacija
-->

</p><div id="footer">
<hr style="height:5px">
  <table width="100%" style="margin-left:auto; margin-right:auto;">
  <tbody><tr> <td style="width:100%; text-align:left" valign="top">
    Ove stranice sastavljaju Petra Bevandić,
    Marin Oršić, Ivan Grubišić, Josip Šarić
    i Siniša Šegvić.

    <br>
    Prva verzija ovih stranica bila je rezultat 
    istraživačkog projekta 
    <a href="http://multiclod.zemris.fer.hr/">MULTICLOD</a>
    (I-2433-2014) Hrvatske zaklade za znanost.

    <br>
    Stranice su izrađene 
    <a href="http://www.vim.org/">vi</a>-jem i
    <a href="http://www.gedit.org/">gedit</a>om. 

    <br>
    <!--flastmod file="${DOCUMENT_NAME}"-->
    Posljednja promjena: Monday, 30-Mar-2020 00:57:34 CEST
  </td></tr><tr> <td style="width:50%; text-align:left" valign="top">
    Svi komentari su dobrodošli: 
    <img src="./lab1_task_croatian_files/email.png" alt="sinisa segvic at fer hr" width="150" style="vertical-align:text-bottom">
    </td><td style="width:50%; text-align:right" valign="bottom">
    <a href="http://www.zemris.fer.hr/~ssegvic/dl">Povratak</a>
  </td></tr></tbody></table>

  <p>
</p></div>






</body></html>